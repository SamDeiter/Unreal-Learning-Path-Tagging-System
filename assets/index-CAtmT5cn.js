import{j as e,o as jt,s as _t,_ as se,a as Nt,g as Ge}from"./index-BIUty12u.js";import{a as _,P as f}from"./vendor-cytoscape-hdah7_Xt.js";import{c as et,p as wt,r as St,d as Ct,j as kt,k as Tt,n as It,m as We}from"./vendor-firebase-BQvzIQYL.js";import{t as te}from"./TagGraphService-BOeYVwvg.js";import{S as Et,P as Lt}from"./search-Blpc5bje.js";import{c as X}from"./createLucideIcon-YhyuTmrv.js";import{c as pe,q as tt,b as st,d as Mt,f as $t,l as Rt,g as qt,s as Pt}from"./data-courses-aYLqO-5R.js";import{d as J,L as At,a as Y}from"./logger-HX1K3TKu.js";import{B as Dt,A as be}from"./book-open-D4v9dAb-.js";import{C as $e}from"./check-eCXpKYRG.js";import{X as Ot}from"./x-HbUnH9yy.js";import{getFeedbackStatus as zt,recordUpvote as Ft,recordDownvote as Ut,applyFeedbackMultiplier as Vt}from"./feedbackService-CkyHLPU6.js";const Gt=[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Wt=X("circle-play",Gt);const Yt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Ye=X("circle-x",Yt);const Qt=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],Bt=X("flask-conical",Qt);const Kt=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],Ht=X("image",Kt);const Zt=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Jt=X("star",Zt);const Xt=[["path",{d:"M13.172 2a2 2 0 0 1 1.414.586l6.71 6.71a2.4 2.4 0 0 1 0 3.408l-4.592 4.592a2.4 2.4 0 0 1-3.408 0l-6.71-6.71A2 2 0 0 1 6 9.172V3a1 1 0 0 1 1-1z",key:"16rjxf"}],["path",{d:"M2 7v6.172a2 2 0 0 0 .586 1.414l6.71 6.71a2.4 2.4 0 0 0 3.191.193",key:"178nd4"}],["circle",{cx:"10.5",cy:"6.5",r:".5",fill:"currentColor",key:"12ikhr"}]],es=X("tags",Xt);const ts=[["path",{d:"M12 19h8",key:"baeox8"}],["path",{d:"m4 17 6-6-6-6",key:"1yngyt"}]],ss=X("terminal",ts);const ns=[["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}],["path",{d:"M7 10v12",key:"1qc93n"}]],rs=X("thumbs-up",ns);const as=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],is=X("user",as);function Ae({onSubmit:t,detectedPersona:s,isLoading:n}){const[o,c]=_.useState(""),[l,r]=_.useState([]),[h,i]=_.useState(null),[a,p]=_.useState(""),[g,v]=_.useState(!1),x=_.useRef(null),[d,m]=_.useState(()=>{try{const b=JSON.parse(localStorage.getItem("fix-problem-history")||"[]"),w=b.map(I=>typeof I=="string"?{query:I,cartId:null}:I);return b.length>0&&typeof b[0]=="string"&&localStorage.setItem("fix-problem-history",JSON.stringify(w)),w}catch{return[]}}),N=_.useCallback(b=>{const w=b.target.value;if(c(w),w.length>15){const I=te.matchErrorSignature(w),M=te.extractTagsFromText(w),O=I.map(G=>({tag:G.tag,confidence:G.confidence})),F=M.matches.map(G=>({tag:G.tag,confidence:G.confidence})),H=[...O,...F],B=new Set,Q=H.filter(G=>B.has(G.tag.tag_id)?!1:(B.add(G.tag.tag_id),!0));r(Q.slice(0,5))}else r([])},[]),j=_.useCallback(b=>{const w=b.clipboardData?.items;if(w){for(const I of w)if(I.type.startsWith("image/")){b.preventDefault();const M=I.getAsFile(),O=new FileReader;O.onload=F=>i(F.target.result),O.readAsDataURL(M);return}}},[]),k=_.useCallback(b=>{b.preventDefault(),b.stopPropagation(),v(!0)},[]),L=_.useCallback(b=>{b.preventDefault(),b.stopPropagation(),v(!1)},[]),q=_.useCallback(b=>{b.preventDefault(),b.stopPropagation(),v(!1);const w=b.dataTransfer?.files;if(!w||w.length===0)return;const I=w[0];if(I.type.startsWith("image/")){const M=new FileReader;M.onload=O=>i(O.target.result),M.readAsDataURL(I)}},[]),V=_.useCallback((b,w)=>{m(I=>{const M=I.map(O=>O.query===b?{...O,cartId:w}:O);return localStorage.setItem("fix-problem-history",JSON.stringify(M)),M})},[]),P=_.useCallback((b=null,w=null)=>{const I=(w||o).trim();I.length<10||(m(M=>{const O=M.filter(H=>H.query!==I),F=[{query:I,cartId:b},...O].slice(0,6);return localStorage.setItem("fix-problem-history",JSON.stringify(F)),F}),t({query:I,detectedTagIds:l.map(M=>M.tag.tag_id),selectedTagIds:[],personaHint:s?.name,pastedImage:h,errorLog:a.trim()||null,cachedCartId:b||null,updateCartIdForQuery:V}))},[o,l,s,t,h,a,V]),u=_.useCallback(b=>{b.key==="Enter"&&b.ctrlKey&&P()},[P]),C=_.useMemo(()=>['My Blueprint Cast is giving me "Accessed None" error when trying to...',"Lumen is too noisy in my interior scene and I've tried increasing quality...","My character animation stutters when blending between states...","Nanite is causing Z-fighting on overlapping meshes...","Material instances aren't updating at runtime when I change parameters..."],[])[0];return e.jsxs("div",{className:"problem-input-container",onPaste:j,children:[e.jsxs("div",{className:"problem-input-header",children:[e.jsxs("h2",{children:[e.jsx(Et,{size:22,className:"icon-inline"})," What's the problem?"]}),e.jsx("p",{className:"subtitle",children:"Describe your UE5 issue in plain English. We'll diagnose the root cause and teach you to fix it."})]}),e.jsxs("div",{className:"problem-input-field",children:[e.jsx("textarea",{value:o,onChange:N,onKeyDown:u,placeholder:C,rows:5,disabled:n,"aria-label":"Problem description"}),e.jsxs("div",{className:"char-count",children:[o.length," characters",o.length<10&&o.length>0&&e.jsx("span",{className:"warning",children:" (minimum 10)"})]})]}),l.length>0&&e.jsxs("div",{className:"detected-tags",children:[e.jsxs("span",{className:"label",children:[e.jsx(es,{size:14,className:"icon-inline"})," Detected:"]}),e.jsx("div",{className:"tag-list",children:l.map(b=>e.jsxs("span",{className:"tag-chip",title:b.tag.description||b.tag.display_name,children:[b.tag.display_name,e.jsxs("span",{className:"confidence",children:[Math.round(b.confidence*100),"%"]})]},b.tag.tag_id))})]}),e.jsxs("div",{className:`screenshot-zone ${a.trim()?"has-image":""}`,onClick:()=>{a.trim()||document.getElementById("error-log-input")?.focus()},children:[a.trim()?e.jsxs("div",{className:"pasted-preview error-log-preview",children:[e.jsx("pre",{className:"error-log-display",children:a}),e.jsx("button",{type:"button",className:"clear-error-log",onClick:b=>{b.stopPropagation(),p("")},"aria-label":"Remove error log",title:"Clear error log",children:e.jsx(Ye,{size:20})})]}):e.jsxs("div",{className:"drop-prompt",children:[e.jsx(ss,{size:20}),e.jsxs("span",{children:["Paste (",e.jsx("kbd",{children:"Ctrl+V"}),") an error log or build output"]})]}),e.jsx("textarea",{id:"error-log-input",className:"error-log-hidden-input",value:a,onChange:b=>p(b.target.value),onPaste:b=>{const w=b.clipboardData?.getData("text");w&&(b.preventDefault(),p(w))},rows:1})]}),e.jsx("div",{ref:x,className:`screenshot-zone ${g?"drag-over":""} ${h?"has-image":""}`,onDragOver:k,onDragLeave:L,onDrop:q,children:h?e.jsxs("div",{className:"pasted-preview",children:[e.jsx("img",{src:h,alt:"Pasted screenshot"}),e.jsx("button",{type:"button",className:"clear-error-log",onClick:()=>i(null),"aria-label":"Remove screenshot",title:"Remove screenshot",children:e.jsx(Ye,{size:20})})]}):e.jsxs("div",{className:"drop-prompt",children:[e.jsx(Ht,{size:20}),e.jsxs("span",{children:["Paste (",e.jsx("kbd",{children:"Ctrl+V"}),") or drag a screenshot here"]})]})}),s&&e.jsxs("div",{className:"persona-context",children:[e.jsxs("span",{className:"label",children:[e.jsx(is,{size:14,className:"icon-inline"})," Context:"]}),e.jsx("span",{className:"persona-chip",children:s.name}),e.jsx("span",{className:"hint",children:"Recommendations will be tailored for you"})]}),e.jsxs("div",{className:"problem-input-actions",children:[e.jsx("button",{className:"submit-btn primary",onClick:()=>P(),disabled:o.trim().length<10||n,children:n?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner"})," Diagnosing..."]}):e.jsx(e.Fragment,{children:"Get Diagnosis â†’"})}),e.jsxs("span",{className:"hint",children:["Press ",e.jsx("kbd",{children:"Ctrl"})," + ",e.jsx("kbd",{children:"Enter"})," to submit"]})]}),d.length>0&&e.jsxs("div",{className:"query-history",children:[e.jsx("span",{className:"history-label",children:"ðŸ•˜ Recent questions:"}),e.jsx("div",{className:"history-chips",children:d.map((b,w)=>{const I=b.query||b,M=b.cartId||null,O=!!M;return e.jsxs("div",{className:"history-chip-row",children:[e.jsxs("button",{type:"button",className:`history-chip ${O?"cached":""}`,onClick:()=>{c(I),N({target:{value:I}}),O&&!n&&setTimeout(()=>P(M,I),50)},title:O?`${I} (cached â€” instant load)`:I,disabled:n,children:[O&&e.jsx("span",{className:"cache-indicator",children:"âš¡"}),I.length>50?I.slice(0,50)+"â€¦":I]}),e.jsx("button",{type:"button",className:"history-delete",onClick:()=>{m(F=>{const H=F.filter((B,Q)=>Q!==w);return localStorage.setItem("fix-problem-history",JSON.stringify(H)),H})},title:"Remove",children:"Ã—"})]},w)})})]})]})}Ae.propTypes={onSubmit:f.func.isRequired,detectedPersona:f.shape({id:f.string,name:f.string,emoji:f.string}),isLoading:f.bool};Ae.defaultProps={detectedPersona:null,isLoading:!1};function os({problemSummary:t,courses:s,diagnosis:n}){if(!s||s.length===0)return{title:"Your Learning Path",intro:"Let's solve your problem step by step.",instructors:[],totalDuration:null};const o=ls(s),c=us(s),l=ps({instructors:o,courseCount:s.length,totalDuration:c,rootCauses:n?.root_causes||[]});return{title:`Your Path: ${ms(t)}`,intro:l,instructors:o,totalDuration:c,courseCount:s.length,rootCauses:n?.root_causes||[]}}function cs(t,s,n){if(!s)return{type:"completion",text:"ðŸŽ‰ Congratulations! You've completed your learning path.",subtext:"You now have the skills to solve this problem and similar ones in the future."};const o=Re(t),c=Re(s),l=s.title||s.name||"the next lesson";return o&&c&&o!==c?{type:"transition",text:`Now let's hear from ${c}`,subtext:`${c} will cover: ${n||l}`,instructor:c}:{type:"continuation",text:`Next up: ${l}`,subtext:n||null,instructor:c}}function ls(t){const s=new Set,n=[];return t.forEach(o=>{const c=Re(o);if(c&&!s.has(c))s.add(c),n.push({name:c,courses:[o.title||o.name],totalDuration:qe(o)});else if(c){const l=n.find(r=>r.name===c);l&&(l.courses.push(o.title||o.name),l.totalDuration+=qe(o))}}),n}function Re(t){return t&&(t.instructor||t.author||t.creator||t.teacher||ds(t.title||t.name))||null}function ds(t){if(!t)return null;const s=t.match(/\bby\s+([A-Z][a-zA-Z]+(?:\s+[A-Z][a-zA-Z]+)?)/i);if(s)return s[1];const n=t.match(/\bwith\s+([A-Z][a-zA-Z]+(?:\s+[A-Z][a-zA-Z]+)?)/i);return n?n[1]:null}function us(t){const s=t.reduce((n,o)=>n+qe(o),0);return hs(s)}function qe(t){return t?t.duration_seconds?t.duration_seconds:t.duration_minutes?t.duration_minutes*60:t.videos?.length?t.videos.reduce((s,n)=>s+(n.duration_seconds||0),0):0:0}function hs(t){if(!t||t<=0)return null;const s=Math.floor(t/3600),n=Math.floor(t%3600/60);return s>0?n>0?`${s} hr ${n} min`:`${s} hr`:`${n} min`}function ms(t){if(!t)return"Learning Path";if(t.length<=80)return t;const s=t.slice(0,80),n=s.lastIndexOf(" ");return(n>30?s.slice(0,n):s)+"â€¦"}function ps({instructors:t,courseCount:s,totalDuration:n,rootCauses:o}){const c=[];if(o.length>0&&c.push(`We've identified ${o.length} root cause${o.length>1?"s":""} for your issue:`),t.length===1)c.push(`${t[0].name} will guide you through ${s} lesson${s>1?"s":""}.`);else if(t.length>1){const l=t.map(h=>h.name),r=l.pop();c.push(`You'll learn from ${l.join(", ")} and ${r}.`)}else c.push(`You have ${s} lesson${s>1?"s":""} to complete.`);return n&&c.push(`Total time: ${n}.`),c.join(" ")}function gs(t,s){const n=Math.round((t+1)/s*100);return{text:`Video ${t+1} of ${s}`,percent:n,isComplete:t+1>=s}}function fs(t,s,n,o=0){const l=[...t?.canonical_tags||[],...t?.gemini_system_tags||[],...t?.transcript_tags||[],...t?.extracted_tags||[],...Array.isArray(t?.tags)?t.tags:[]].map(m=>typeof m=="string"?m.split(".").pop():m.name||m.display_name||"").filter(Boolean).filter((m,N,j)=>j.indexOf(m)===N),r=t?.gemini_skill_level||"Intermediate",h=(s||"").toLowerCase(),i=[],a=new Set,p=m=>{for(const N of m)a.has(N.task)||(a.add(N.task),i.push(N))};if(h){const m=Object.keys(pe).sort((N,j)=>j.length-N.length);for(const N of m)h.includes(N)&&p(pe[N])}const g=[...l].sort((m,N)=>{const j=h.includes(m.toLowerCase())?1:0;return(h.includes(N.toLowerCase())?1:0)-j});for(const m of g){const N=m.toLowerCase();pe[N]&&p(pe[N])}if(i.length>0){const m=i[o%i.length];return{task:m.task,hint:m.hint,expectedResult:m.expectedResult,docsUrl:m.docsUrl||null,difficulty:r}}const v=l[0]||(n?n.split(/\s+/).slice(0,3).join(" "):"this concept"),x=n?`"${n}"`:"this lesson",d=t?.gemini_outcomes?.[0]||"";return{task:s?`Open UE5 and apply the technique from ${x} to address "${s}". In the Details panel, identify which ${v} settings you changed and note the before/after values.`:`Open UE5, create a test Actor, and set up ${v} from scratch following the approach from ${x}. Document which panels and properties you used.`,hint:d?`Focus on: ${d}. Check Details panel and World Settings for relevant options.`:`Look for ${v} options in the Details panel, Modes panel, or Project Settings â†’ Engine.`,expectedResult:s?`Your original issue ("${s}") should be resolved or visibly improved in the viewport. Compare before/after values in the Details panel to confirm the change took effect.`:`You should see ${v} applied correctly in the viewport or preview. The Details panel should reflect the new settings, and the editor should show no warnings related to your changes.`,difficulty:r}}const nt="ue5_learning_progress";function rt(){try{const t=localStorage.getItem(nt);return t?{...je(),...JSON.parse(t)}:je()}catch{return je()}}function je(){return{completedPaths:[],tagsEncountered:{},totalVideosWatched:0,reflections:[],streak:{lastDate:null,count:0}}}function xs(t){try{localStorage.setItem(nt,JSON.stringify(t))}catch(s){J("[LearningProgress] Failed to save:",s.message)}}function ys(t,s,n){const o=rt(),c=new Date().toISOString().split("T")[0];o.completedPaths.includes(t)||o.completedPaths.push(t);for(const l of s){const r=l.extracted_tags||l.tags||[];for(const h of r){const i=typeof h=="string"?h:h.name||h.display_name;i&&(o.tagsEncountered[i]=(o.tagsEncountered[i]||0)+1)}}if(o.totalVideosWatched+=s.length,o.streak.lastDate!==c){const l=new Date;l.setDate(l.getDate()-1);const r=l.toISOString().split("T")[0];o.streak.lastDate===r?o.streak.count+=1:o.streak.count=1,o.streak.lastDate=c}return n&&n.trim().length>0&&o.reflections.push({date:c,pathId:t,text:n.trim()}),xs(o),o}function vs(){const t=rt(),s=new Date().toISOString().split("T")[0],n=new Date;n.setDate(n.getDate()-1);const o=n.toISOString().split("T")[0],c=t.streak.lastDate===s||t.streak.lastDate===o;return{count:c?t.streak.count:0,isActive:c}}const U={INTRO:"intro",PLAYING:"playing",QUIZ:"quiz",CHALLENGE:"challenge",BRIDGE:"bridge",COMPLETE:"complete"};function bs({courses:t,diagnosis:s,problemSummary:n,pathSummary:o,onComplete:c,onExit:l}){const[r,h]=_.useState(U.INTRO),[i,a]=_.useState(0),[p,g]=_.useState(0),[v,x]=_.useState(""),[d,m]=_.useState(null),[N,j]=_.useState(!0);_.useEffect(()=>jt(W=>{m(W),j(!1)}),[]);const k=_.useCallback(async()=>{j(!0);const{error:E}=await _t();E&&console.error("[GuidedPlayer] Sign in failed:",E),j(!1)},[]),L=t[i]||null,q=t[i+1]||null,V=L?.videos||[],P=V[p]||V[0]||null,u=p<V.length-1,S=p>0||i>0,C=u||!!q,b=V.length,w=_.useMemo(()=>os({problemSummary:n,courses:t,diagnosis:s}),[n,t,s]),I=_.useMemo(()=>vs(),[]),M=_.useMemo(()=>t.reduce((E,W)=>E+(W.videos?.length||1),0),[t]),O=_.useMemo(()=>{let E=0;for(let W=0;W<i;W++)E+=t[W]?.videos?.length||1;return E+p},[t,i,p]),F=_.useMemo(()=>gs(O,M),[O,M]),H=_.useMemo(()=>{if(r!==U.BRIDGE)return null;const E=L?.gemini_outcomes?.[0]||null;return cs(L,q,E)},[r,L,q]),B=_.useMemo(()=>r!==U.CHALLENGE?null:fs(L,n,P?.title,i),[r,L,n,P,i]),Q=_.useCallback(()=>{h(U.PLAYING)},[]),G=_.useCallback(()=>{if(L?._readingStep){q?(a(E=>E+1),g(0),h(U.PLAYING)):(h(U.COMPLETE),c?.());return}if(u)g(E=>E+1);else{const E=tt[L?.code];E&&Object.keys(E).length>0?h(U.QUIZ):h(U.CHALLENGE)}},[u,L,q,c]),le=_.useCallback(()=>{if(p>0)g(E=>E-1);else if(i>0){const E=t[i-1]?.videos||[];a(W=>W-1),g(Math.max(0,E.length-1))}},[p,i,t]),ne=_.useCallback(()=>{u?g(E=>E+1):q&&(a(E=>E+1),g(0))},[u,q]),y=_.useCallback(()=>{a(0),g(0),h(U.PLAYING)},[]),T=_.useCallback(()=>{h(U.CHALLENGE)},[]),$=_.useCallback(()=>{q?(a(E=>E+1),g(0),h(U.PLAYING)):(h(U.COMPLETE),c?.())},[q,c]),z=_.useCallback(()=>{a(E=>E+1),g(0),h(U.PLAYING)},[]),D=_.useCallback(E=>{a(E),g(0),h(U.PLAYING)},[]),A=_.useCallback(()=>{const E=n?`path-${n.replace(/\s+/g,"-").toLowerCase().slice(0,40)}-${Date.now()}`:`path-${Date.now()}`;ys(E,t,v),l?.()},[n,t,v,l]),R=v.trim().split(/\s+/).filter(Boolean).length;return{stage:r,currentIndex:i,videoIndex:p,reflectionText:v,setReflectionText:x,user:d,authLoading:N,currentCourse:L,nextCourse:q,currentVideos:V,currentVideo:P,hasMoreVideos:u,hasPreviousVideo:S,hasNextVideo:C,courseVideoCount:b,introContent:w,streak:I,progress:F,bridgeContent:H,challengeContent:B,pathSummary:o,wordCount:R,courses:t,handleSignIn:k,handleStartLearning:Q,handleVideoComplete:G,handlePreviousVideo:le,handleNextVideo:ne,handleBackToPath:y,handleQuizComplete:T,handleChallengeComplete:$,handleContinue:z,handleSkipTo:D,handleFinish:A,onExit:l}}function at({challengeContent:t,onComplete:s}){return e.jsxs("div",{className:"challenge-card",children:[e.jsx("div",{className:"challenge-icon",children:"ðŸ”¨"}),e.jsx("h3",{children:"Try It Yourself"}),e.jsx("div",{className:"challenge-difficulty",children:e.jsx("span",{className:`difficulty-badge ${t.difficulty.toLowerCase()}`,children:t.difficulty})}),e.jsx("p",{className:"challenge-task",children:t.task}),t.expectedResult&&e.jsxs("div",{className:"challenge-expected",children:[e.jsx("span",{className:"expected-label",children:"ðŸ‘ï¸ What to look for:"})," ",t.expectedResult]}),e.jsxs("div",{className:"challenge-hint",children:[e.jsx("span",{className:"hint-label",children:"ðŸ’¡ Hint:"})," ",t.hint]}),t.docsUrl&&e.jsx("a",{className:"docs-link",href:t.docsUrl,target:"_blank",rel:"noopener noreferrer",children:"ðŸ“– Read the official UE5 docs â†’"}),e.jsx("button",{className:"challenge-done-btn",onClick:s,children:"I tried it â†’"}),e.jsx("button",{className:"challenge-skip-btn",onClick:s,children:"Skip challenge"})]})}at.propTypes={challengeContent:f.shape({task:f.string.isRequired,hint:f.string.isRequired,expectedResult:f.string,docsUrl:f.string,difficulty:f.string.isRequired}).isRequired,onComplete:f.func.isRequired};f.shape({type:f.string.isRequired,text:f.string.isRequired,subtext:f.string}).isRequired,f.func.isRequired;function it({courses:t,totalDuration:s,reflectionText:n,onReflectionChange:o,wordCount:c,onFinish:l,onBackToPath:r}){return _.useEffect(()=>{if(n.trim())try{localStorage.setItem("lp_reflection_draft",JSON.stringify({text:n,timestamp:Date.now(),courseCount:t.length}))}catch{}},[n,t.length]),_.useEffect(()=>{try{const h=JSON.parse(localStorage.getItem("lp_reflection_draft")||"null");h?.text&&!n&&o(h.text)}catch{}},[]),e.jsxs("div",{className:"complete-card",children:[e.jsx("div",{className:"complete-icon",children:"ðŸŽ‰"}),e.jsx("h2",{children:"Path Complete!"}),e.jsx("p",{children:"You've learned the skills to solve this problem and similar ones in the future."}),e.jsxs("div",{className:"reflection-area",children:[e.jsx("h3",{children:"ðŸ“ What was your main takeaway?"}),e.jsx("p",{className:"reflection-subtitle",children:"Writing your reflection helps cement what you learned."}),e.jsx("textarea",{className:"reflection-input",placeholder:"I learned that...",value:n,onChange:h=>o(h.target.value),rows:4}),e.jsxs("div",{className:"reflection-meta",children:[c===0&&e.jsx("span",{className:"word-hint",children:"Try writing a few sentences"}),c>0&&c<10&&e.jsxs("span",{className:"word-hint",children:[c," words â€” keep going!"]}),c>=10&&e.jsx("span",{className:"word-hint done",children:"Great reflection! âœ“"})]})]}),e.jsxs("div",{className:"stats",children:[e.jsxs("div",{className:"stat",children:[e.jsx("span",{className:"value",children:t.length}),e.jsx("span",{className:"label",children:"Lessons"})]}),e.jsxs("div",{className:"stat",children:[e.jsx("span",{className:"value",children:s||"â€”"}),e.jsx("span",{className:"label",children:"Total Time"})]})]}),e.jsxs("div",{className:"completion-actions",children:[e.jsx("button",{className:"finish-btn",onClick:()=>{l();try{localStorage.removeItem("lp_reflection_draft")}catch{}},children:n.trim()?"Save & Finish":"Back to Problems"}),r&&e.jsx("button",{className:"back-to-path-btn",onClick:r,children:"â† Back to Learning Path"})]})]})}it.propTypes={courses:f.array.isRequired,totalDuration:f.string,reflectionText:f.string.isRequired,onReflectionChange:f.func.isRequired,wordCount:f.number.isRequired,onFinish:f.func.isRequired};function ce(t){return t?t.replace(/\.mp4$/i,"").replace(/_/g," ").replace(/^[A-Z]{2,5}\s+\d[\d.]*\s*/gi,"").replace(/^\d+\.\d+\s*/g,"").replace(/^0*\d{1,3}\s+/g,"").replace(/^(\w+)[ _]\1[ _]/i,"").replace(/^(?:and|or)\s+/i,"").replace(/\s+\d{1,3}\s*(NEW|FINAL|EDIT|EDITED|OLD|DRAFT|v\d+)?\s*$/gi,"").replace(/\s+(NEW|FINAL|EDIT|EDITED|OLD|DRAFT|v\d+)\s*$/gi,"").replace(/([a-z])(\d{2})$/g,"$1").replace(/([a-z])([A-Z])/g,"$1 $2").replace(/([A-Z]+)([A-Z][a-z])/g,"$1 $2").replace(/\s+(?:5[0-5]|4[0-9])$/g,"").replace(/[-]+\s*$/g,"").replace(/^\s*[-]+/g,"").replace(/\s{2,}/g," ").trim()||t:"Untitled Video"}function ot({courses:t,currentIndex:s,onSkipTo:n}){const o=t.map(c=>c.code);return e.jsxs("div",{className:"course-sidebar",children:[e.jsx("h4",{children:"Your Path"}),e.jsx("div",{className:"sidebar-courses",children:t.map((c,l)=>{const r=st[c.code],h=r?.prerequisites?.filter(i=>!o.includes(i))||[];return e.jsxs("button",{className:`sidebar-course ${l===s?"active":""} ${l<s?"completed":""}`,onClick:()=>n(l),title:ce(c.videos?.[0]?.title||c.title||c.name),children:[e.jsx("span",{className:"index",children:l<s?"âœ“":l+1}),e.jsx("span",{className:"title",children:ce(c.videos?.[0]?.title||c.title||c.name)}),r?.difficulty&&e.jsx("span",{className:`difficulty-tag ${r.difficulty}`,children:r.difficulty}),h.length>0&&e.jsx("span",{className:"prereq-warning",title:`Recommended: ${h.join(", ")} first`,children:"âš ï¸"})]},c.code||l)})})]})}ot.propTypes={courses:f.array.isRequired,currentIndex:f.number.isRequired,onSkipTo:f.func.isRequired};function ct({courseCode:t,videoKey:s,onComplete:n,onSkip:o}){const[c,l]=_.useState(0),[r,h]=_.useState(null),[i,a]=_.useState(!1),[p,g]=_.useState(0),[v,x]=_.useState(!1),d=_.useMemo(()=>{if(!t||!s)return[];const P=tt[t];if(!P)return[];if(P[s])return P[s];const u=C=>(C||"").replace(/\.mp4$/i,"").replace(/^[\d._]+/,"").replace(/[\s_]+/g,"").toLowerCase(),S=u(s);for(const[C,b]of Object.entries(P)){const w=u(C);if(w===S||w.includes(S)||S.includes(w))return b}return[]},[t,s]);if(d.length===0)return null;const m=d[c],N=r===m?.correct,j=d.length,k=P=>{i||h(P)},L=()=>{r!==null&&(a(!0),r===m.correct&&g(P=>P+1))},q=()=>{c<j-1?(l(P=>P+1),h(null),a(!1)):x(!0)},V=()=>{n({score:p,total:j})};if(v){const P=Math.round(p/j*100),u=P>=80?Jt:P>=50?rs:Dt,S=P>=80?"Excellent! You've got a strong grasp of this material.":P>=50?"Good effort! Consider rewatching for the topics you missed.":"You might want to re-watch this section before moving on.";return e.jsx("div",{className:"quiz-card",children:e.jsxs("div",{className:"quiz-score-summary",children:[e.jsx("div",{className:"score-icon-container",children:e.jsx(u,{size:48,className:"score-icon"})}),e.jsxs("h3",{children:[p,"/",j," Correct"]}),e.jsx("div",{className:"score-bar",children:e.jsx("div",{className:"score-fill",style:{width:`${P}%`}})}),e.jsx("p",{className:"score-message",children:S}),e.jsxs("button",{className:"quiz-continue-btn",onClick:V,children:["Continue ",e.jsx(be,{size:16})]})]})})}return e.jsxs("div",{className:"quiz-card",children:[e.jsxs("div",{className:"quiz-header",children:[e.jsx("span",{className:"quiz-icon",children:e.jsx(Bt,{size:20})}),e.jsx("h3",{children:"Quick Check"}),e.jsxs("span",{className:"quiz-progress",children:[c+1," / ",j]})]}),e.jsx("p",{className:"quiz-question",children:m.question}),e.jsx("div",{className:"quiz-options",children:m.options.map((P,u)=>{let S="quiz-option";return r===u&&(S+=" selected"),i&&(u===m.correct?S+=" correct":r===u&&(S+=" incorrect")),e.jsxs("button",{className:S,onClick:()=>k(u),disabled:i,children:[e.jsx("span",{className:"option-letter",children:String.fromCharCode(65+u)}),e.jsx("span",{className:"option-text",children:P}),i&&u===m.correct&&e.jsx("span",{className:"option-icon",children:e.jsx($e,{size:16})}),i&&r===u&&u!==m.correct&&e.jsx("span",{className:"option-icon",children:e.jsx(Ot,{size:16})})]},u)})}),i&&m.explanation&&e.jsxs("div",{className:`quiz-explanation ${N?"correct":"incorrect"}`,children:[e.jsx("span",{className:"explanation-icon",children:N?e.jsx($e,{size:16}):e.jsx(At,{size:16})}),e.jsx("p",{children:m.explanation})]}),e.jsxs("div",{className:"quiz-actions",children:[i?e.jsx("button",{className:"quiz-next-btn",onClick:q,children:c<j-1?e.jsxs(e.Fragment,{children:["Next Question ",e.jsx(be,{size:16})]}):e.jsxs(e.Fragment,{children:["See Results ",e.jsx(be,{size:16})]})}):e.jsx("button",{className:"quiz-check-btn",onClick:L,disabled:r===null,children:"Check Answer"}),e.jsx("button",{className:"quiz-skip-btn",onClick:o,children:"Skip Quiz"})]})]})}ct.propTypes={courseCode:f.string,videoKey:f.string,onComplete:f.func.isRequired,onSkip:f.func.isRequired};const he=new Set(["the","and","for","with","this","that","are","was","has","have","not","can","into","from","how","you","your","will","would","also","just","like","more","very","some","want","need","make","use","used","using","help","helpful","helps","get","getting","let","look","going","come","here","there","know","thing","really","actually","basically","something","everything","slow","fast","leading","exhibiting","experiencing","causing","about","been","being","could","does","doing","done","each","even","every","first","give","good","great","kind","made","much","over","part","right","same","see","show","start","still","take","tell","than","them","then","these","they","those","through","time","took","turn","way","well","what","when","where","which","while","work","working","unreal","engine","introduction","quick"]),js=new Set(["gonna","going","really","actually","basically","right","thing","things","about","would","could","should","there","their","these","those","where","which","being","doing","using","other","first","second","third","after","before","every","still","again","already","engine","unreal","because","simply","called","allows","looking","provides"]);function _e(t){return(t||"").replace(/\.mp4$/i,"").replace(/^[\d._]+/,"").replace(/[\s_]+/g,"").toLowerCase()}function lt({courseCode:t,videoTitle:s,problemSummary:n,matchedKeywords:o}){const[c,l]=_.useState(null);_.useEffect(()=>{let i=!1;return se(()=>import("./data-transcripts-CYT280mV.js"),[]).then(a=>{i||l(a.default||a)}),()=>{i=!0}},[]);const r=_.useMemo(()=>{if(!t||!c)return[];const i=c[t];if(!i)return[];const a=_e(s);let p=null;for(const[m,N]of Object.entries(i))if(_e(m)===a){p=N;break}if(!p)for(const[m,N]of Object.entries(i)){const j=_e(m);if(j.includes(a)||a.includes(j)){p=N;break}}if(!p||p.length===0)return[];const g=[];if(n&&g.push(...n.toLowerCase().split(/\s+/).filter(m=>m.length>3&&!he.has(m))),o&&g.push(...o.map(m=>(typeof m=="string"?m:m.display_name||m.id||"").toLowerCase())),g.length===0){const m=p.filter(j=>j.start&&j.start!=="0:00");if(m.length===0)return[];const N=Math.max(1,Math.floor(m.length/3));return m.filter((j,k)=>k%N===0).slice(0,3).map(j=>({...j,score:0,isChapter:!0}))}const x=p.map(m=>{const N=m.text.toLowerCase();let j=0;const k=[];for(const L of g)N.includes(L)&&(j+=10,k.includes(L)||k.push(L));return{...m,score:j,hits:[...new Set(k)]}}).filter(m=>m.score>0).sort((m,N)=>N.score-m.score);if(x.length>0){const m=x.slice(0,3);return m.sort((N,j)=>{const k=L=>{const q=(L||"0:00").split(":").map(Number);return q.length===3?q[0]*3600+q[1]*60+q[2]:q[0]*60+(q[1]||0)};return k(N.start)-k(j.start)}),m}const d=Math.max(1,Math.floor(p.length/3));return p.filter((m,N)=>N%d===0).slice(0,3).map(m=>({...m,score:0,isChapter:!0}))},[t,s,n,o,c]),h=_.useCallback(i=>{if(i.summary)return i.summary;const p=(i.text||"").replace(/[.,;:!?'"()]/g,"").split(/\s+/).filter(x=>x.length>=5&&!js.has(x.toLowerCase())).map(x=>x.toLowerCase()),g={};for(const x of p)g[x]=(g[x]||0)+1;const v=Object.entries(g).sort((x,d)=>d[1]-x[1]).slice(0,3).map(([x])=>x.charAt(0).toUpperCase()+x.slice(1));return v.length>0?v.join(", "):"Overview"},[]);return r.length===0?null:e.jsx("div",{className:"video-info-cards",children:e.jsxs("div",{className:"info-card transcript-card",children:[e.jsx("h4",{children:r[0]?.isChapter?"ðŸ“‹ Video Chapters":`ðŸŽ¯ ðŸŽ¬ Video Callouts: ${n||"your search"}`}),e.jsx("div",{className:"timestamp-list",children:r.map((i,a)=>e.jsxs("div",{className:`timestamp-item ${i.score>0?"relevant":""}`,children:[e.jsx("span",{className:"timestamp-badge",children:i.start}),e.jsx("span",{className:"timestamp-text",children:h(i)})]},a))})]})})}lt.propTypes={courseCode:f.string,videoTitle:f.string,problemSummary:f.string,matchedKeywords:f.array};function _s(t){if(!t||typeof t!="string")return t;t=t.replace(/\s*\[\d+(?:[,\s]*\d+)*\]/g,"").trim();const s=[];let n=t,o=0;for(;n.length>0;){const c=[{re:/\*\*(.+?)\*\*/,wrap:i=>e.jsx("strong",{children:i},o++)},{re:/\*(.+?)\*/,wrap:i=>e.jsx("em",{children:i},o++)},{re:/`([^`]+)`/,wrap:i=>e.jsx("code",{className:"inline-code",children:i},o++)},{re:/\[([^\]]+)\]\(([^)]+)\)/,wrap:(i,a)=>{const p=/^https?:\/\//i.test(a)?a:"#";return e.jsx("a",{href:p,target:"_blank",rel:"noopener noreferrer",children:i},o++)}}];let l=null,r=n.length,h=null;for(const i of c){const a=n.match(i.re);a&&a.index<r&&(l=a,r=a.index,h=i)}if(!l){s.push(n);break}r>0&&s.push(n.slice(0,r)),s.push(h.wrap(l[1],l[2])),n=n.slice(r+l[0].length)}return s}function De(t){const s=bs(t);return e.jsxs("div",{className:"guided-player",children:[e.jsxs("div",{className:"progress-bar",children:[e.jsx("div",{className:"progress-fill",style:{width:`${s.progress.percent}%`}}),e.jsx("span",{className:"progress-text",children:s.progress.text})]}),s.stage===U.INTRO&&e.jsx(Ns,{introContent:s.introContent,streak:s.streak,courses:s.courses,pathSummary:s.pathSummary,user:s.user,authLoading:s.authLoading,onSignIn:s.handleSignIn,onStart:s.handleStartLearning}),s.stage===U.PLAYING&&s.currentCourse&&!s.currentCourse._readingStep&&e.jsx(ws,{course:s.currentCourse,currentVideos:s.currentVideos,currentVideo:s.currentVideo,videoIndex:s.videoIndex,hasMoreVideos:s.hasMoreVideos,microLesson:t.microLesson,courses:s.courses,onVideoComplete:s.handleVideoComplete,onExit:s.onExit}),s.stage===U.PLAYING&&s.currentCourse&&s.currentCourse._readingStep&&e.jsx(dt,{course:s.currentCourse,stepNumber:s.currentIndex+1,totalSteps:s.courses.length,onComplete:s.handleVideoComplete,onExit:s.onExit}),s.stage===U.QUIZ&&e.jsx(ct,{courseCode:s.currentCourse?.code,videoKey:s.currentVideo?.title||s.currentVideo?.name||"",onComplete:s.handleQuizComplete,onSkip:s.handleQuizComplete}),s.stage===U.CHALLENGE&&s.challengeContent&&e.jsx(at,{challengeContent:s.challengeContent,onComplete:s.handleChallengeComplete}),s.stage===U.COMPLETE&&e.jsx(it,{courses:s.courses,totalDuration:s.introContent.totalDuration,reflectionText:s.reflectionText,onReflectionChange:s.setReflectionText,wordCount:s.wordCount,onFinish:s.handleFinish,onBackToPath:s.handleBackToPath}),s.stage!==U.INTRO&&s.stage!==U.COMPLETE&&e.jsxs("div",{className:"sidebar-column",children:[e.jsx(ot,{courses:s.courses,currentIndex:s.currentIndex,onSkipTo:s.handleSkipTo}),s.stage===U.PLAYING&&s.currentCourse&&e.jsx(lt,{courseCode:s.currentCourse.code,videoTitle:s.currentVideo?.title||s.currentVideo?.name||"",problemSummary:t.problemSummary,matchedKeywords:s.currentCourse._matchedKeywords})]})]})}De.propTypes={courses:f.array.isRequired,diagnosis:f.object,problemSummary:f.string,microLesson:f.object,pathSummary:f.shape({path_summary:f.string,topics_covered:f.arrayOf(f.string)}),onComplete:f.func,onExit:f.func};De.defaultProps={diagnosis:null,problemSummary:"",microLesson:null,pathSummary:null,onComplete:()=>{},onExit:()=>{}};function Ns({introContent:t,streak:s,courses:n,pathSummary:o,user:c,authLoading:l,onSignIn:r,onStart:h}){return e.jsxs("div",{className:"intro-card",children:[e.jsx("h2",{children:t.title}),e.jsx("p",{className:"intro-text",children:t.intro}),t.rootCauses?.length>0&&e.jsx("ol",{className:"root-cause-list",children:t.rootCauses.map((i,a)=>e.jsx("li",{children:i.replace(/\s*\[\d+\]/g,"")},a))}),s.isActive&&s.count>1&&e.jsxs("div",{className:"streak-badge",children:["ðŸ”¥ ",s.count,"-day learning streak!"]}),e.jsxs("div",{className:"course-preview",children:[e.jsx("h3",{children:"ðŸ“š What You'll Learn"}),o?.path_summary&&!/unavailable/i.test(o.path_summary)&&e.jsx("div",{className:"path-summary-section",children:e.jsx("p",{className:"path-summary-text",children:o.path_summary})}),e.jsxs("div",{className:"course-list",children:[n.slice(0,5).map((i,a)=>{const p=Mt[i.code]||[],g=i.videos?.[0]?.title||i.title||i.name;return e.jsxs("div",{className:"course-preview-item",children:[e.jsx("span",{className:"number",children:a+1}),e.jsxs("div",{className:"course-preview-details",children:[e.jsx("span",{className:"title",children:g?.replace(/\s+Part\s+[A-Z]$/i,"").trim()}),p.length>0&&e.jsx("ul",{className:"objective-list",children:p.slice(0,2).map((v,x)=>e.jsx("li",{children:v},x))})]})]},i.code||a)}),n.length>5&&e.jsxs("div",{className:"more-courses",children:["+",n.length-5," more"]})]})]}),e.jsx("div",{className:"auth-section",children:l?e.jsx("p",{className:"auth-loading",children:"Checking sign-in status..."}):c?e.jsxs("div",{className:"auth-signed-in",children:[e.jsxs("span",{className:"user-email",children:["âœ“ Signed in as ",c.email]}),e.jsx("button",{className:"start-btn",onClick:h,children:"â–¶ Start Learning"})]}):e.jsxs("div",{className:"auth-prompt",children:[e.jsx("p",{className:"signin-note",children:"Sign in with Google to watch videos from Google Drive"}),e.jsx("button",{className:"signin-btn",onClick:r,children:"ðŸ” Sign in with Google"}),e.jsx("button",{className:"start-btn secondary",onClick:h,children:"Skip sign-in (videos may not load)"})]})})]})}function ws({course:t,currentVideos:s,currentVideo:n,videoIndex:o,hasMoreVideos:c,microLesson:l,courses:r,onVideoComplete:h,onExit:i}){const a=n?.drive_id;return e.jsxs("div",{className:"video-stage",children:[e.jsxs("div",{className:"video-header",children:[e.jsx("h3",{children:t.title||t.name}),s.length>1&&e.jsxs("span",{className:"video-counter",children:["Video ",o+1," of ",s.length]}),t.gemini_outcomes?.[0]&&e.jsx("p",{className:"objective",children:t.gemini_outcomes[0]})]}),e.jsx("div",{className:"video-container",children:a?e.jsx("iframe",{src:`https://drive.google.com/file/d/${a}/preview`,title:n.title||t.title,allow:"autoplay",allowFullScreen:!0},a):e.jsxs("div",{className:"video-embed-error",children:[e.jsx("div",{className:"embed-error-icon",children:"ðŸ“¹"}),e.jsx("p",{className:"embed-error-title",children:"Video temporarily unavailable"}),e.jsx("p",{className:"embed-error-detail",children:"No video file is associated with this lesson."})]})}),a&&e.jsx("a",{href:`https://drive.google.com/file/d/${a}/view`,target:"_blank",rel:"noopener noreferrer",className:"drive-fallback-link",children:"ðŸ”— Video not loading? Open in Google Drive"}),l&&e.jsx(Ss,{microLesson:l,courses:r}),e.jsxs("div",{className:"video-controls",children:[e.jsx("button",{className:"complete-btn",onClick:h,children:c?"Mark Complete & Continue â†’":"Complete & Try Exercise â†’"}),e.jsx("button",{className:"exit-btn",onClick:i,children:"Exit Path"})]})]})}function Ss({microLesson:t,courses:s}){const[n,o]=_.useState(!1),[c,l]=_.useState("quick_fix"),r=t?.quick_fix,h=t?.why_it_works,i=t?.related_situations,a=g=>{l(v=>v===g?null:g)},p=g=>g?g.replace(/\s*\[\d+(?:[,\s]*\d+)*\]/g,"").trim():null;return e.jsxs("div",{className:`gp-ai-lesson ${n?"open":"collapsed"}`,children:[e.jsxs("button",{className:"gp-ai-lesson-toggle",onClick:()=>o(g=>!g),children:[e.jsx("span",{className:"gp-ai-badge",children:"âœ¨ AI Guide"}),e.jsx("span",{className:"gp-ai-subtitle",children:"What to look for"}),e.jsx("span",{className:"gp-ai-chevron",children:n?"â–¾":"â–¸"})]}),n&&e.jsxs("div",{className:"gp-ai-body",children:[r&&e.jsxs("div",{className:`gp-ai-section ${c==="quick_fix"?"expanded":""}`,children:[e.jsxs("button",{className:"gp-ai-section-toggle",onClick:()=>a("quick_fix"),children:[e.jsxs("span",{children:["âš¡ ",r.title||"Quick Fix"]}),e.jsx("span",{className:"gp-ai-section-chevron",children:c==="quick_fix"?"â–¾":"â–¸"})]}),c==="quick_fix"&&r.steps&&e.jsx("ol",{className:"gp-ai-steps",children:r.steps.map((g,v)=>e.jsx("li",{children:p(g)},v))})]}),h&&e.jsxs("div",{className:`gp-ai-section ${c==="why"?"expanded":""}`,children:[e.jsxs("button",{className:"gp-ai-section-toggle",onClick:()=>a("why"),children:[e.jsx("span",{children:"ðŸ§  Why This Works"}),h.key_concept&&e.jsx("span",{className:"gp-ai-concept-tag",children:h.key_concept}),e.jsx("span",{className:"gp-ai-section-chevron",children:c==="why"?"â–¾":"â–¸"})]}),c==="why"&&e.jsx("p",{className:"gp-ai-explanation",children:p(h.explanation)})]}),i&&i.length>0&&e.jsxs("div",{className:`gp-ai-section ${c==="related"?"expanded":""}`,children:[e.jsxs("button",{className:"gp-ai-section-toggle",onClick:()=>a("related"),children:[e.jsx("span",{children:"ðŸ”— Related Situations"}),e.jsx("span",{className:"gp-ai-count-tag",children:i.length}),e.jsx("span",{className:"gp-ai-section-chevron",children:c==="related"?"â–¾":"â–¸"})]}),c==="related"&&e.jsx("div",{className:"gp-ai-scenarios",children:i.map((g,v)=>e.jsxs("div",{className:"gp-ai-scenario",children:[e.jsxs("strong",{children:["ðŸ’¡ ",g.scenario]}),e.jsx("p",{children:p(g.connection)})]},v))})]})]})]})}function dt({course:t,stepNumber:s,totalSteps:n,onComplete:o,onExit:c}){const[l,r]=_.useState(!1),h=t._resourceType==="doc"?"ðŸ“–":"â–¶ï¸",i=t._resourceType==="doc"?"Documentation":"YouTube Video",a=t._resourceType==="doc"?"Epic Docs":t._channel||"YouTube",p=t._resourceType!=="doc",g=(()=>{if(!p||!t._url)return null;try{const x=new URL(t._url);if(x.hostname.includes("youtube.com"))return x.searchParams.get("v");if(x.hostname.includes("youtu.be"))return x.pathname.slice(1)}catch{}return null})(),v=x=>{const d=Math.floor(x/60),m=x%60;return`${d}:${m.toString().padStart(2,"0")}`};return e.jsxs("div",{className:"reading-step",children:[e.jsxs("div",{className:"reading-step-header",children:[e.jsxs("span",{className:"reading-step-badge",children:[h," ",i]}),e.jsxs("span",{className:"reading-step-progress",children:["Step ",s," of ",n]})]}),e.jsx("h2",{className:"reading-step-title",children:t.title}),e.jsxs("div",{className:"reading-step-meta",children:[t._tier&&e.jsx("span",{className:`tier-badge tier-${t._tier}`,children:t._tier}),t._channelTrust&&e.jsx("span",{className:`channel-trust-badge trust-${t._channelTrust}`,children:t._channelTrust==="official"?"âœ“ Official":"â­ Expert"}),e.jsxs("span",{className:"reading-step-time",children:["â± ",t._readTimeMinutes," min ",p?"watch":"read"]})]}),t._topics&&t._topics.length>0&&e.jsx("div",{className:"reading-step-topics",children:t._topics.map((x,d)=>e.jsx("span",{className:"topic-chip",children:x.replace(/_/g," ")},d))}),t._description&&e.jsx("p",{className:"reading-step-description",children:t._description}),g&&e.jsx("div",{className:"reading-step-player",children:e.jsx("iframe",{src:`https://www.youtube-nocookie.com/embed/${g}?rel=0&modestbranding=1`,title:t.title,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,className:"reading-step-iframe"})}),t._keySteps&&t._keySteps.length>0?e.jsxs("div",{className:"key-steps-section",children:[e.jsx("h3",{className:"key-steps-heading",children:"ðŸŽ¯ Key Takeaways"}),e.jsx("ol",{className:"key-steps-list",children:t._keySteps.map((x,d)=>e.jsx("li",{className:"key-step-item",children:_s(x)},d))})]}):t._description?e.jsxs("div",{className:"key-steps-section key-steps-fallback",children:[e.jsx("h3",{className:"key-steps-heading",children:"ðŸŽ¯ What to Focus On"}),e.jsxs("ul",{className:"key-steps-list",children:[t._sections&&t._sections.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("li",{className:"key-step-item",children:["Read through the ",e.jsx("strong",{children:t.title})," page, focusing on these sections:"]}),t._sections.slice(0,5).map((x,d)=>e.jsxs("li",{className:"key-step-item",children:["ðŸ“– Work through the ",e.jsx("strong",{children:x})," section"]},d))]}):e.jsxs(e.Fragment,{children:[e.jsxs("li",{className:"key-step-item",children:["Understand how ",e.jsx("strong",{children:t.title})," works in UE5"]}),t._topics&&t._topics.length>0&&t._topics.slice(0,2).map((x,d)=>e.jsxs("li",{className:"key-step-item",children:["Pay attention to ",e.jsx("strong",{children:x.replace(/_/g," ")})," concepts and workflows"]},d)),t._subsystem&&e.jsxs("li",{className:"key-step-item",children:["Note how ",e.jsx("strong",{children:t._subsystem})," integrates with the editor"]})]}),e.jsx("li",{className:"key-step-item",children:"Try applying these techniques in your own UE5 project"})]})]}):null,t._chapters&&t._chapters.length>0&&e.jsxs("div",{className:"chapters-section",children:[e.jsx("h3",{className:"chapters-heading",children:"ðŸ“‘ Chapters"}),e.jsx("div",{className:"chapters-list",children:t._chapters.map((x,d)=>e.jsxs("a",{href:g?`https://www.youtube.com/watch?v=${g}&t=${x.seconds}`:"#",target:"_blank",rel:"noopener noreferrer",className:"chapter-item",children:[e.jsx("span",{className:"chapter-time",children:v(x.seconds)}),e.jsx("span",{className:"chapter-label",children:x.label})]},d))})]}),t._seeAlso&&t._seeAlso.length>0&&e.jsxs("div",{className:"see-also-section",children:[e.jsx("h3",{className:"see-also-heading",children:"ðŸ”— See Also"}),e.jsx("div",{className:"see-also-links",children:t._seeAlso.map((x,d)=>{const m=$t[x.docKey],N=m?m.url:"#";return e.jsxs("a",{href:N,target:"_blank",rel:"noopener noreferrer",className:"see-also-link",title:m?m.description:x.label,children:["â†’ ",x.label]},d)})})]}),e.jsx("div",{className:"reading-step-source",children:e.jsxs("span",{className:"reading-step-source-label",children:["Source: ",a]})}),e.jsxs("a",{href:t._url,target:"_blank",rel:"noopener noreferrer",className:"reading-step-link",onClick:()=>r(!0),children:[t._resourceType==="doc"?"ðŸ“„ Open Documentation":"â–¶ï¸ Watch on YouTube",e.jsx("span",{className:"reading-step-link-arrow",children:"â†—"})]}),e.jsxs("div",{className:"reading-step-actions",children:[e.jsx("button",{className:`reading-step-complete ${l?"ready":""}`,onClick:o,title:l?"Continue to next step":"Mark as read and continue",children:l?"âœ“ Read â€” Continue â†’":"Mark as Read â†’ Continue"}),e.jsx("button",{className:"reading-step-exit",onClick:c,children:"âœ• Exit Path"})]})]})}dt.propTypes={course:f.object.isRequired,stepNumber:f.number.isRequired,totalSteps:f.number.isRequired,onComplete:f.func.isRequired,onExit:f.func.isRequired};const ut={},ht={};(Rt.courses||[]).forEach(t=>{ut[t.code]=t.title,ht[t.code]=t.versions||[]});function Cs(t){const s=ht[t];return!s||s.length===0?!1:s.every(n=>{const o=String(n).replace(/^V/i,"");return o.startsWith("4")&&!o.startsWith("4.")?/^4\d{1,2}$/.test(o):o.startsWith("4.")})}function ks(t){if(!t||t<=0)return"";const s=Math.round(t/60);return s<1?"<1 min":`${s} min`}function Pe({video:t,isAdded:s,onToggle:n,userQuery:o}){const{title:c,duration:l,driveId:r,courseCode:h,_curatedMatch:i,role:a,reason:p,matchPercent:g,matchReason:v}=t,x=g>=100?"best":g>=70?"strong":g>=40?"good":"related",d=g>=100?"Best Match":g>=70?"Strong Match":g>=40?"Good Match":"Related",m=c?.replace(/\s+(?:Part\s+[A-Z]|PT\s*\d+)$/i,"").trim()||c,N=h?st[h]:null,j=N?.prereqs||[],[k,L]=_.useState(()=>zt(r)),[q,V]=_.useState(!1),P=_.useRef(null),u=_.useRef(null);_.useEffect(()=>{if(!q)return;const w=I=>{P.current&&!P.current.contains(I.target)&&V(!1)};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[q]);const S=w=>{w.stopPropagation(),Ft(r,o||""),L("up")},C=w=>{w.stopPropagation(),Ut(r,o||""),L("down")},b=r?`https://drive.google.com/thumbnail?id=${r}&sz=w320`:null;return e.jsx("div",{ref:u,className:`video-result-card ${s?"added":""} ${i?"curated":""} ${k==="down"?"demoted":""}`,role:"button",tabIndex:0,children:e.jsxs("div",{className:"vrc-compact",children:[e.jsxs("div",{className:"vrc-thumbnail",children:[b?e.jsx("img",{src:b,alt:m,onError:w=>{w.target.style.display="none",w.target.nextSibling.style.display="flex"}}):null,e.jsx("div",{className:"vrc-thumb-fallback",style:{display:b?"none":"flex"},children:e.jsx("span",{className:"vrc-play-icon",children:e.jsx(Wt,{size:24})})}),l>0&&e.jsx("span",{className:"vrc-duration",children:ks(l)})]}),e.jsxs("div",{className:"vrc-badge-row",children:[g!=null&&e.jsxs("span",{className:`vrc-match-badge vrc-match-${x}`,title:`${g}% match`,children:[e.jsx("span",{className:"vrc-match-dot"}),d]}),i&&e.jsx("span",{className:"vrc-curated-badge",children:"âœ“ Solution"}),a&&a!=="core"&&e.jsxs("div",{className:"vrc-role-wrapper",ref:a==="prerequisite"?P:null,children:[e.jsxs("button",{className:`vrc-role-badge vrc-role-${a} ${a==="prerequisite"?"vrc-role-clickable":""}`,onClick:w=>{w.stopPropagation(),a==="prerequisite"&&V(I=>!I)},title:a==="prerequisite"?"Click to see why this is a prerequisite":void 0,children:[a==="prerequisite"&&"ðŸ”— Prerequisite",a==="troubleshooting"&&"ðŸ”§ Troubleshooting",a==="supplemental"&&"ðŸ“š Supplemental"]}),q&&a==="prerequisite"&&e.jsxs("div",{className:"vrc-prereq-tooltip",children:[e.jsx("strong",{children:"Prerequisite Course"}),j.length>0?e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"Watch these first:"}),e.jsx("ul",{className:"vrc-prereq-list",children:j.map(w=>e.jsxs("li",{children:["ðŸ“˜ ",ut[w]||w,N?.reasons?.[w]&&e.jsxs("span",{className:"vrc-prereq-why",children:[" â€” ",N.reasons[w]]})]},w))})]}):e.jsx("p",{children:"Watch this first â€” it covers foundational concepts needed before advancing."}),p&&e.jsx("p",{className:"vrc-tip-reason",children:p})]})]}),h&&Cs(h)&&e.jsx("span",{className:"vrc-ue4-badge",title:"This content was created for Unreal Engine 4 â€” some details may differ in UE5",children:"âš ï¸ UE4"})]}),e.jsxs("div",{className:"vrc-info",children:[e.jsx("h4",{className:"vrc-title",children:m}),v&&e.jsx("p",{className:"vrc-match-reason",children:v})]}),e.jsxs("div",{className:"vrc-actions",children:[e.jsxs("div",{className:"vrc-feedback",children:[e.jsx("button",{className:`vrc-fb-btn ${k==="up"?"active-up":""}`,onClick:S,"aria-label":"Helpful",title:"This was helpful",children:e.jsx("span",{className:"vrc-fb-emoji",children:"ðŸ‘"})}),e.jsx("button",{className:`vrc-fb-btn ${k==="down"?"active-down":""}`,onClick:C,"aria-label":"Not helpful",title:"Not relevant",children:e.jsx("span",{className:"vrc-fb-emoji",children:"ðŸ‘Ž"})})]}),e.jsx("button",{className:`vrc-add-btn ${s?"vrc-added":""}`,onClick:w=>{w.stopPropagation(),n(t)},"aria-label":s?"Remove from playlist":"Add to playlist",children:s?e.jsxs(e.Fragment,{children:[e.jsx($e,{size:14})," Added"]}):e.jsxs(e.Fragment,{children:[e.jsx(Lt,{size:14})," Add"]})})]})]})})}Pe.propTypes={video:f.shape({driveId:f.string,title:f.string.isRequired,courseName:f.string,duration:f.number,matchedTags:f.arrayOf(f.string),courseCode:f.string,topSegments:f.array,docLinks:f.array,_curatedMatch:f.bool,role:f.oneOf(["prerequisite","core","troubleshooting","supplemental"]),reason:f.string,estimatedMinutes:f.number}).isRequired,isAdded:f.bool,onToggle:f.func.isRequired,userQuery:f.string};function Qe(t){const s=Math.round(t/60);if(s<1)return"<1 min";if(s>=60){const n=Math.floor(s/60),o=s%60;return o>0?`${n}h ${o}m`:`${n}h`}return`${s} min`}const Ts={video:"ðŸ“º",doc:"ðŸ“–",youtube:"â–¶ï¸"};function mt({cart:t,onRemove:s,onClear:n,onWatchPath:o}){const c=t.reduce((a,p)=>a+(p.duration||(p.readTimeMinutes||p.durationMinutes||0)*60),0),l=t.filter(a=>(a.type||"video")==="video").length,r=t.filter(a=>a.type==="doc").length,h=t.filter(a=>a.type==="youtube").length,i=[];return l>0&&i.push(`${l} video${l!==1?"s":""}`),r>0&&i.push(`${r} doc${r!==1?"s":""}`),h>0&&i.push(`${h} YT`),e.jsxs("div",{className:"cart-panel",children:[e.jsxs("div",{className:"cart-header",children:[e.jsx("h3",{className:"cart-title",children:"ðŸ›’ My Learning Path"}),t.length>0&&e.jsx("button",{className:"cart-clear-btn",onClick:n,title:"Clear all",children:"Clear"})]}),t.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"cart-stats",children:[e.jsx("span",{className:"cart-stat-count",children:i.join(" Â· ")}),e.jsx("span",{className:"cart-stat-dot",children:"Â·"}),e.jsx("span",{className:"cart-stat-time",children:Qe(c)})]}),c>28800&&e.jsx("div",{className:"cart-warning",children:"âš ï¸ That's over 8 hours of content â€” consider narrowing your focus to the most relevant items."}),e.jsx("div",{className:"cart-items",children:t.map((a,p)=>{const g=a.itemId||a.driveId||p,v=a.type||"video",x=Ts[v]||"ðŸ“º",d=v==="video"?ce(a.title):a.title,m=a.duration>0?Qe(a.duration):a.readTimeMinutes?`${a.readTimeMinutes} min read`:a.durationMinutes?`${a.durationMinutes} min`:null;return e.jsxs("div",{className:`cart-item cart-item-${v}`,children:[e.jsx("span",{className:"cart-item-num",children:p+1}),e.jsx("span",{className:"cart-item-icon",title:v,children:x}),e.jsxs("div",{className:"cart-item-info",children:[e.jsx("span",{className:"cart-item-title",children:d}),m&&e.jsx("span",{className:"cart-item-dur",children:m})]}),e.jsx("button",{className:"cart-item-remove",onClick:()=>s(g),"aria-label":`Remove ${a.title}`,children:"Ã—"})]},g)})}),e.jsx("button",{className:"cart-watch-btn",onClick:o,children:"â–¶ Watch Path"})]}):e.jsxs("div",{className:"cart-empty",children:[e.jsx("span",{className:"cart-empty-icon",children:"ðŸ“º"}),e.jsx("p",{children:"Add videos, docs, and resources to build your learning path"})]})]})}mt.propTypes={cart:f.arrayOf(f.shape({itemId:f.string,driveId:f.string,type:f.oneOf(["video","doc","youtube"]),title:f.string.isRequired,duration:f.number,readTimeMinutes:f.number,durationMinutes:f.number})).isRequired,onRemove:f.func.isRequired,onClear:f.func.isRequired,onWatchPath:f.func.isRequired};const pt="ue5_video_cart";function Is(){try{const t=localStorage.getItem(pt);return t?JSON.parse(t):[]}catch{return[]}}function Ne(t){try{localStorage.setItem(pt,JSON.stringify(t))}catch{}}function ge(t){return t.itemId||t.driveId||t.id||`${t.type}_${t.url}`}function Es(){const[t,s]=_.useState(Is),n=_.useCallback(a=>{s(p=>{const g=ge(a);if(p.some(d=>ge(d)===g))return p;const v={...a,itemId:g,type:a.type||"video"},x=[...p,v];return Ne(x),x})},[]),o=_.useCallback(a=>{s(p=>{const g=p.filter(v=>ge(v)!==a&&v.driveId!==a);return Ne(g),g})},[]),c=_.useCallback(()=>{s([]),Ne([])},[]),l=_.useCallback(a=>t.some(p=>ge(p)===a||p.driveId===a),[t]),r=t.filter(a=>(a.type||"video")==="video").length,h=_.useMemo(()=>t.reduce((a,p)=>a+(p.duration||(p.readTimeMinutes||p.durationMinutes||0)*60),0),[t]),i=_.useMemo(()=>{const a={video:[],doc:[],youtube:[]};for(const p of t){const g=p.type||"video";(a[g]||a.video).push(p)}return a},[t]);return{cart:t,addToCart:n,removeFromCart:o,clearCart:c,isInCart:l,videoCount:r,totalDuration:h,itemsByType:i}}let we=null;async function Ls(){if(!we){const t=await se(()=>import("./data-embeddings-EsTyY_EC.js"),[]);we=t.default||t}return we}function Oe(t,s){if(!t||!s||t.length!==s.length)return 0;let n=0,o=0,c=0;for(let r=0;r<t.length;r++)n+=t[r]*s[r],o+=t[r]*t[r],c+=s[r]*s[r];const l=Math.sqrt(o)*Math.sqrt(c);return l===0?0:n/l}async function Ms(t,s=5,n=.3){const o=await Ls();if(!t||!o?.courses)return[];const c=[];for(const[l,r]of Object.entries(o.courses)){const h=Oe(t,r.embedding);h>=n&&c.push({code:l,title:r.title,similarity:h})}return c.sort((l,r)=>r.similarity-l.similarity),c.slice(0,s)}let Se=null,Ce=null;async function $s(){if(!Se){const t=await se(()=>import("./data-search-SjqZFhcO.js").then(s=>s.s),[]);Se=t.default||t}return Se}async function ze(){if(!Ce){const t=await se(()=>import("./data-search-SjqZFhcO.js").then(s=>s.a),[]);Ce=t.default||t}return Ce}let ke=null,ie=null;function Rs(t,s=768){const n=atob(t),o=new Uint8Array(n.length);for(let r=0;r<n.length;r++)o[r]=n.charCodeAt(r);const c=new DataView(o.buffer),l=new Float32Array(s);for(let r=0;r<s;r++){const h=c.getUint16(r*2,!0);l[r]=qs(h)}return l}function qs(t){const s=t>>15&1,n=t>>10&31,o=t&1023;return n===0?(s?-1:1)*Math.pow(2,-14)*(o/1024):n===31?o?NaN:s?-1/0:1/0:(s?-1:1)*Math.pow(2,n-15)*(1+o/1024)}async function Ps(){if(ie)return ie;if(!ke)try{const s=await fetch(new URL("../data/segment_embeddings.json",import.meta.url));if(!s.ok)throw new Error(`HTTP ${s.status}`);ke=await s.json()}catch(s){return J("âš ï¸ segment_embeddings.json not available:",s.message),null}const t=ke?.segments;if(!t)return null;ie=new Map;for(const[s,n]of Object.entries(t))ie.set(s,{vector:Rs(n.embedding),courseCode:n.course_code,videoKey:n.video_key,videoTitle:n.video_title,startTimestamp:n.start_timestamp,endTimestamp:n.end_timestamp,startSeconds:n.start_seconds,text:n.text,tokenEstimate:n.token_estimate});return Y(`[SegmentSearch] Decoded ${ie.size} segment embeddings`),ie}async function As(t,s=[]){if(!t||t.length<3)return[];const n=t.toLowerCase().split(/\s+/).filter(r=>r.length>2&&!he.has(r));if(n.length===0)return[];const o=await $s(),c=[],l=o?.course_words||{};for(const[r,h]of Object.entries(l)){let i=0;const a=[];for(const p of n)if(h[p]&&(i+=h[p]*10,a.push(p)),p.length>=4)for(const[g,v]of Object.entries(h))g!==p&&g.length>=4&&(g.startsWith(p)||p.startsWith(g))&&(i+=v*3,a.includes(g)||a.push(g));if(i>=30&&a.length>0){const p=s.find(v=>v.code===r),g=await Ds(r,a);c.push({courseCode:r,courseTitle:p?.title||r,score:i,matchedKeywords:a,topSegments:g,estimatedSegment:g.length>0?g[0]:null,videoCount:p?.video_count||0,duration:p?.duration_formatted||"Unknown"})}}return c.sort((r,h)=>h.score-r.score).slice(0,5)}async function Ds(t,s){const o=(await ze())[t];if(!o||!o.videos)return[];const c=[];for(const[l,r]of Object.entries(o.videos))if(r.segments)for(const h of r.segments){const i=h.text.toLowerCase();let a=0;const p=[];for(const g of s){const v=g.toLowerCase(),x=new RegExp(v.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi"),d=i.match(x);d&&(a+=d.length*10,p.push(g)),i.includes(v)&&(a+=5,p.includes(g)||p.push(g))}if(a>0){let g=h.text;if(g.length>120){const v=p[0]||"",x=g.toLowerCase().indexOf(v.toLowerCase());x>40&&(g="..."+g.substring(x-30)),g.length>120&&(g=g.substring(0,117)+"...")}c.push({videoKey:l,videoTitle:r.title,timestamp:h.start,startSeconds:h.start_seconds,endTimestamp:h.end,previewText:g,matchedKeywords:p,score:a})}}return c.sort((l,r)=>r.score-l.score).slice(0,3)}async function Os(t,s=10,n=.35){if(!t)return[];const o=await Ps();if(!o)return[];const c=[];for(const[l,r]of o){const h=Oe(t,r.vector);h>=n&&c.push({id:l,courseCode:r.courseCode,videoKey:r.videoKey,videoTitle:r.videoTitle,timestamp:r.startTimestamp,endTimestamp:r.endTimestamp,startSeconds:r.startSeconds,previewText:r.text,similarity:h,source:"transcript"})}return c.sort((l,r)=>r.similarity-l.similarity),c.slice(0,s)}const zs=60,Fs=new Set(["rendering.lumen","rendering.nanite","rendering.virtualShadowMaps","rendering.substrate","worldbuilding.worldPartition"]);function ue(t){return!!(t.videos?.length&&t.videos[0]?.drive_id||t.source==="youtube"&&t.youtube_url||t.source==="epic_docs")}function Us(t){const s=(t||"").toLowerCase();return/\bue\s*5\b|\bunreal\s*engine\s*5\b|\b5\.\d\b/.test(s)?5:/\bue\s*4\b|\bunreal\s*engine\s*4\b|\b4\.\d{1,2}\b/.test(s)?4:null}async function Be(t,s,n=[],o="",c=[]){if(!s||s.length===0)return[];const l=t?.userQuery||"",r=l.toLowerCase();for(const y of qt)if(y.patterns.some($=>r.includes($))){const $=y.courses.map(z=>{const D=s.find(A=>A.code===z);return!D||!ue(D)?null:{...D,_relevanceScore:200,_curatedMatch:!0,_curatedExplanation:y.explanation}}).filter(Boolean);if($.length>0)return Y("âœ… Curated solution match:",y.explanation),$}const h=`${l} ${o}`.trim(),i=te.matchErrorSignature(h),a=i.map(y=>y.tag.tag_id),p=[...new Set([...n,...a])];i.length>0&&Y("ðŸ” Error signatures detected:",i.map(y=>`${y.tag.display_name} (${y.matchedSignature}, ${y.confidence})`));const g=te.extractTagsFromText(l),v=g.matchedTagIds||[];if(v.length>0){Y("ðŸ·ï¸ Tag taxonomy matches:",g.matches.map(y=>`${y.tagId} (via "${y.matchedTerm}", ${y.matchType})`));for(const y of v)p.includes(y)||p.push(y)}const x=o.toLowerCase().split(/[\s\n:;,()[\]{}]+/).filter(y=>y.length>3&&!/^[0-9]+$/.test(y)).slice(0,10),d=l.toLowerCase().split(/\s+/).filter(y=>y.length>2&&!he.has(y)),m=new Set(d),N=l.toLowerCase();for(const[y,T]of Object.entries(Pt))if(N.includes(y))for(const $ of T)$.split(/\s+/).forEach(z=>{z.length>2&&!he.has(z)&&m.add(z)});const j=[...m],k=async y=>!y||y.length<5?[]:(await As(y,s)).map($=>{const z=s.find(D=>D.code===$.courseCode);return!z||!ue(z)?null:{...z,_relevanceScore:$.score,_matchedKeywords:$.matchedKeywords}}).filter(Boolean),L=y=>y.length===0?[]:s.filter(ue).map($=>{const z=($.title||"").toLowerCase(),D=($.description||"").toLowerCase(),A=[...$.canonical_tags||[],...$.gemini_system_tags||[],...$.extracted_tags||[]].map(Z=>typeof Z=="string"?Z.toLowerCase():"").join(" ");let R=0;const E=[];for(const Z of y)z.includes(Z)?(R+=50,E.push(Z)):A.includes(Z)?(R+=30,E.push(Z)):D.includes(Z)&&(R+=10,E.push(Z));if(v.length>0){const Z=($.canonical_tags||[]).map(ae=>ae.toLowerCase());v.some(ae=>Z.some(de=>de.includes(ae.split(".").pop())))&&(R*=3)}const W=new Set(E).size;W>=2&&(R*=1+W*.3);const re=y.length>0?W/y.length:1;return y.length>=2&&re<.5?R*=.3:re>=1&&(R*=2),R===0?null:{...$,_relevanceScore:R,_matchedKeywords:E}}).filter(Boolean).sort(($,z)=>z._relevanceScore-$._relevanceScore),q=y=>p.length===0?y:y.map(T=>{const $=T.extracted_tags||T.tags||[],A=(Array.isArray($)?$:Object.values($)).map(R=>typeof R=="string"?R:R.tag_id||R.name||"").filter(Boolean).some(R=>p.some(E=>R.toLowerCase().includes(E.toLowerCase())||E.toLowerCase().includes(R.toLowerCase())));return{...T,_relevanceScore:A?T._relevanceScore*2:T._relevanceScore*.5}}).sort((T,$)=>$._relevanceScore-T._relevanceScore),V=x.length>0?`${l} ${x.join(" ")}`:l,P=await k(V),u=x.length>0?[...j,...x]:j,S=L(u),C=new Set,b=[];for(const y of P)C.has(y.code)||(b.push(y),C.add(y.code));for(const y of S)if(!C.has(y.code))b.push(y),C.add(y.code);else{const T=b.find($=>$.code===y.code);T&&(T._relevanceScore+=y._relevanceScore)}const I=(b.length>0?b[0]._relevanceScore:0)>=zs;if(c.length>0&&!I)for(const y of c)if(C.has(y.code)){const T=b.find($=>$.code===y.code);T&&(T._relevanceScore+=y.similarity*40)}else{const T=s.find($=>$.code===y.code);T&&ue(T)&&(b.push({...T,_relevanceScore:y.similarity*100,_matchedKeywords:["semantic-match"],_semanticMatch:!0,_tier:2}),C.add(y.code))}else c.length>0;b.sort((y,T)=>T._relevanceScore-y._relevanceScore);const M=q(b);if(M.length>=3)return Te(M.slice(0,5),l);const F=[V,t?.diagnosis?.problem_summary,...t?.intent?.systems||[]].filter(Boolean).join(" "),H=F.toLowerCase().split(/\s+/).filter(y=>y.length>2&&!he.has(y)),B=await k(F),Q=L(H);for(const y of[...B,...Q])C.has(y.code)||(b.push(y),C.add(y.code));b.sort((y,T)=>T._relevanceScore-y._relevanceScore);const G=q(b);if(G.length>=3)return Te(G.slice(0,5),l);const ne=s.map(y=>{const T=te.scoreCourseRelevance(y,u);return{...y,_relevanceScore:T.score,_scoreBreakdown:T.breakdown,_topContributors:T.topContributors}}).filter(y=>y._relevanceScore>0&&ue(y)).sort((y,T)=>T._relevanceScore-y._relevanceScore).slice(0,5);return Te(q(ne),l)}function Te(t,s){const n=Us(s);return n?t.map(o=>{const l=[...o.canonical_tags||[],...o.gemini_system_tags||[],...o.extracted_tags||[]].map(r=>typeof r=="string"?r.toLowerCase():"").some(r=>[...Fs].some(h=>r.includes(h.split(".").pop())));return n===4&&l?(Y(`â¬‡ï¸ UE4 demotion: ${o.code} (has UE5-only tags)`),{...o,_relevanceScore:o._relevanceScore*.2}):n===5&&l?{...o,_relevanceScore:o._relevanceScore*1.5}:o}).sort((o,c)=>c._relevanceScore-o._relevanceScore):t}let Ie=null;async function Vs(){if(!Ie){const t=await se(()=>import("./data-courses-aYLqO-5R.js").then(s=>s.j),[]);Ie=t.default||t}return Ie}const Ee=new Set(["help","helpful","helps","use","used","using","make","made","get","getting","look","going","come","know","thing","work","working","want","need","show","start","take","right","well"]);async function Ke(t,s,n={}){const o=[],c=(s||"").toLowerCase().split(/\s+/).filter(d=>d.length>2),l=await Vs(),r=[],h=(s||"").toLowerCase();for(const[d,m]of Object.entries(l))h.includes(d)&&r.push({label:m.label,url:m.url});for(const d of t){if(d.source==="youtube"&&d.youtube_url){const N=n[d.code]||{},j=(()=>{const k=(d._matchedKeywords||[]).filter(L=>L.length>3&&!Ee.has(L.toLowerCase())).slice(0,3);return k.length>0?k:[d.topic||d.tags?.topic||"UE5"].flat().slice(0,3)})();o.push({driveId:d.youtube_url,title:ce(d.title||d.code),duration:d.duration_seconds||0,courseCode:d.code,courseName:d.title||d.code,matchedTags:j,videoIndex:0,relevanceScore:d._relevanceScore||0,titleRelevance:0,isIntro:!1,timestampHint:null,startSeconds:0,topSegments:[],watchHint:"â–¶ Watch on YouTube",docLinks:r,_curatedMatch:d._curatedMatch||!1,_curatedExplanation:d._curatedExplanation||null,role:N.role||null,reason:N.reason||null,estimatedMinutes:N.estimatedMinutes||null,_source:"youtube",_externalUrl:d.youtube_url,type:"youtube",url:d.youtube_url,channel:d.channel_name||d.channel||null,channelTrust:d.channel_trust||null,topics:d.topics||[],description:d.description||"",durationMinutes:d.duration_seconds?Math.round(d.duration_seconds/60):10});continue}if(d.source==="epic_docs"){const N=d.url||d.youtube_url||"#",j=n[d.code]||{},k=(()=>{const L=(d._matchedKeywords||[]).filter(q=>q.length>3&&!Ee.has(q.toLowerCase())).slice(0,3);return L.length>0?L:[d.topic||d.tags?.topic||"UE5"].flat().slice(0,3)})();o.push({driveId:`doc_${d.code}`,title:ce(d.title||d.code),duration:0,courseCode:d.code,courseName:d.title||d.code,matchedTags:k,videoIndex:0,relevanceScore:d._relevanceScore||0,titleRelevance:0,isIntro:!1,timestampHint:null,startSeconds:0,topSegments:[],watchHint:"ðŸ“– Read Epic Docs",docLinks:[{label:d.title||"Epic Docs",url:N},...r],_curatedMatch:d._curatedMatch||!1,_curatedExplanation:d._curatedExplanation||null,role:j.role||null,reason:j.reason||null,estimatedMinutes:j.estimatedMinutes||null,_source:"epic_docs",_externalUrl:N,type:"doc",url:N,topics:d.topics||[],description:d.description||"",readTimeMinutes:10});continue}const m=d.videos||[];if(m.length!==0)for(let N=0;N<m.length;N++){const j=m[N];if(!j.drive_id)continue;const k=j.title||j.name||`Video ${N+1}`,L=k.toLowerCase(),q=ce(k),V=c.filter(B=>L.includes(B)).length,P=V*50,u=await Gs(d.code,k,N),S=await Ws(d.code,u,c),C=L.includes("intro")||L.includes("wrap up")||L.includes("outro"),b=C?-20:0,w=P+S.score+b+(d._relevanceScore||0),I=Vt(j.drive_id,w);let M="â–¶ Watch full video";const O=(S.topSegments||[])[0]||S.bestSegment||null;if(O){const B=O.timestamp||"0:00",Q=O.previewText,G=Q.length>60?Q.substring(0,57)+"...":Q;M=O.startSeconds<5?`ðŸ“ Start of video â€” "${G}"`:`ðŸ“ Jump to ${B} â€” "${G}"`}const F=n[d.code]||{},H=(()=>{const B=(d._matchedKeywords||[]).filter(Q=>Q.length>3&&!Ee.has(Q.toLowerCase())).slice(0,3);return B.length>0?B:[d.topic||d.tags?.topic||"UE5"].flat().slice(0,3)})();o.push({driveId:j.drive_id,title:q,duration:j.duration_seconds||0,courseCode:d.code,courseName:d.title||d.code,matchedTags:H,videoIndex:N,relevanceScore:I,titleRelevance:V,isIntro:C,timestampHint:S.bestSegment?.timestamp||null,startSeconds:S.bestSegment?.startSeconds||0,topSegments:S.topSegments||[],watchHint:M,docLinks:r,_curatedMatch:d._curatedMatch||!1,_curatedExplanation:d._curatedExplanation||null,role:F.role||null,reason:F.reason||null,estimatedMinutes:F.estimatedMinutes||null})}}const i=new Map;for(const d of o){const m=i.get(d.driveId);(!m||d.relevanceScore>m.relevanceScore)&&i.set(d.driveId,d)}const a=Array.from(i.values());a.sort((d,m)=>m.relevanceScore-d.relevanceScore);const p=new Map,g=1,v=a.filter(d=>{const m=p.get(d.courseCode)||0;return m>=g?!1:(p.set(d.courseCode,m+1),!0)});if(v.length>3){const d=v.map(k=>k.relevanceScore),m=d[Math.floor(d.length/2)],N=Math.max(m*.5,10),j=v.filter(k=>k.relevanceScore>=N);if(j.length>=3){const k=j.slice(0,6);return He(k,c),k}}const x=v.slice(0,6);return He(x,c),x}function He(t,s){if(t.length===0)return;const n=Math.max(t[0].relevanceScore,1);for(const o of t){o.matchPercent=Math.min(100,Math.round(o.relevanceScore/n*100));const c=[];if(o._curatedMatch&&c.push("Known solution for this problem"),o.titleRelevance>0){const l=s.filter(r=>(o.title||"").toLowerCase().includes(r)).slice(0,3);l.length>0&&c.push(`Title matches: ${l.join(", ")}`)}if(o.topSegments.length>0){const l=new Set;for(const h of o.topSegments)for(const i of h.matchedKeywords||[])l.add(i);const r=[...l].slice(0,4);r.length>0&&c.push(`Transcript mentions: ${r.join(", ")}`)}o.matchedTags.length>0&&c.length<2&&c.push(`Tagged: ${o.matchedTags.slice(0,3).join(", ")}`),o.matchReason=c.length>0?c.join(" Â· "):"Related to your query"}}async function Gs(t,s,n){const c=(await ze())[t];if(!c?.videos)return null;const l=i=>(i||"").toLowerCase().replace(/\.mp4$/i,"").replace(/_/g," ").trim(),r=l(s),h=Object.keys(c.videos);for(const i of h){const a=l(c.videos[i].title||""),p=l(i);if(r.includes(a)||a.includes(r)||r.includes(p)||p.includes(r))return i}return n<h.length?h[n]:h[0]||null}async function Ws(t,s,n){const o={score:0,bestSegment:null,topSegments:[]},l=(await ze())[t];if(!l?.videos||!s)return o;const r=l.videos[s];if(!r?.segments)return o;const h=[];for(const p of r.segments){const g=p.text.toLowerCase();let v=0;const x=[];for(const d of n)if(g.includes(d)){const m=g.split(d).length-1;v+=m*10,x.push(d)}if(v>0){let d=p.text;if(d.length>100){const m=d.toLowerCase().indexOf(x[0]||"");m>30&&(d="..."+d.substring(m-20)),d.length>100&&(d=d.substring(0,97)+"...")}h.push({timestamp:p.start,startSeconds:p.start_seconds,previewText:d,matchedKeywords:x,score:v})}}h.sort((p,g)=>g.score-p.score);const i=h.slice(0,3);return{score:h.reduce((p,g)=>p+g.score,0),bestSegment:i[0]||null,topSegments:i}}let Le=null,oe=null;function Ys(t,s=768){const n=atob(t),o=new Uint8Array(n.length);for(let r=0;r<n.length;r++)o[r]=n.charCodeAt(r);const c=new DataView(o.buffer),l=new Float32Array(s);for(let r=0;r<s;r++){const h=c.getUint16(r*2,!0);l[r]=Qs(h)}return l}function Qs(t){const s=t>>15&1,n=t>>10&31,o=t&1023;return n===0?(s?-1:1)*Math.pow(2,-14)*(o/1024):n===31?o?NaN:s?-1/0:1/0:(s?-1:1)*Math.pow(2,n-15)*(1+o/1024)}async function Bs(){if(oe)return oe;if(!Le)try{const s=await fetch(new URL("../data/docs_embeddings.json",import.meta.url));if(!s.ok)throw new Error(`HTTP ${s.status}`);Le=await s.json()}catch(s){return J("âš ï¸ docs_embeddings.json not available:",s.message),null}const t=Le?.docs;if(!t)return null;oe=new Map;for(const[s,n]of Object.entries(t))oe.set(s,{vector:Ys(n.embedding),slug:n.slug,url:n.url,title:n.title,section:n.section,text:n.text,tokenEstimate:n.token_estimate});return Y(`[DocsSearch] Decoded ${oe.size} doc embeddings`),oe}async function Ks(t,s=5,n=.35){if(!t)return[];const o=await Bs();if(!o)return[];const c=[];for(const[l,r]of o){const h=Oe(t,r.vector);h>=n&&c.push({id:l,slug:r.slug,url:r.url,title:r.title,section:r.section,previewText:r.text,similarity:h,source:"epic_docs"})}return c.sort((l,r)=>r.similarity-l.similarity),c.slice(0,s)}let fe=null;async function gt(){if(fe)return fe;try{const t=await se(()=>import("./data-courses-aYLqO-5R.js").then(s=>s.j),[]);return fe=t.default||t,fe}catch(t){return J("âš ï¸ doc_links.json not available:",t.message),{}}}const xe={beginner:0,intermediate:1,advanced:2};async function ft(t,{maxTier:s="advanced",limit:n=10}={}){const o=await gt();if(!o||!t?.length)return[];const c=xe[s]??2,l=t.map(i=>i.toLowerCase()),r=[];for(const[i,a]of Object.entries(o)){if((xe[a.tier]??1)>c)continue;let g=0;const v=i.toLowerCase(),x=(a.label||"").toLowerCase(),d=(a.url||"").split("/").pop().replace(/-/g," ").toLowerCase(),m=(a.tags||[]).map(j=>j.toLowerCase()),N=(a.description||"").toLowerCase();for(const j of l)v===j?g+=10:v.includes(j)?g+=5:j.includes(v)||a.subsystem===j||m.includes(j)?g+=4:x.includes(j)?g+=3:m.some(k=>k.includes(j)||j.includes(k))||d.includes(j)?g+=2:N.includes(j)&&(g+=1);g>0&&r.push({key:i,label:a.label,description:a.description||"",url:a.url,tier:a.tier,subsystem:a.subsystem,readTimeMinutes:a.readTimeMinutes||10,prerequisites:a.prerequisites||[],sections:a.sections||[],keySteps:a.keySteps||[],seeAlso:a.seeAlso||[],_score:g,source:"epic_docs"})}r.sort((i,a)=>a._score!==i._score?a._score-i._score:(xe[i.tier]??1)-(xe[a.tier]??1));const h=r.length>0?r[0]._score:1;return r.slice(0,n).map(({_score:i,...a})=>({...a,matchScore:Math.round(i/Math.max(h,1)*100)}))}async function Hs(t,{limit:s=8}={}){const n=await gt();if(!n)return[];const o=await ft(t,{limit:s*2});if(!o.length)return[];const c=new Map(o.map(i=>[i.key,i.matchScore??0])),l=new Set,r=[];function h(i){if(l.has(i))return;l.add(i);const a=n[i];if(a){for(const p of a.prerequisites||[])h(p);r.push({key:i,label:a.label,description:a.description||"",keySteps:a.keySteps||[],seeAlso:a.seeAlso||[],url:a.url,tier:a.tier,subsystem:a.subsystem,readTimeMinutes:a.readTimeMinutes||10,matchScore:c.get(i)??0,source:"epic_docs"})}}for(const i of o)h(i.key);return r.slice(0,s)}const Ze={prerequisite:0,core:1,troubleshooting:2,supplemental:3};function Zs(t){return t.estimated_minutes?t.estimated_minutes:t.total_duration_seconds?Math.round(t.total_duration_seconds/60):(t.videos?.length||1)*10}function Je(t,s){if(s.size===0)return 0;const n=new Set([...t.canonical_tags||[],...t.gemini_system_tags||[],...t.transcript_tags||[]].map(c=>typeof c=="string"?c.toLowerCase():""));if(n.size===0)return 0;let o=0;for(const c of n)(s.has(c)||s.has(c.split(".").pop()))&&o++;return o/n.size}function Js(t,s){const n=[...t.canonical_tags||[],...t.gemini_system_tags||[]].map(h=>typeof h=="string"?h.toLowerCase():""),o=new Set(s.map(h=>h.toLowerCase()));let c=!1;for(const h of n)if(o.has(h)||o.has(h.split(".").pop())){c=!0;break}const l=n.some(h=>{const i=te.getTag(h);return i?.tag_type==="symptom"||i?.tag_type==="error_code"});let r=!1;for(const h of n){const i=te.edgesBySource?.get(h)||[];for(const a of i)if(a.relation==="subtopic"&&o.has(a.target)){r=!0;break}if(r)break}return r?"prerequisite":l?"troubleshooting":c?"core":"supplemental"}function Xe(t,s,n={}){const{timeBudgetMinutes:o=1/0,maxItems:c=8,preferTroubleshooting:l=!1,diversity:r=!0}=n;if(!t||t.length===0)return{path:[],metadata:{totalMinutes:0,tagCoverage:0,diversityScore:1,itemCount:0}};const h=t.map(m=>({course:m,role:Js(m,s),estimatedMinutes:Zs(m),score:m._relevanceScore||0}));h.sort((m,N)=>{const j=Ze[m.role]-Ze[N.role];return j!==0?j:N.score-m.score}),l&&h.sort((m,N)=>{const j=m.role==="troubleshooting"?0:1,k=N.role==="troubleshooting"?0:1;return j!==k?j-k:N.score-m.score});const i=[],a=new Set;let p=0;for(const m of h){if(i.length>=c)break;if(p+m.estimatedMinutes>o||r&&i.length>0&&Je(m.course,a)>.7)continue;const N=Xs(m,s);i.push({course:m.course,role:m.role,reason:N,estimatedMinutes:m.estimatedMinutes}),p+=m.estimatedMinutes,[...m.course.canonical_tags||[],...m.course.gemini_system_tags||[]].map(k=>typeof k=="string"?k.toLowerCase():"").forEach(k=>{a.add(k),a.add(k.split(".").pop())})}const g=new Set(s.map(m=>m.toLowerCase()));let v=0;for(const m of g)(a.has(m)||a.has(m.split(".").pop()))&&v++;const x=g.size>0?v/g.size:0;let d=1;if(i.length>1){let m=0;const N=new Set;for(const j of i)m+=Je(j.course,N),[...j.course.canonical_tags||[]].map(L=>L?.toLowerCase?.()||"").forEach(L=>N.add(L));d=1-m/i.length}return{path:i,metadata:{totalMinutes:p,tagCoverage:Math.round(x*100)/100,diversityScore:Math.round(d*100)/100,itemCount:i.length}}}function Xs(t,s){const{course:n,role:o}=t,c=[...n.canonical_tags||[],...n.gemini_system_tags||[]].map(h=>typeof h=="string"?h.toLowerCase():""),l=new Set(s.map(h=>h.toLowerCase())),r=c.filter(h=>l.has(h)||l.has(h.split(".").pop()));switch(o){case"prerequisite":return`Foundation course â€” covers prerequisite concepts for ${r.slice(0,2).join(", ")}`;case"core":return`Directly covers: ${r.slice(0,3).join(", ")}`;case"troubleshooting":return"Troubleshooting guide â€” addresses symptoms related to your query";case"supplemental":return"Related content â€” expands on topics connected to your query";default:return"Relevant to your search"}}let ee=null;async function xt(){if(ee!=null)return ee;try{const t=await se(()=>import("./data-courses-aYLqO-5R.js").then(s=>s.y),[]);return ee=t.default||t,ee}catch{return ee={channels:{},resources:[]},ee}}const ye={beginner:0,intermediate:1,advanced:2};async function yt(t,{maxTier:s="advanced",limit:n=5}={}){if(!t?.length)return[];const o=await xt();if(!o?.resources?.length)return[];const c=ye[s]??2,l=new Set(t.map(i=>i.toLowerCase())),r=[];for(const i of o.resources){if((ye[i.tier]??1)>c)continue;const p=(i.topics||[]).map(x=>x.toLowerCase()),g=(i.tag_ids||[]).map(x=>x.toLowerCase());let v=0;for(const x of p){l.has(x)&&(v+=5);for(const d of l)(x.includes(d)||d.includes(x))&&(v+=2)}for(const x of g){l.has(x)&&(v+=5);const d=x.split(".");for(const m of d)l.has(m)&&(v+=3)}if(v>0){const x=o.channels?.[i.channelKey];r.push({id:i.id,title:i.title,url:i.url,channelName:x?.name||"Unreal Engine",channelTrust:"official",tier:i.tier,durationMinutes:i.durationMinutes,topics:i.topics,tag_ids:i.tag_ids||[],description:i.description||"",keyTakeaways:i.keyTakeaways||[],chapters:i.chapters||[],source:"epic_youtube",_score:v})}}const h=/\b(ue\s*5|unreal\s*engine\s*5|5\.\d)/i;for(const i of r)i._isUE5=h.test(i.title)||(i.topics||[]).some(a=>h.test(a));return r.sort((i,a)=>i._isUE5!==a._isUE5?i._isUE5?-1:1:a._score!==i._score?a._score-i._score:(ye[i.tier]??1)-(ye[a.tier]??1)),r.slice(0,n).map(({_score:i,_isUE5:a,...p})=>p)}async function en(t,{limit:s=5}={}){if(!t?.length)return[];const n=await xt();if(!n?.resources?.length)return[];const o=new Set(t.map(l=>l.toLowerCase())),c=[];for(const l of n.resources){const r=(l.tag_ids||[]).map(i=>i.toLowerCase());let h=0;for(const i of r)o.has(i)&&(h+=5);if(h>0){const i=n.channels?.[l.channelKey];c.push({id:l.id,title:l.title,url:l.url,channelName:i?.name||"Unreal Engine",channelTrust:"official",tier:l.tier,durationMinutes:l.durationMinutes,topics:l.topics,tag_ids:l.tag_ids||[],description:l.description||"",keyTakeaways:l.keyTakeaways||[],chapters:l.chapters||[],source:"epic_youtube",_score:h})}}return c.sort((l,r)=>r._score-l._score),c.slice(0,s).map(({_score:l,...r})=>r)}async function tn(t,s=[]){if(!t?.length)return{topics:[],firstPartyVideos:0,docsArticles:0,youtubeResources:0,coverageScore:0,gaps:[]};const n=await ft(t,{limit:10}),o=await yt(t,{limit:10}),c={};for(const i of t){const a=i.toLowerCase(),p=s.filter(d=>{const m=(d.tags||[]).map(j=>j.toLowerCase()),N=(d.title||"").toLowerCase();return m.some(j=>j.includes(a))||N.includes(a)}).length,g=n.filter(d=>d.key?.toLowerCase().includes(a)||d.subsystem?.toLowerCase()===a||d.label?.toLowerCase().includes(a)).length,v=o.filter(d=>{const m=(d.topics||[]).some(j=>j.toLowerCase().includes(a)),N=(d.tag_ids||[]).some(j=>j.toLowerCase().includes(a));return m||N}).length,x=p+g+v;c[i]={firstPartyVideos:p,docsArticles:g,youtubeResources:v,total:x,covered:x>0}}const l=Object.values(c).filter(i=>i.covered).length,r=t.length>0?l/t.length:0,h=Object.entries(c).filter(([,i])=>!i.covered).map(([i])=>i);return{topics:t,topicCoverage:c,firstPartyVideos:s.length,docsArticles:n.length,youtubeResources:o.length,coverageScore:r,gaps:h}}async function sn(t,s=[],{maxDocs:n=5,maxYoutube:o=3}={}){if(!t?.length)return{docs:[],youtube:[],totalTimeMinutes:0,coverageScore:0};const c=await Hs(t,{limit:n}),l=await yt(t,{limit:o}),r=await en(t,{limit:o}),h=new Set(l.map(x=>x.id)),i=[...l];for(const x of r)h.has(x.id)||(i.push(x),h.add(x.id));const a=s.reduce((x,d)=>x+(d.durationMinutes||10),0),p=c.reduce((x,d)=>x+(d.readTimeMinutes||10),0),g=i.reduce((x,d)=>x+(d.durationMinutes||15),0),v=await tn(t,s);return{docs:c,youtube:i,totalTimeMinutes:a+p+g,coverageScore:v.coverageScore,gaps:v.gaps,externalEnabled:!0}}const Fe={QUERY_SUBMITTED:"query_submitted",DIAGNOSIS_GENERATED:"diagnosis_generated",LEARNING_PATH_GENERATED:"learning_path_generated"};let Me=null;function nn(){return Me||(Me=`session_${Date.now()}_${Math.random().toString(36).substring(2,9)}`),Me}async function Ue(t,s={}){try{const n=et(),o={event:t,session_id:nn(),...s,timestamp:wt(),client_timestamp:new Date().toISOString()};await St(Ct(n,"analytics_events"),o)}catch(n){J("[Analytics] Failed to track event:",t,n.message)}}function rn(t,s=[],n=null){return Ue(Fe.QUERY_SUBMITTED,{query_length:t?.length||0,query_preview:t?.substring(0,100),detected_tag_count:s.length,detected_tags:s.slice(0,5),persona_id:n})}function an(t){return Ue(Fe.DIAGNOSIS_GENERATED,{diagnosis_id:t?.diagnosis_id,root_causes_count:t?.root_causes?.length||0,signals_count:t?.signals_to_watch_for?.length||0,generalization_scope:t?.generalization_scope?.slice(0,3)})}function on(t,s,n=!0){return Ue(Fe.LEARNING_PATH_GENERATED,{fix_specific_count:t?.fix_specific?.length||0,transferable_count:t?.transferable?.length||0,course_count:s?.length||0,passed_validation:n})}const K={INPUT:"input",LOADING:"loading",DIAGNOSIS:"diagnosis",GUIDED:"guided",ERROR:"error"};function Nn(){const[t,s]=_.useState(K.INPUT),[n,o]=_.useState(null),[c,l]=_.useState(null),[r,h]=_.useState(null),[i,a]=_.useState([]),{cart:p,addToCart:g,removeFromCart:v,clearCart:x,isInCart:d}=Es(),m=Nt(),N=_.useMemo(()=>m?.courses||[],[m?.courses]),j=_.useCallback(()=>{try{const u=localStorage.getItem("detected_persona");return u?JSON.parse(u):null}catch{return null}},[]),k=_.useCallback(async u=>{x(),s(K.LOADING),l(null),u.pastedImage&&Y("[ProblemFirst] Screenshot attached (base64 length):",u.pastedImage.length),u.errorLog&&Y("[ProblemFirst] Error log attached:",u.errorLog.slice(0,200));try{if(u.cachedCartId){Y(`[Cache] Checking Firestore for cart: ${u.cachedCartId}`);try{const y=Ge(),T=et(y),$=kt(T,"adaptive_carts",u.cachedCartId),z=await Tt($);if(z.exists()){const D=z.data(),A=D.cached_at?.toDate?.()||new Date(D.created_at||0),R=Date.now()-A.getTime(),E=1440*60*1e3;if(R<E){Y(`[Cache Hit] Cart is ${Math.round(R/6e4)}min old â€” using cached result`);const W={...D,userQuery:u.query,retrievedPassages:[]},re=await Be(W,N,u.selectedTagIds||[],u.errorLog||"",[]);W.matchedCourses=re;const Z=[...W.diagnosis?.matched_tag_ids||[],...u.detectedTagIds||[],...u.selectedTagIds||[]],Ve=Xe(re,Z,{preferTroubleshooting:!0,diversity:!0}),ae={};for(const me of Ve.path)ae[me.course.code]={role:me.role,reason:me.reason,estimatedMinutes:me.estimatedMinutes};const de=await Ke(re,u.query,ae);if(de.length>0){a(de),o(W),s(K.DIAGNOSIS),Y(`[Cache] Loaded ${de.length} videos from cached cart â€” 0 Gemini calls`);return}J("[Cache] Cached cart produced 0 videos â€” falling through to fresh diagnosis")}else Y(`[Cache Expired] Cart is ${Math.round(R/36e5)}h old â€” refreshing`)}else Y(`[Cache Miss] Cart ${u.cachedCartId} not found in Firestore`)}catch(y){J("[Cache Error] Falling through to fresh diagnosis:",y.message)}}await rn(u.query,u.detectedTagIds,j()?.id);const S=Ge(),C=It(S,"us-central1");let b=null,w=[],I=[];try{const T=await We(C,"embedQuery")({query:u.query});if(T.data?.success&&T.data?.embedding){b=T.data.embedding;const[$,z,D]=await Promise.allSettled([Ms(b,8,.35),Os(b,6,.35),Ks(b,6,.35)]);if($.status==="fulfilled"?w=$.value:J("âš ï¸ Course semantic search failed:",$.reason?.message),z.status==="fulfilled"){const A=z.value.map(R=>({text:R.previewText,courseCode:R.courseCode,videoTitle:R.videoTitle,timestamp:R.timestamp,similarity:R.similarity,source:"transcript"}));I.push(...A),Y(`[RAG] ${A.length} transcript passages`)}else J("âš ï¸ Segment search failed:",z.reason?.message);if(D.status==="fulfilled"){const A=D.value.map(R=>({text:R.previewText,url:R.url,title:R.title,section:R.section,similarity:R.similarity,source:"epic_docs"}));I.push(...A),Y(`[RAG] ${A.length} doc passages`)}else J("âš ï¸ Docs search failed:",D.reason?.message);Y(`[RAG] Total: ${I.length} passages retrieved (parallel)`)}}catch(y){J("âš ï¸ Semantic search skipped:",y.message)}let M,O=!0;try{const T=await We(C,"queryLearningPath")({query:u.query,mode:"problem-first",detectedTagIds:u.detectedTagIds,personaHint:u.personaHint,retrievedContext:I.slice(0,5)});if(!T.data.success)throw new Error(T.data.message||"Failed to process query");M=T.data.cart}catch(y){const T=y.message?.includes("429")||y.code==="resource-exhausted";J(`âš ï¸ Gemini ${T?"rate limited (429)":"error"}: ${y.message}. Falling back to local matching.`),O=!1,M={diagnosis:{problem_summary:u.query,matched_tag_ids:u.detectedTagIds||[]},objectives:[],intent:{systems:[]}}}M.userQuery=u.query,M.retrievedPassages=I,M._localFallback=!O;const F=await Be(M,N,u.selectedTagIds||[],u.errorLog||"",w);M.matchedCourses=F;const H=[...M.diagnosis?.matched_tag_ids||[],...u.detectedTagIds||[],...u.selectedTagIds||[]],B=Xe(F,H,{preferTroubleshooting:!0,diversity:!0}),Q={};for(const y of B.path)Q[y.course.code]={role:y.role,reason:y.reason,estimatedMinutes:y.estimatedMinutes};const G=await Ke(F,u.query,Q),le=G.filter(y=>!y.type||y.type==="video"),ne=G.filter(y=>y.type==="doc"||y.type==="youtube");if(G.length===0){l(`We couldn't find UE5 content matching your query. Try describing a specific Unreal Engine problem, for example:
â€¢ "Blueprint compile error LNK2019"
â€¢ "Lumen reflections flickering in indoor scene"
â€¢ "Niagara particle system not spawning"
â€¢ "UMG widget not rendering"`),s(K.ERROR);return}a(le),o(M);try{const T=[...M.diagnosis?.matched_tag_ids||[],...u.detectedTagIds||[]].flatMap(D=>D.split(/[._]/).filter(A=>A.length>2&&A!=="unreal"&&A!=="engine")),$=(u.query||"").toLowerCase().split(/\s+/).filter(D=>D.length>3),z=[...new Set([...T,...$])].slice(0,12);if(z.length>0){const D=await sn(z,le,{maxDocs:5,maxYoutube:3});if(ne.length>0)for(const A of ne)A.type==="doc"&&!D.docs.some(R=>R.url===A._externalUrl)&&D.docs.push({label:A.title,url:A._externalUrl||A.url,description:A.description||"",readTimeMinutes:A.readTimeMinutes||10,tier:"intermediate"}),A.type==="youtube"&&!D.youtube.some(R=>R.url===A._externalUrl)&&D.youtube.push({title:A.title,url:A._externalUrl||A.url,channelName:A.channel||"YouTube",channelTrust:A.channelTrust||null,durationMinutes:A.durationMinutes||10,tier:"intermediate"});h(D),Y(`[Blended] ${D.docs.length} docs, ${D.youtube.length} YT, coverage: ${(D.coverageScore*100).toFixed(0)}%`)}}catch(y){J("âš ï¸ Blended path skipped:",y.message)}s(K.DIAGNOSIS),u.updateCartIdForQuery&&M.cart_id&&(u.updateCartIdForQuery(u.query,M.cart_id),Y(`[Cache] Saved cart_id ${M.cart_id} to history for: "${u.query.substring(0,40)}..."`)),await an(M.diagnosis),await on(M.objectives,F,M.validation?.approved)}catch(S){console.error("[ProblemFirst] Error:",S),l(S.message||"An unexpected error occurred"),s(K.ERROR)}},[N,j,x]),L=_.useCallback(()=>s(K.INPUT),[]),q=_.useCallback(()=>{s(K.INPUT),o(null),a([]),l(null),h(null)},[]),V=_.useCallback(u=>{d(u.driveId)?v(u.driveId):g(u)},[d,g,v]),P=_.useCallback(()=>{p.length>0&&s(K.GUIDED)},[p]);return e.jsxs("div",{className:"problem-first-page",children:[e.jsxs("header",{className:"page-header",children:[e.jsx("h1",{children:"ðŸ”§ Fix a Problem"}),e.jsx("p",{children:"Describe your issue. We'll find the right videos to help you solve it."})]}),(t===K.INPUT||t===K.LOADING)&&e.jsx(Ae,{onSubmit:k,detectedPersona:j(),isLoading:t===K.LOADING}),t===K.ERROR&&e.jsxs("div",{className:"error-state",children:[e.jsx("div",{className:"error-icon",children:"âš ï¸"}),e.jsx("h3",{children:"Something went wrong"}),e.jsx("p",{children:c}),e.jsx("button",{className:"retry-btn",onClick:q,children:"Try Again"})]}),t===K.DIAGNOSIS&&n&&e.jsxs("div",{className:"shopping-layout",children:[e.jsxs("div",{className:"results-column",children:[e.jsxs("div",{className:"tldr-diagnosis",children:[e.jsxs("div",{className:"tldr-user-query",children:[e.jsx("span",{className:"tldr-query-label",children:"ðŸ” You asked:"}),e.jsx("p",{className:"tldr-query-text",children:n.userQuery})]}),n._localFallback&&e.jsxs("div",{className:"tldr-fallback-notice",style:{background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"8px",padding:"8px 14px",margin:"8px 0",fontSize:"0.85rem",color:"var(--text-muted, #aaa)"},children:["âš¡ ",e.jsx("strong",{children:"Fast results"})," â€” AI diagnosis unavailable (rate limit). Videos matched by tag taxonomy."]}),n.diagnosis?.problem_summary&&e.jsx("p",{className:"tldr-bridge",children:"Based on your question, we think these videos will help you:"})]}),e.jsxs("h2",{className:"results-title",children:["ðŸŽ¬ Videos for You (",i.length,")"]}),i.length===0&&e.jsx("div",{className:"no-results",children:e.jsx("p",{children:"No matching videos found. Try rephrasing your question."})}),(()=>{const u=[{key:"prerequisite",icon:"ðŸ”—",label:"Prerequisite",desc:"Build the foundation first â€” these cover concepts you'll need before tackling the main topic."},{key:"core",icon:"â­",label:"Core",desc:"These directly address your question and are the most important videos to watch."},{key:"troubleshooting",icon:"ðŸ”§",label:"Troubleshooting",desc:"Debugging helpers â€” watch these if you're hitting errors or unexpected behavior."},{key:"supplemental",icon:"ðŸ“š",label:"Supplemental",desc:"Go deeper â€” extra context and advanced techniques for when you're ready."}],S={};for(const C of u)S[C.key]=[];S._other=[];for(const C of i){const b=C.role||"_other";(S[b]||S._other).push(C)}return u.filter(C=>S[C.key].length>0).map(C=>e.jsxs("div",{className:"role-section",children:[e.jsxs("div",{className:"role-section-header",children:[e.jsxs("h3",{className:"role-section-title",children:[C.icon," ",C.label,e.jsx("span",{className:"role-section-count",children:S[C.key].length})]}),e.jsx("p",{className:"role-section-desc",children:C.desc})]}),e.jsx("div",{className:"video-results-grid",children:S[C.key].map(b=>e.jsx("div",{className:"video-result-wrapper",id:`video-${b.driveId}`,children:e.jsx(Pe,{video:b,isAdded:d(b.driveId),onToggle:V,userQuery:n?.userQuery||""})},b.driveId))})]},C.key)).concat(S._other.length>0?[e.jsxs("div",{className:"role-section",children:[e.jsxs("div",{className:"role-section-header",children:[e.jsxs("h3",{className:"role-section-title",children:["ðŸ“Ž Related"," ",e.jsx("span",{className:"role-section-count",children:S._other.length})]}),e.jsx("p",{className:"role-section-desc",children:"Additional videos that may be relevant to your query."})]}),e.jsx("div",{className:"video-results-grid",children:S._other.map(C=>e.jsx("div",{className:"video-result-wrapper",id:`video-${C.driveId}`,children:e.jsx(Pe,{video:C,isAdded:d(C.driveId),onToggle:V,userQuery:n?.userQuery||""})},C.driveId))})]},"_other")]:[])})(),r?.docs?.length>0&&e.jsxs("div",{className:"blended-section",children:[e.jsxs("div",{className:"blended-section-header",children:[e.jsx("h2",{className:"blended-section-title",children:"ðŸ“š Recommended Reading"}),e.jsxs("p",{className:"blended-section-desc",children:["Official Unreal Engine documentation to deepen your understanding.",r.docs.reduce((u,S)=>u+(S.readTimeMinutes||10),0)>0&&` (~${r.docs.reduce((u,S)=>u+(S.readTimeMinutes||10),0)} min total read time)`]})]}),e.jsx("div",{className:"doc-cards-grid",children:r.docs.map((u,S)=>{const C=`doc_${u.key||S}`,b=d(C);return e.jsxs("div",{className:`doc-card ${b?"doc-card-added":""}`,children:[e.jsxs("a",{href:u.url,target:"_blank",rel:"noopener noreferrer",className:"doc-card-link",onClick:w=>w.stopPropagation(),children:[e.jsxs("div",{className:"doc-card-header",children:[u.matchScore!=null&&(()=>{const w=u.matchScore>=90?"best":u.matchScore>=60?"strong":u.matchScore>=30?"good":"related",I=u.matchScore>=90?"Best Match":u.matchScore>=60?"Strong":u.matchScore>=30?"Good":"Related";return e.jsxs("span",{className:`doc-match-badge doc-match-${w}`,title:`${u.matchScore}% relevancy`,children:[e.jsx("span",{className:"doc-match-dot"}),I]})})(),e.jsx("span",{className:`tier-badge tier-${u.tier||"intermediate"}`,children:u.tier||"intermediate"}),u.subsystem&&e.jsx("span",{className:"subsystem-tag",children:u.subsystem})]}),e.jsx("h4",{className:"doc-card-title",children:u.label}),u.description&&e.jsx("p",{className:"doc-card-desc",children:u.description}),e.jsxs("div",{className:"doc-card-footer",children:[e.jsx("span",{className:"doc-source-badge",children:"ðŸ“„ Epic Docs"}),e.jsxs("span",{className:"doc-read-time",children:[u.readTimeMinutes||10," min read"]})]})]}),e.jsx("button",{className:`doc-add-btn ${b?"doc-added":""}`,onClick:()=>{b?v(C):g({type:"doc",itemId:C,title:u.label,description:u.description||"",keySteps:u.keySteps||[],seeAlso:u.seeAlso||[],sections:u.sections||[],url:u.url,tier:u.tier||"intermediate",subsystem:u.subsystem,readTimeMinutes:u.readTimeMinutes||10})},title:b?"Remove from path":"Add to learning path",children:b?"âœ“ Added":"âž• Add"})]},u.key||S)})})]}),r?.youtube?.length>0&&e.jsxs("div",{className:"blended-section",children:[e.jsxs("div",{className:"blended-section-header",children:[e.jsx("h2",{className:"blended-section-title",children:"ðŸ“º Official Epic YouTube"}),e.jsx("p",{className:"blended-section-desc",children:"Official Unreal Engine tutorials from Epic Games."})]}),e.jsx("div",{className:"doc-cards-grid",children:r.youtube.map(u=>{const S=u.id||`yt_${u.url}`,C=d(S);return e.jsxs("div",{className:`doc-card yt-card-with-thumb ${C?"doc-card-added":""}`,children:[e.jsxs("a",{href:u.url,target:"_blank",rel:"noopener noreferrer",className:"doc-card-link",onClick:b=>b.stopPropagation(),children:[(()=>{const b=u.url?.match(/[?&]v=([^&]+)/),w=b?b[1]:null;return w?e.jsxs("div",{className:"yt-thumb-wrapper",children:[e.jsx("img",{className:"yt-thumb-img",src:`https://img.youtube.com/vi/${w}/mqdefault.jpg`,alt:u.title,loading:"lazy"}),e.jsxs("span",{className:"yt-thumb-duration",children:[u.durationMinutes," min"]}),e.jsx("span",{className:"yt-thumb-play",children:"â–¶"})]}):null})(),e.jsxs("div",{className:"doc-card-header",children:[e.jsx("span",{className:`tier-badge tier-${u.tier||"intermediate"}`,children:u.tier||"intermediate"}),e.jsx("span",{className:"external-badge",children:"Official â€¢ YouTube"})]}),e.jsx("h4",{className:"doc-card-title",children:u.title}),e.jsxs("div",{className:"doc-card-footer",children:[e.jsxs("span",{className:"doc-source-badge",children:["ðŸ“º ",u.channelName]}),e.jsxs("span",{className:"doc-read-time",children:[u.durationMinutes," min"]})]})]}),e.jsx("button",{className:`doc-add-btn ${C?"doc-added":""}`,onClick:()=>{C?v(S):g({type:"youtube",itemId:S,title:u.title,description:u.description||"",keyTakeaways:u.keyTakeaways||[],chapters:u.chapters||[],topics:u.topics||[],url:u.url,channelName:u.channelName,channelTrust:u.channelTrust,tier:u.tier||"intermediate",durationMinutes:u.durationMinutes||15})},title:C?"Remove from path":"Add to learning path",children:C?"âœ“ Added":"âž• Add"})]},u.id)})})]}),e.jsxs("div",{className:"results-actions-bottom",children:[e.jsx("button",{className:"back-btn",onClick:q,children:"â† Start Over"}),e.jsx("button",{className:"ask-again-btn",onClick:L,children:"+ Ask Another Question"})]})]}),e.jsx("div",{className:"cart-column",children:e.jsx(mt,{cart:p,onRemove:v,onClear:x,onWatchPath:P})})]}),t===K.GUIDED&&e.jsx(De,{courses:p.map(u=>{const S=u.type||"video";if(S==="doc"||S==="youtube")return{code:u.itemId||u.driveId||`${S}_${u.url}`,title:u.title,_readingStep:!0,_resourceType:S,_description:u.description||"",_keySteps:u.keyTakeaways||u.keySteps||[],_seeAlso:u.seeAlso||[],_url:u.url,_tier:u.tier,_channel:u.channel||u.channelName,_channelTrust:u.channelTrust,_subsystem:u.subsystem,_topics:u.topics||[],_sections:u.sections||[],_chapters:u.chapters||[],_readTimeMinutes:u.readTimeMinutes||u.durationMinutes||10,videos:[]};const C=N.find(b=>b.code===u.courseCode);return C?{...C,videos:[{drive_id:u.driveId,title:u.title,duration_seconds:u.duration}]}:{code:u.courseCode,title:u.courseName,videos:[{drive_id:u.driveId,title:u.title,duration_seconds:u.duration}]}}),diagnosis:n?.diagnosis,problemSummary:n?.diagnosis?.problem_summary,pathSummary:n?.pathSummary,microLesson:n?.microLesson,onComplete:()=>{},onExit:()=>s(K.DIAGNOSIS)})]})}function vt({diagnosis:t}){if(!t)return null;const s=t.root_causes?.length||0,n=t.signals_to_watch_for?.length||0,o=t.variables_that_matter?.length||0,c=t.variables_that_do_not?.length||0;return e.jsxs("div",{className:"diagnosis-card",children:[e.jsxs("div",{className:"diagnosis-header",children:[e.jsx("h3",{children:"ðŸ”¬ Diagnosis"}),e.jsxs("span",{className:"diagnosis-id",children:["ID: ",t.diagnosis_id?.slice(-8)||"N/A"]})]}),e.jsx("p",{className:"problem-summary",children:t.problem_summary}),e.jsxs("div",{className:"diagnosis-sections",children:[e.jsxs("details",{className:"diagnosis-section root-causes",children:[e.jsxs("summary",{children:[e.jsx("span",{className:"icon",children:"ðŸŽ¯"}),"Root Causes",e.jsxs("span",{className:"count",children:["(",s,")"]})]}),e.jsx("ul",{children:(t.root_causes||[]).map((l,r)=>e.jsx("li",{children:l},r))})]}),e.jsxs("details",{className:"diagnosis-section signals",children:[e.jsxs("summary",{children:[e.jsx("span",{className:"icon",children:"ðŸ‘ï¸"}),"Signals to Watch For",e.jsxs("span",{className:"count",children:["(",n,")"]})]}),e.jsx("ul",{children:(t.signals_to_watch_for||[]).map((l,r)=>e.jsx("li",{children:l},r))})]}),e.jsxs("details",{className:"diagnosis-section variables-matter",children:[e.jsxs("summary",{children:[e.jsx("span",{className:"icon",children:"âœ…"}),"Variables That Matter",e.jsxs("span",{className:"count",children:["(",o,")"]})]}),e.jsx("ul",{children:(t.variables_that_matter||[]).map((l,r)=>e.jsx("li",{children:l},r))})]}),e.jsxs("details",{className:"diagnosis-section variables-dont-matter",children:[e.jsxs("summary",{children:[e.jsx("span",{className:"icon",children:"âŒ"}),"Variables That Don't",e.jsxs("span",{className:"count",children:["(",c,")"]})]}),e.jsx("ul",{children:(t.variables_that_do_not||[]).map((l,r)=>e.jsx("li",{children:l},r))})]}),t.generalization_scope?.length>0&&e.jsxs("details",{className:"diagnosis-section generalization",open:!0,children:[e.jsxs("summary",{children:[e.jsx("span",{className:"icon",children:"ðŸ”„"}),"Where Else This Applies",e.jsxs("span",{className:"count",children:["(",t.generalization_scope.length,")"]})]}),e.jsx("div",{className:"scope-chips",children:t.generalization_scope.map((l,r)=>e.jsx("span",{className:"scope-chip",children:l},r))})]})]})]})}vt.propTypes={diagnosis:f.shape({diagnosis_id:f.string,problem_summary:f.string,root_causes:f.arrayOf(f.string),signals_to_watch_for:f.arrayOf(f.string),variables_that_matter:f.arrayOf(f.string),variables_that_do_not:f.arrayOf(f.string),generalization_scope:f.arrayOf(f.string)})};vt.defaultProps={diagnosis:null};function cn(t){if(!t||t<=0)return null;const s=Math.floor(t/3600),n=Math.floor(t%3600/60);return s>0?n>0?`${s} hr ${n} min`:`${s} hr`:`${n} min`}function ln(t,s=320){const n=t?.drive_id||t?.driveId;return n?`https://drive.google.com/thumbnail?id=${n}&sz=w${s}`:null}function dn(t,s=320){const n=t?.videos?.[0];return ln(n,s)}function bt({objectives:t,courses:s,validation:n,onCourseClick:o,onAddToCart:c,isCourseInCart:l}){const{fixCourses:r,learnCourses:h}=_.useMemo(()=>{if(!s||s.length===0)return{fixCourses:[],learnCourses:[]};const a=Math.ceil(s.length/2);return{fixCourses:s.slice(0,a),learnCourses:s.slice(a)}},[s]),i=_.useMemo(()=>n?{approved:n.approved,reason:n.reason,hasIssues:n.issues?.length>0}:null,[n]);return e.jsxs("div",{className:"adaptive-cart",children:[i&&!i.approved&&e.jsxs("div",{className:"validation-warning",children:[e.jsx("span",{className:"icon",children:"âš ï¸"}),e.jsxs("div",{className:"content",children:[e.jsx("strong",{children:"Quality Check:"})," ",i.reason,n.suggestions?.length>0&&e.jsx("ul",{className:"suggestions",children:n.suggestions.map((a,p)=>e.jsx("li",{children:a},p))})]})]}),e.jsxs("section",{className:"cart-section fix-now",children:[e.jsxs("div",{className:"section-header",children:[e.jsxs("h3",{children:[e.jsx("span",{className:"icon",children:"ðŸ”§"}),"Fix Now"]}),e.jsx("p",{className:"description",children:"These solve your immediate problem:"})]}),e.jsx("div",{className:"objectives-list",children:(t?.fix_specific||[]).map((a,p)=>e.jsxs("div",{className:"objective-item fix",children:[e.jsx("span",{className:"number",children:p+1}),e.jsx("span",{className:"text",children:a})]},p))}),r.length>0&&e.jsx("div",{className:"course-list",children:r.map(a=>e.jsx(ve,{course:a,type:"fix",onClick:()=>o?.(a),onAddToCart:c,isInCart:l?.(a)},a.id||a.code))})]}),e.jsxs("section",{className:"cart-section learn-forever",children:[e.jsxs("div",{className:"section-header",children:[e.jsxs("h3",{children:[e.jsx("span",{className:"icon",children:"ðŸŽ“"}),"Learn Forever"]}),e.jsx("p",{className:"description",children:"These help you diagnose similar issues in the future:"})]}),e.jsx("div",{className:"objectives-list transferable",children:(t?.transferable||[]).map((a,p)=>e.jsxs("div",{className:"objective-item transferable",children:[e.jsx("span",{className:"number",children:p+1}),e.jsx("span",{className:"text",children:a}),e.jsx("span",{className:"badge",children:"Transferable"})]},p))}),t?.transferable?.length===0&&e.jsx("div",{className:"empty-warning",children:"âš ï¸ No transferable objectives generated. This path may not teach reusable skills."}),h.length>0&&e.jsx("div",{className:"course-list",children:h.map(a=>e.jsx(ve,{course:a,type:"learn",onClick:()=>o?.(a),onAddToCart:c,isInCart:l?.(a)},a.id||a.code))})]}),e.jsxs("div",{className:"cart-summary",children:[e.jsxs("div",{className:"stat",children:[e.jsx("span",{className:"value",children:t?.fix_specific?.length||0}),e.jsx("span",{className:"label",children:"Fix Objectives"})]}),e.jsxs("div",{className:"stat highlight",children:[e.jsx("span",{className:"value",children:t?.transferable?.length||0}),e.jsx("span",{className:"label",children:"Transferable Skills"})]}),e.jsxs("div",{className:"stat",children:[e.jsx("span",{className:"value",children:s?.length||0}),e.jsx("span",{className:"label",children:"Recommended Courses"})]})]})]})}function ve({course:t,type:s,onClick:n,onAddToCart:o,isInCart:c}){const[l,r]=_.useState(!1),h=_.useMemo(()=>{if(t.duration)return t.duration;if(t.duration_minutes)return`${t.duration_minutes} min`;if(t.durationMinutes)return`${t.durationMinutes} min`;if(t.videos?.length){const v=t.videos.reduce((x,d)=>x+(d.duration_seconds||0),0);return v>0?cn(v):null}return null},[t]),i=_.useMemo(()=>typeof t.difficulty=="string"?t.difficulty:typeof t.difficulty=="number"?["Beginner","Beginner","Intermediate","Intermediate","Advanced","Expert"][t.difficulty]||"Intermediate":t.gemini_skill_level?t.gemini_skill_level:null,[t]),a=_.useMemo(()=>dn(t),[t]),p=t.video_count||t.videos?.length||null,g=v=>{v.stopPropagation(),o?.(t)};return e.jsxs("div",{className:`course-card ${s} ${c?"in-cart":""}`,onClick:n,role:"button",tabIndex:0,onKeyDown:v=>v.key==="Enter"&&n?.(),children:[a&&!l&&e.jsx("div",{className:"course-thumbnail",children:e.jsx("img",{src:a,alt:t.title,loading:"lazy",onError:()=>r(!0)})}),e.jsxs("div",{className:"course-info",children:[e.jsx("h4",{className:"title",children:t.title||t.name}),t.gemini_outcomes?.[0]&&e.jsxs("p",{className:"description",children:[t.gemini_outcomes[0].slice(0,100),"..."]}),e.jsxs("div",{className:"meta",children:[h&&e.jsxs("span",{className:"duration",children:["â±ï¸ ",h]}),p&&e.jsxs("span",{className:"video-count",children:["ðŸŽ¬ ",p," videos"]}),i&&e.jsx("span",{className:`difficulty ${i.toLowerCase()}`,children:i})]})]}),e.jsx("div",{className:"course-action",children:o?e.jsx("button",{className:`add-btn ${c?"added":""}`,onClick:g,"aria-label":c?"Added to path":"Add to path",children:c?"âœ“ Added":"+ Add"}):e.jsx("span",{className:"arrow",children:"â†’"})})]})}ve.propTypes={course:f.shape({id:f.string,code:f.string,title:f.string,name:f.string,description:f.string,duration:f.string,durationMinutes:f.number,difficulty:f.string}).isRequired,type:f.oneOf(["fix","learn"]),onClick:f.func};ve.defaultProps={type:"fix",onClick:null};bt.propTypes={objectives:f.shape({fix_specific:f.arrayOf(f.string),transferable:f.arrayOf(f.string)}),courses:f.arrayOf(f.object),validation:f.shape({approved:f.bool,reason:f.string,issues:f.arrayOf(f.string),suggestions:f.arrayOf(f.string)}),onCourseClick:f.func};bt.defaultProps={objectives:null,courses:[],validation:null,onCourseClick:null};export{bt as AdaptiveLearningCart,vt as DiagnosisCard,Nn as ProblemFirst,Ae as ProblemInput};
