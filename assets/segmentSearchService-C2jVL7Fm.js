import{o as $e,s as Le,j as e,_ as A}from"./index-DGsCexDb.js";import{a as y,P as j}from"./vendor-cytoscape-hdah7_Xt.js";import{d as P,q as X,b as Ie,f as Ee,g as Re}from"./data-courses-Y_tFOtPD.js";import{a as ee,L as Ae,d as qe}from"./logger-CDyjTpW_.js";import{logVideoFeedback as B}from"./feedbackService-Dbtd3wH9.js";import{c as q}from"./createLucideIcon-YhyuTmrv.js";import{C as H}from"./check-eCXpKYRG.js";import{X as Pe}from"./x-HbUnH9yy.js";const De=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],O=q("arrow-right",De);const Oe=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],ze=q("book-open",Oe);const Me=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],Ve=q("flask-conical",Me);const Fe=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Ge=q("star",Fe);const Ye=[["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}],["path",{d:"M7 10v12",key:"1qc93n"}]],We=q("thumbs-up",Ye);function Ue({problemSummary:s,courses:t,diagnosis:n}){if(!t||t.length===0)return{title:"Your Learning Path",intro:"Let's solve your problem step by step.",instructors:[],totalDuration:null};const o=Ke(t),r=Be(t),l=Xe({instructors:o,courseCount:t.length,totalDuration:r,rootCauses:n?.root_causes||[],courses:t});return{title:`Your Path: ${Je(s)}`,intro:l,instructors:o,totalDuration:r,courseCount:t.length,rootCauses:n?.root_causes||[]}}function Ze(s,t,n){if(!t)return{type:"completion",text:"üéâ Congratulations! You've completed your learning path.",subtext:"You now have the skills to solve this problem and similar ones in the future."};const o=U(s),r=U(t),l=t.title||t.name||"the next lesson";return o&&r&&o!==r?{type:"transition",text:`Now let's hear from ${r}`,subtext:`${r} will cover: ${n||l}`,instructor:r}:{type:"continuation",text:`Next up: ${l}`,subtext:n||null,instructor:r}}function Ke(s){const t=new Set,n=[];return s.forEach(o=>{const r=U(o);if(r&&!t.has(r))t.add(r),n.push({name:r,courses:[o.title||o.name],totalDuration:Z(o)});else if(r){const l=n.find(a=>a.name===r);l&&(l.courses.push(o.title||o.name),l.totalDuration+=Z(o))}}),n}function U(s){return s&&(s.instructor||s.author||s.creator||s.teacher||Qe(s.title||s.name))||null}function Qe(s){if(!s)return null;const t=s.match(/\bby\s+([A-Z][a-zA-Z]+(?:\s+[A-Z][a-zA-Z]+)?)/i);if(t)return t[1];const n=s.match(/\bwith\s+([A-Z][a-zA-Z]+(?:\s+[A-Z][a-zA-Z]+)?)/i);return n?n[1]:null}function Be(s){const t=s.reduce((n,o)=>n+Z(o),0);return He(t)}function Z(s){if(!s)return 0;if(s.videos?.length){const t=s.videos.reduce((n,o)=>n+(o.duration_seconds||0),0);if(t>0)return t}return s.duration_seconds?s.duration_seconds:s.duration_minutes?s.duration_minutes*60:0}function He(s){if(!s||s<=0)return null;const t=Math.floor(s/3600),n=Math.floor(s%3600/60);return t>0?n>0?`${t} hr ${n} min`:`${t} hr`:`${n} min`}function Je(s){if(!s)return"Learning Path";if(s.length<=80)return s;const t=s.slice(0,80),n=t.lastIndexOf(" ");return(n>30?t.slice(0,n):t)+"‚Ä¶"}function Xe({instructors:s,courseCount:t,totalDuration:n,rootCauses:o,courses:r}){const l=[];o.length>0&&l.push(`We've identified ${o.length} root cause${o.length>1?"s":""} for your issue:`);const a=(r||[]).reduce((c,i)=>c+(i.videos?.length||0),0);if(s.length===1)l.push(`${s[0].name} will guide you through ${t} lesson${t>1?"s":""}.`);else if(s.length>1){const c=s.map(d=>d.name),i=c.pop();l.push(`You'll learn from ${c.join(", ")} and ${i}.`)}else{const c=a>0?` covering ${a} video${a>1?"s":""}`:"";l.push(`You have ${t} lesson${t>1?"s":""} to complete${c}.`)}return n&&l.push(`Total time: ${n}.`),l.join(" ")}function es(s,t){const n=Math.round((s+1)/t*100);return{text:`Video ${s+1} of ${t}`,percent:n,isComplete:s+1>=t}}function ss(s,t,n,o=0){const l=[...s?.canonical_tags||[],...s?.gemini_system_tags||[],...s?.transcript_tags||[],...s?.extracted_tags||[],...Array.isArray(s?.tags)?s.tags:[]].map(u=>typeof u=="string"?u.split(".").pop():u.name||u.display_name||"").filter(Boolean).filter((u,v,f)=>f.indexOf(u)===v),a=s?.gemini_skill_level||"Intermediate",c=(t||"").toLowerCase(),i=[],d=new Set,p=u=>{for(const v of u)d.has(v.task)||(d.add(v.task),i.push(v))};if(c){const u=Object.keys(P).sort((v,f)=>f.length-v.length);for(const v of u)c.includes(v)&&p(P[v])}const m=[...l].sort((u,v)=>{const f=c.includes(u.toLowerCase())?1:0;return(c.includes(v.toLowerCase())?1:0)-f});for(const u of m){const v=u.toLowerCase();P[v]&&p(P[v])}if(i.length>0){const u=i[o%i.length];return{task:u.task,hint:u.hint,expectedResult:u.expectedResult,docsUrl:u.docsUrl||null,difficulty:a}}const x=l[0]||(n?n.split(/\s+/).slice(0,3).join(" "):"this concept"),h=n?`"${n}"`:"this lesson",N=s?.gemini_outcomes?.[0]||"";return{task:t?`Open UE5 and apply the technique from ${h} to address "${t}". In the Details panel, identify which ${x} settings you changed and note the before/after values.`:`Open UE5, create a test Actor, and set up ${x} from scratch following the approach from ${h}. Document which panels and properties you used.`,hint:N?`Focus on: ${N}. Check Details panel and World Settings for relevant options.`:`Look for ${x} options in the Details panel, Modes panel, or Project Settings ‚Üí Engine.`,expectedResult:t?`Your original issue ("${t}") should be resolved or visibly improved in the viewport. Compare before/after values in the Details panel to confirm the change took effect.`:`You should see ${x} applied correctly in the viewport or preview. The Details panel should reflect the new settings, and the editor should show no warnings related to your changes.`,difficulty:a}}const se="ue5_learning_progress";function te(){try{const s=localStorage.getItem(se);return s?{...z(),...JSON.parse(s)}:z()}catch{return z()}}function z(){return{completedPaths:[],tagsEncountered:{},totalVideosWatched:0,reflections:[],streak:{lastDate:null,count:0}}}function ts(s){try{localStorage.setItem(se,JSON.stringify(s))}catch(t){ee("[LearningProgress] Failed to save:",t.message)}}function ns(s,t,n){const o=te(),r=new Date().toISOString().split("T")[0];o.completedPaths.includes(s)||o.completedPaths.push(s);for(const l of t){const a=l.extracted_tags||l.tags||[];for(const c of a){const i=typeof c=="string"?c:c.name||c.display_name;i&&(o.tagsEncountered[i]=(o.tagsEncountered[i]||0)+1)}}if(o.totalVideosWatched+=t.length,o.streak.lastDate!==r){const l=new Date;l.setDate(l.getDate()-1);const a=l.toISOString().split("T")[0];o.streak.lastDate===a?o.streak.count+=1:o.streak.count=1,o.streak.lastDate=r}return n&&n.trim().length>0&&o.reflections.push({date:r,pathId:s,text:n.trim()}),ts(o),o}function is(){const s=te(),t=new Date().toISOString().split("T")[0],n=new Date;n.setDate(n.getDate()-1);const o=n.toISOString().split("T")[0],r=s.streak.lastDate===t||s.streak.lastDate===o;return{count:r?s.streak.count:0,isActive:r}}const T={INTRO:"intro",PLAYING:"playing",QUIZ:"quiz",CHALLENGE:"challenge",BRIDGE:"bridge",COMPLETE:"complete"};function as({courses:s,diagnosis:t,problemSummary:n,pathSummary:o,onComplete:r,onExit:l}){const[a,c]=y.useState(T.INTRO),[i,d]=y.useState(0),[p,m]=y.useState(0),[x,h]=y.useState(""),N=y.useRef(0),[u,v]=y.useState(null),[f,w]=y.useState(!0);y.useEffect(()=>$e(L=>{v(L),w(!1)}),[]);const $=y.useCallback(async()=>{w(!0);const{error:C}=await Le();C&&console.error("[GuidedPlayer] Sign in failed:",C),w(!1)},[]),g=s[i]||null,b=s[i+1]||null,_=g?.videos||[],k=_[p]||_[0]||null,S=p<_.length-1,I=p>0||i>0,D=S||!!b,R=_.length,pe=y.useMemo(()=>Ue({problemSummary:n,courses:s,diagnosis:t}),[n,s,t]),me=y.useMemo(()=>is(),[]),K=y.useMemo(()=>s.reduce((C,L)=>C+(L.videos?.length||1),0),[s]),Q=y.useMemo(()=>{let C=0;for(let L=0;L<i;L++)C+=s[L]?.videos?.length||1;return C+p},[s,i,p]),ge=y.useMemo(()=>es(Q,K),[Q,K]),fe=y.useMemo(()=>{if(a!==T.BRIDGE)return null;const C=g?.gemini_outcomes?.[0]||null;return Ze(g,b,C)},[a,g,b]),xe=y.useMemo(()=>a!==T.CHALLENGE?null:ss(g,n,k?.title,i),[a,g,n,k,i]),je=y.useCallback(()=>{N.current=Date.now(),c(T.PLAYING)},[]),Ne=y.useCallback(()=>{if(g&&k&&u?.uid&&B(u.uid,g.code,k.key||k.title,"watched"),N.current=Date.now(),g?._readingStep){b?(d(C=>C+1),m(0),c(T.PLAYING)):(c(T.COMPLETE),r?.());return}if(S)m(C=>C+1);else{const C=X[g?.code];C&&Object.keys(C).length>0?c(T.QUIZ):c(T.CHALLENGE)}},[S,g,k,b,r,u]),ye=y.useCallback(()=>{if(p>0)m(C=>C-1);else if(i>0){const C=s[i-1]?.videos||[];d(L=>L-1),m(Math.max(0,C.length-1))}},[p,i,s]),ve=y.useCallback(()=>{Date.now()-N.current<3e4&&g&&k&&u?.uid&&B(u.uid,g.code,k.key||k.title,"skipped"),N.current=Date.now(),S?m(L=>L+1):b&&(d(L=>L+1),m(0))},[S,b,g,k,u]),ke=y.useCallback(()=>{d(0),m(0),c(T.PLAYING)},[]),we=y.useCallback(()=>{c(T.CHALLENGE)},[]),be=y.useCallback(()=>{b?(d(C=>C+1),m(0),c(T.PLAYING)):(c(T.COMPLETE),r?.())},[b,r]),_e=y.useCallback(()=>{d(C=>C+1),m(0),c(T.PLAYING)},[]),Ce=y.useCallback(C=>{d(C),m(0),c(T.PLAYING)},[]),Se=y.useCallback(()=>{const C=n?`path-${n.replace(/\s+/g,"-").toLowerCase().slice(0,40)}-${Date.now()}`:`path-${Date.now()}`;ns(C,s,x),l?.()},[n,s,x,l]),Te=x.trim().split(/\s+/).filter(Boolean).length;return{stage:a,currentIndex:i,videoIndex:p,reflectionText:x,setReflectionText:h,user:u,authLoading:f,currentCourse:g,nextCourse:b,currentVideos:_,currentVideo:k,hasMoreVideos:S,hasPreviousVideo:I,hasNextVideo:D,courseVideoCount:R,introContent:pe,streak:me,progress:ge,bridgeContent:fe,challengeContent:xe,pathSummary:o,wordCount:Te,courses:s,handleSignIn:$,handleStartLearning:je,handleVideoComplete:Ne,handlePreviousVideo:ye,handleNextVideo:ve,handleBackToPath:ke,handleQuizComplete:we,handleChallengeComplete:be,handleContinue:_e,handleSkipTo:Ce,handleFinish:Se,onExit:l}}function ne({challengeContent:s,onComplete:t}){return e.jsxs("div",{className:"challenge-card",children:[e.jsx("div",{className:"challenge-icon",children:"üî®"}),e.jsx("h3",{children:"Try It Yourself"}),e.jsx("div",{className:"challenge-difficulty",children:e.jsx("span",{className:`difficulty-badge ${s.difficulty.toLowerCase()}`,children:s.difficulty})}),e.jsx("p",{className:"challenge-task",children:s.task}),s.expectedResult&&e.jsxs("div",{className:"challenge-expected",children:[e.jsx("span",{className:"expected-label",children:"üëÅÔ∏è What to look for:"})," ",s.expectedResult]}),e.jsxs("div",{className:"challenge-hint",children:[e.jsx("span",{className:"hint-label",children:"üí° Hint:"})," ",s.hint]}),s.docsUrl&&e.jsx("a",{className:"docs-link",href:s.docsUrl,target:"_blank",rel:"noopener noreferrer",children:"üìñ Read the official UE5 docs ‚Üí"}),e.jsx("button",{className:"challenge-done-btn",onClick:t,children:"I tried it ‚Üí"}),e.jsx("button",{className:"challenge-skip-btn",onClick:t,children:"Skip challenge"})]})}ne.propTypes={challengeContent:j.shape({task:j.string.isRequired,hint:j.string.isRequired,expectedResult:j.string,docsUrl:j.string,difficulty:j.string.isRequired}).isRequired,onComplete:j.func.isRequired};j.shape({type:j.string.isRequired,text:j.string.isRequired,subtext:j.string}).isRequired,j.func.isRequired;function rs(s){const t=new Set;for(const n of s)(n.ai_tags||[]).forEach(o=>t.add(o)),(n._matchedKeywords||[]).forEach(o=>t.add(o));return[...t].slice(0,8)}function os(s,t){const n=[],o=new Set;if(s?.fixSteps?.length>0)for(const r of s.fixSteps){const l=typeof r=="string"?r:r.text||r.description||"";l&&!o.has(l.toLowerCase().slice(0,60))&&(o.add(l.toLowerCase().slice(0,60)),n.push(l))}if(t?.quick_fix?.steps?.length>0)for(const r of t.quick_fix.steps){const l=typeof r=="string"?r:r.text||r.action||"";l&&!o.has(l.toLowerCase().slice(0,60))&&(o.add(l.toLowerCase().slice(0,60)),n.push(l))}return n}function ie({courses:s,totalDuration:t,reflectionText:n,onReflectionChange:o,wordCount:r,onFinish:l,onBackToPath:a,problemSummary:c,fixRecipe:i,microLesson:d}){y.useEffect(()=>{if(n.trim())try{localStorage.setItem("lp_reflection_draft",JSON.stringify({text:n,timestamp:Date.now(),courseCount:s.length}))}catch{}},[n,s.length]),y.useEffect(()=>{try{const g=JSON.parse(localStorage.getItem("lp_reflection_draft")||"null");g?.text&&!n&&o(g.text)}catch{}},[]);const p=rs(s),m=s.reduce((g,b)=>g+(b.videos?.length||1),0),x=i?.mostLikelyCause||d?.why_it_works?.explanation||null,h=os(i,d),N=i?.fastChecks||[],u=d?.related_situations||[],v=x||h.length>0||N.length>0,[f,w]=y.useState(!1),$=()=>{const g=[];c&&g.push(`Problem: ${c}`),x&&g.push(`
Root Cause: ${x}`),h.length>0&&(g.push(`
Fix Steps:`),h.forEach((b,_)=>g.push(`  ${_+1}. ${b}`))),N.length>0&&(g.push(`
Quick Checks:`),N.forEach(b=>g.push(`  ‚úì ${typeof b=="string"?b:b.text||b}`))),navigator.clipboard.writeText(g.join(`
`)).then(()=>{w(!0),setTimeout(()=>w(!1),2e3)}).catch(()=>{})};return e.jsxs("div",{className:"complete-card",children:[e.jsx("div",{className:"complete-icon",children:"üéâ"}),e.jsx("h2",{children:"Path Complete!"}),c&&e.jsxs("p",{className:"complete-problem-context",children:["You explored: ",e.jsx("strong",{children:c})]}),v&&e.jsxs("div",{className:"fix-recipe-card",children:[e.jsxs("div",{className:"fix-recipe-header",children:[e.jsx("h3",{children:"üîß If You See This Again‚Ä¶"}),e.jsx("button",{className:"copy-recipe-btn",onClick:$,title:"Copy fix recipe to clipboard",children:f?"‚úì Copied!":"üìã Copy"})]}),x&&e.jsxs("div",{className:"fix-recipe-cause",children:[e.jsx("span",{className:"fix-recipe-cause-label",children:"üéØ Root Cause"}),e.jsx("p",{children:x})]}),h.length>0&&e.jsxs("div",{className:"fix-recipe-steps",children:[e.jsx("span",{className:"fix-recipe-section-label",children:"Fix Steps"}),e.jsx("ol",{className:"fix-steps-list",children:h.map((g,b)=>e.jsx("li",{children:g},b))})]}),N.length>0&&e.jsxs("div",{className:"fix-recipe-checks",children:[e.jsx("span",{className:"fix-recipe-section-label",children:"Quick Checks"}),e.jsx("ul",{className:"fix-checks-list",children:N.map((g,b)=>e.jsxs("li",{children:[e.jsx("span",{className:"check-icon",children:"‚úì"}),typeof g=="string"?g:g.text||g]},b))})]})]}),u.length>0&&e.jsxs("div",{className:"related-situations",children:[e.jsx("h3",{children:"‚ö° This Also Applies When‚Ä¶"}),e.jsx("ul",{children:u.map((g,b)=>e.jsx("li",{children:typeof g=="string"?g:g.scenario?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:g.scenario}),g.connection?` ‚Äî ${g.connection}`:""]}):g.description||g.text||JSON.stringify(g)},b))})]}),e.jsxs("div",{className:"complete-stats-grid",children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("span",{className:"stat-icon",children:"üìö"}),e.jsx("span",{className:"stat-value",children:s.length}),e.jsx("span",{className:"stat-label",children:"Lessons"})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("span",{className:"stat-icon",children:"üé¨"}),e.jsx("span",{className:"stat-value",children:m}),e.jsx("span",{className:"stat-label",children:"Videos"})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("span",{className:"stat-icon",children:"‚è±"}),e.jsx("span",{className:"stat-value",children:t||"‚Äî"}),e.jsx("span",{className:"stat-label",children:"Total Time"})]}),p.length>0&&e.jsxs("div",{className:"stat-card",children:[e.jsx("span",{className:"stat-icon",children:"üè∑Ô∏è"}),e.jsx("span",{className:"stat-value",children:p.length}),e.jsx("span",{className:"stat-label",children:"Topics"})]})]}),p.length>0&&e.jsxs("div",{className:"complete-topics",children:[e.jsx("h3",{children:"üè∑Ô∏è Topics Covered"}),e.jsx("div",{className:"topic-chips",children:p.map(g=>e.jsx("span",{className:"topic-chip",children:g.replace(/_/g," ")},g))})]}),e.jsxs("div",{className:"reflection-area",children:[e.jsx("h3",{children:"üìù What was your main takeaway?"}),e.jsx("p",{className:"reflection-subtitle",children:"Writing your reflection helps cement what you learned."}),e.jsx("textarea",{className:"reflection-input",placeholder:"I learned that...",value:n,onChange:g=>o(g.target.value),rows:4}),e.jsxs("div",{className:"reflection-meta",children:[r===0&&e.jsx("span",{className:"word-hint",children:"Try writing a few sentences"}),r>0&&r<10&&e.jsxs("span",{className:"word-hint",children:[r," words ‚Äî keep going!"]}),r>=10&&e.jsx("span",{className:"word-hint done",children:"Great reflection! ‚úì"})]})]}),e.jsxs("div",{className:"completion-actions",children:[e.jsx("button",{className:"finish-btn",onClick:()=>{l();try{localStorage.removeItem("lp_reflection_draft")}catch{}},children:n.trim()?"Save & Finish":"Back to Problems"}),a&&e.jsx("button",{className:"back-to-path-btn",onClick:a,children:"‚Üê Back to Learning Path"})]})]})}ie.propTypes={courses:j.array.isRequired,totalDuration:j.string,reflectionText:j.string.isRequired,onReflectionChange:j.func.isRequired,wordCount:j.number.isRequired,onFinish:j.func.isRequired,onBackToPath:j.func,problemSummary:j.string,fixRecipe:j.shape({mostLikelyCause:j.string,fixSteps:j.array,fastChecks:j.array}),microLesson:j.object};function J(s){return s?s.replace(/\.mp4$/i,"").replace(/_/g," ").replace(/^[A-Z]{2,5}\s+\d[\d.]*\s*/gi,"").replace(/^\d+\.\d+\s*/g,"").replace(/^0*\d{1,3}\s+/g,"").replace(/^(\w+)[ _]\1[ _]/i,"").replace(/^(?:and|or)\s+/i,"").replace(/\s+\d{1,3}\s*(NEW|FINAL|EDIT|EDITED|OLD|DRAFT|v\d+)?\s*$/gi,"").replace(/\s+(NEW|FINAL|EDIT|EDITED|OLD|DRAFT|v\d+)\s*$/gi,"").replace(/([a-z])(\d{2})$/g,"$1").replace(/([a-z])([A-Z])/g,"$1 $2").replace(/([A-Z]+)([A-Z][a-z])/g,"$1 $2").replace(/\s+(?:5[0-5]|4[0-9])$/g,"").replace(/[-]+\s*$/g,"").replace(/^\s*[-]+/g,"").replace(/\s{2,}/g," ").trim()||s:"Untitled Video"}function ae({courses:s,currentIndex:t,onSkipTo:n}){const o=s.map(r=>r.code);return e.jsxs("div",{className:"course-sidebar",children:[e.jsx("h4",{children:"Your Path"}),e.jsx("div",{className:"sidebar-courses",children:s.map((r,l)=>{const a=Ie[r.code],c=a?.prerequisites?.filter(i=>!o.includes(i))||[];return e.jsxs("button",{className:`sidebar-course ${l===t?"active":""} ${l<t?"completed":""}`,onClick:()=>n(l),title:J(r.videos?.[0]?.title||r.title||r.name),children:[e.jsx("span",{className:"index",children:l<t?"‚úì":l+1}),e.jsx("span",{className:"title",children:J(r.videos?.[0]?.title||r.title||r.name)}),a?.difficulty&&e.jsx("span",{className:`difficulty-tag ${a.difficulty}`,children:a.difficulty}),c.length>0&&e.jsx("span",{className:"prereq-warning",title:`Recommended: ${c.join(", ")} first`,children:"‚ö†Ô∏è"})]},r.code||l)})})]})}ae.propTypes={courses:j.array.isRequired,currentIndex:j.number.isRequired,onSkipTo:j.func.isRequired};function re({courseCode:s,videoKey:t,onComplete:n,onSkip:o}){const[r,l]=y.useState(0),[a,c]=y.useState(null),[i,d]=y.useState(!1),[p,m]=y.useState(0),[x,h]=y.useState(!1),N=y.useMemo(()=>{if(!s||!t)return[];const _=X[s];if(!_)return[];if(_[t])return _[t];const k=I=>(I||"").replace(/\.mp4$/i,"").replace(/^[\d._]+/,"").replace(/[\s_]+/g,"").toLowerCase(),S=k(t);for(const[I,D]of Object.entries(_)){const R=k(I);if(R===S||R.includes(S)||S.includes(R))return D}return[]},[s,t]);if(N.length===0)return null;const u=N[r],v=a===u?.correct,f=N.length,w=_=>{i||c(_)},$=()=>{a!==null&&(d(!0),a===u.correct&&m(_=>_+1))},g=()=>{r<f-1?(l(_=>_+1),c(null),d(!1)):h(!0)},b=()=>{n({score:p,total:f})};if(x){const _=Math.round(p/f*100),k=_>=80?Ge:_>=50?We:ze,S=_>=80?"Excellent! You've got a strong grasp of this material.":_>=50?"Good effort! Consider rewatching for the topics you missed.":"You might want to re-watch this section before moving on.";return e.jsx("div",{className:"quiz-card",children:e.jsxs("div",{className:"quiz-score-summary",children:[e.jsx("div",{className:"score-icon-container",children:e.jsx(k,{size:48,className:"score-icon"})}),e.jsxs("h3",{children:[p,"/",f," Correct"]}),e.jsx("div",{className:"score-bar",children:e.jsx("div",{className:"score-fill",style:{width:`${_}%`}})}),e.jsx("p",{className:"score-message",children:S}),e.jsxs("button",{className:"quiz-continue-btn",onClick:b,children:["Continue ",e.jsx(O,{size:16})]})]})})}return e.jsxs("div",{className:"quiz-card",children:[e.jsxs("div",{className:"quiz-header",children:[e.jsx("span",{className:"quiz-icon",children:e.jsx(Ve,{size:20})}),e.jsx("h3",{children:"Quick Check"}),e.jsxs("span",{className:"quiz-progress",children:[r+1," / ",f]})]}),e.jsx("p",{className:"quiz-question",children:u.question}),e.jsx("div",{className:"quiz-options",children:u.options.map((_,k)=>{let S="quiz-option";return a===k&&(S+=" selected"),i&&(k===u.correct?S+=" correct":a===k&&(S+=" incorrect")),e.jsxs("button",{className:S,onClick:()=>w(k),disabled:i,children:[e.jsx("span",{className:"option-letter",children:String.fromCharCode(65+k)}),e.jsx("span",{className:"option-text",children:_}),i&&k===u.correct&&e.jsx("span",{className:"option-icon",children:e.jsx(H,{size:16})}),i&&a===k&&k!==u.correct&&e.jsx("span",{className:"option-icon",children:e.jsx(Pe,{size:16})})]},k)})}),i&&u.explanation&&e.jsxs("div",{className:`quiz-explanation ${v?"correct":"incorrect"}`,children:[e.jsx("span",{className:"explanation-icon",children:v?e.jsx(H,{size:16}):e.jsx(Ae,{size:16})}),e.jsx("p",{children:u.explanation})]}),e.jsxs("div",{className:"quiz-actions",children:[i?e.jsx("button",{className:"quiz-next-btn",onClick:g,children:r<f-1?e.jsxs(e.Fragment,{children:["Next Question ",e.jsx(O,{size:16})]}):e.jsxs(e.Fragment,{children:["See Results ",e.jsx(O,{size:16})]})}):e.jsx("button",{className:"quiz-check-btn",onClick:$,disabled:a===null,children:"Check Answer"}),e.jsx("button",{className:"quiz-skip-btn",onClick:o,children:"Skip Quiz"})]})]})}re.propTypes={courseCode:j.string,videoKey:j.string,onComplete:j.func.isRequired,onSkip:j.func.isRequired};const oe=new Set(["the","and","for","with","this","that","are","was","has","have","not","can","into","from","how","you","your","will","would","also","just","like","more","very","some","want","need","make","use","used","using","help","helpful","helps","get","getting","let","look","going","come","here","there","know","thing","really","actually","basically","something","everything","slow","fast","leading","exhibiting","experiencing","causing","about","been","being","could","does","doing","done","each","even","every","first","give","good","great","kind","made","much","over","part","right","same","see","show","start","still","take","tell","than","them","then","these","they","those","through","time","took","turn","way","well","what","when","where","which","while","work","working","unreal","engine","introduction","quick"]),cs=new Set(["gonna","going","really","actually","basically","right","thing","things","about","would","could","should","there","their","these","those","where","which","being","doing","using","other","first","second","third","after","before","every","still","again","already","engine","unreal","because","simply","called","allows","looking","provides"]);function M(s){return(s||"").replace(/\.mp4$/i,"").replace(/^[\d._]+/,"").replace(/[\s_]+/g,"").toLowerCase()}function ce({courseCode:s,videoTitle:t,problemSummary:n,matchedKeywords:o}){const[r,l]=y.useState(null);y.useEffect(()=>{let i=!1;return A(()=>import("./data-transcripts-CYT280mV.js"),[]).then(d=>{i||l(d.default||d)}),()=>{i=!0}},[]);const a=y.useMemo(()=>{if(!s||!r)return[];const i=r[s];if(!i)return[];const d=M(t);let p=null;for(const[u,v]of Object.entries(i))if(M(u)===d){p=v;break}if(!p)for(const[u,v]of Object.entries(i)){const f=M(u);if(f.includes(d)||d.includes(f)){p=v;break}}if(!p||p.length===0)return[];const m=[];if(n&&m.push(...n.toLowerCase().split(/\s+/).filter(u=>u.length>3&&!oe.has(u))),o&&m.push(...o.map(u=>(typeof u=="string"?u:u.display_name||u.id||"").toLowerCase())),m.length===0){const u=p.filter(f=>f.start&&f.start!=="0:00");if(u.length===0)return[];const v=Math.max(1,Math.floor(u.length/3));return u.filter((f,w)=>w%v===0).slice(0,3).map(f=>({...f,score:0,isChapter:!0}))}const h=p.map(u=>{const v=u.text.toLowerCase();let f=0;const w=[];for(const $ of m)v.includes($)&&(f+=10,w.includes($)||w.push($));return{...u,score:f,hits:[...new Set(w)]}}).filter(u=>u.score>0).sort((u,v)=>v.score-u.score);if(h.length>0){const u=h.slice(0,3);return u.sort((v,f)=>{const w=$=>{const g=($||"0:00").split(":").map(Number);return g.length===3?g[0]*3600+g[1]*60+g[2]:g[0]*60+(g[1]||0)};return w(v.start)-w(f.start)}),u}const N=Math.max(1,Math.floor(p.length/3));return p.filter((u,v)=>v%N===0).slice(0,3).map(u=>({...u,score:0,isChapter:!0}))},[s,t,n,o,r]),c=y.useCallback(i=>{if(i.summary)return i.summary;const p=(i.text||"").replace(/[.,;:!?'"()]/g,"").split(/\s+/).filter(h=>h.length>=5&&!cs.has(h.toLowerCase())).map(h=>h.toLowerCase()),m={};for(const h of p)m[h]=(m[h]||0)+1;const x=Object.entries(m).sort((h,N)=>N[1]-h[1]).slice(0,3).map(([h])=>h.charAt(0).toUpperCase()+h.slice(1));return x.length>0?x.join(", "):"Overview"},[]);return a.length===0?null:e.jsx("div",{className:"video-info-cards",children:e.jsxs("div",{className:"info-card transcript-card",children:[e.jsx("h4",{children:a[0]?.isChapter?"üìã Video Chapters":`üéØ üé¨ Video Callouts: ${n||"your search"}`}),e.jsx("div",{className:"timestamp-list",children:a.map((i,d)=>e.jsxs("div",{className:`timestamp-item ${i.score>0?"relevant":""}`,children:[e.jsx("span",{className:"timestamp-badge",children:i.start}),e.jsx("span",{className:"timestamp-text",children:c(i)})]},d))})]})})}ce.propTypes={courseCode:j.string,videoTitle:j.string,problemSummary:j.string,matchedKeywords:j.array};const ls=new Set(["intro","introduction","outro","summary","review","overview","welcome"]);function le(s,t=5){return!s||!Array.isArray(s)?[]:s.map(n=>(n.name||"").replace(/\.[^.]+$/,"").split("_").filter(a=>a.length>3&&!/^[\d.]+$/.test(a)&&!/^\d{1,3}$/.test(a)).reduce((a,c)=>c.length>a.length?c:a,"").replace(/([a-z])([A-Z])/g,"$1 $2").replace(/([A-Z]+)([A-Z][a-z])/g,"$1 $2")).filter(n=>n.length>3&&!ls.has(n.toLowerCase())).filter((n,o,r)=>r.indexOf(n)===o).slice(0,t)}function Is(s,t=[]){const n=le(s);return n.length>0?`You'll learn: ${n.join(", ")}`:t.length>0?t.slice(0,4).join(", "):""}function ds(s){if(!s||typeof s!="string")return s;s=s.replace(/\s*\[\d+(?:[,\s]*\d+)*\]/g,"").trim();const t=[];let n=s,o=0;for(;n.length>0;){const r=[{re:/\*\*(.+?)\*\*/,wrap:i=>e.jsx("strong",{children:i},o++)},{re:/\*(.+?)\*/,wrap:i=>e.jsx("em",{children:i},o++)},{re:/`([^`]+)`/,wrap:i=>e.jsx("code",{className:"inline-code",children:i},o++)},{re:/\[([^\]]+)\]\(([^)]+)\)/,wrap:(i,d)=>{const p=/^https?:\/\//i.test(d)?d:"#";return e.jsx("a",{href:p,target:"_blank",rel:"noopener noreferrer",children:i},o++)}}];let l=null,a=n.length,c=null;for(const i of r){const d=n.match(i.re);d&&d.index<a&&(l=d,a=d.index,c=i)}if(!l){t.push(n);break}a>0&&t.push(n.slice(0,a)),t.push(c.wrap(l[1],l[2])),n=n.slice(a+l[0].length)}return t}function de(s){const t=as(s);return e.jsxs("div",{className:"guided-player",children:[e.jsxs("div",{className:"progress-bar",children:[e.jsx("div",{className:"progress-fill",style:{width:`${t.progress.percent}%`}}),e.jsx("span",{className:"progress-text",children:t.progress.text})]}),t.stage===T.INTRO&&e.jsx(hs,{introContent:t.introContent,streak:t.streak,courses:t.courses,pathSummary:t.pathSummary,user:t.user,authLoading:t.authLoading,onSignIn:t.handleSignIn,onStart:t.handleStartLearning}),t.stage===T.PLAYING&&t.currentCourse&&!t.currentCourse._readingStep&&e.jsx(us,{course:t.currentCourse,currentVideos:t.currentVideos,currentVideo:t.currentVideo,videoIndex:t.videoIndex,hasMoreVideos:t.hasMoreVideos,microLesson:s.microLesson,courses:t.courses,onVideoComplete:t.handleVideoComplete,onExit:t.onExit}),t.stage===T.PLAYING&&t.currentCourse&&t.currentCourse._readingStep&&e.jsx(he,{course:t.currentCourse,stepNumber:t.currentIndex+1,totalSteps:t.courses.length,onComplete:t.handleVideoComplete,onExit:t.onExit}),t.stage===T.QUIZ&&e.jsx(re,{courseCode:t.currentCourse?.code,videoKey:t.currentVideo?.title||t.currentVideo?.name||"",onComplete:t.handleQuizComplete,onSkip:t.handleQuizComplete}),t.stage===T.CHALLENGE&&t.challengeContent&&e.jsx(ne,{challengeContent:t.challengeContent,onComplete:t.handleChallengeComplete}),t.stage===T.COMPLETE&&e.jsx(ie,{courses:t.courses,totalDuration:t.introContent.totalDuration,reflectionText:t.reflectionText,onReflectionChange:t.setReflectionText,wordCount:t.wordCount,onFinish:t.handleFinish,onBackToPath:t.handleBackToPath,problemSummary:s.problemSummary,fixRecipe:s.fixRecipe,microLesson:s.microLesson}),t.stage!==T.INTRO&&t.stage!==T.COMPLETE&&e.jsxs("div",{className:"sidebar-column",children:[e.jsx(ae,{courses:t.courses,currentIndex:t.currentIndex,onSkipTo:t.handleSkipTo}),t.stage===T.PLAYING&&t.currentCourse&&e.jsx(ce,{courseCode:t.currentCourse.code,videoTitle:t.currentVideo?.title||t.currentVideo?.name||"",problemSummary:s.problemSummary,matchedKeywords:t.currentCourse._matchedKeywords})]})]})}de.propTypes={courses:j.array.isRequired,diagnosis:j.object,problemSummary:j.string,microLesson:j.object,fixRecipe:j.shape({mostLikelyCause:j.string,fixSteps:j.array,fastChecks:j.array}),pathSummary:j.shape({path_summary:j.string,topics_covered:j.arrayOf(j.string)}),onComplete:j.func,onExit:j.func};de.defaultProps={diagnosis:null,problemSummary:"",microLesson:null,fixRecipe:null,pathSummary:null,onComplete:()=>{},onExit:()=>{}};function hs({introContent:s,streak:t,courses:n,pathSummary:o,user:r,authLoading:l,onSignIn:a,onStart:c}){return e.jsxs("div",{className:"intro-card",children:[e.jsx("h2",{children:s.title}),e.jsx("p",{className:"intro-text",children:s.intro}),s.rootCauses?.length>0&&e.jsx("ol",{className:"root-cause-list",children:s.rootCauses.map((i,d)=>e.jsx("li",{children:i.replace(/\s*\[\d+\]/g,"")},d))}),t.isActive&&t.count>1&&e.jsxs("div",{className:"streak-badge",children:["üî• ",t.count,"-day learning streak!"]}),e.jsxs("div",{className:"course-preview",children:[e.jsx("h3",{children:"üìö What You'll Learn"}),o?.path_summary&&!/unavailable/i.test(o.path_summary)&&e.jsx("div",{className:"path-summary-section",children:e.jsx("p",{className:"path-summary-text",children:o.path_summary})}),o?.topics_covered?.length>0&&e.jsx("ul",{className:"path-topics-list",children:o.topics_covered.slice(0,6).map((i,d)=>e.jsx("li",{children:(i||"").replace(/_/g," ")},d))}),e.jsxs("div",{className:"course-list",children:[n.slice(0,5).map((i,d)=>{const p=Ee[i.code]||[],m=i.videos?.[0]?.title||i.title||i.name,x=p.length===0?le(i.videos,4):[],h=i.learningOutcome||"",N=i.videos?.length||0,u=(i.videos||[]).reduce((f,w)=>f+(w.duration_seconds||0),0),v=Math.round(u/60);return e.jsxs("div",{className:"course-preview-item",children:[e.jsx("span",{className:"number",children:d+1}),e.jsxs("div",{className:"course-preview-details",children:[e.jsx("span",{className:"title",children:m?.replace(/\s+Part\s+[A-Z]$/i,"").trim()}),(N>0||v>0)&&e.jsxs("span",{className:"course-meta-line",children:[N>0&&`${N} video${N>1?"s":""}`,N>0&&v>0&&" ¬∑ ",v>0&&`${v} min`]}),p.length>0&&e.jsx("ul",{className:"objective-list",children:p.slice(0,2).map((f,w)=>e.jsx("li",{children:f},w))}),x.length>0&&e.jsx("ul",{className:"auto-topics-list",children:x.map((f,w)=>e.jsx("li",{children:f},w))}),h&&p.length===0&&x.length===0&&e.jsx("p",{className:"course-outcome",children:h})]})]},i.code||d)}),n.length>5&&e.jsxs("div",{className:"more-courses",children:["+",n.length-5," more"]})]})]}),e.jsx("div",{className:"auth-section",children:l?e.jsx("p",{className:"auth-loading",children:"Checking sign-in status..."}):r?e.jsxs("div",{className:"auth-signed-in",children:[e.jsxs("span",{className:"user-email",children:["‚úì Signed in as ",r.email]}),e.jsx("button",{className:"start-btn",onClick:c,children:"‚ñ∂ Start Learning"})]}):e.jsxs("div",{className:"auth-prompt",children:[e.jsx("p",{className:"signin-note",children:"Sign in with Google to watch videos from Google Drive"}),e.jsx("button",{className:"signin-btn",onClick:a,children:"üîê Sign in with Google"}),e.jsx("button",{className:"start-btn secondary",onClick:c,children:"Skip sign-in (videos may not load)"})]})})]})}function V(s){return(s||"").replace(/\.mp4$/i,"").replace(/^[\d._]+/,"").replace(/[\s_]+/g,"").toLowerCase()}function us({course:s,currentVideos:t,currentVideo:n,videoIndex:o,hasMoreVideos:r,microLesson:l,courses:a,onVideoComplete:c,onExit:i}){const d=n?.drive_id,[p,m]=y.useState(null);y.useEffect(()=>{let f=!1;return A(()=>import("./data-transcripts-CYT280mV.js"),[]).then(w=>{f||m(w.default||w)}),()=>{f=!0}},[]);const h=(n?.name||"").replace(/\.[^.]+$/,"").split("_").filter(f=>f.length>3&&!/^[\d.]+$/.test(f)&&!/^\d{1,3}$/.test(f)).reduce((f,w)=>w.length>f.length?w:f,"").replace(/([a-z])([A-Z])/g,"$1 $2").replace(/([A-Z]+)([A-Z][a-z])/g,"$1 $2"),N=y.useMemo(()=>{if(!p||!s?.code)return[];const f=p[s.code];if(!f)return[];const w=V(n?.name||n?.title||"");let $=null;for(const[_,k]of Object.entries(f))if(V(_)===w){$=k;break}if(!$)for(const[_,k]of Object.entries(f)){const S=V(_);if(S.includes(w)||w.includes(S)){$=k;break}}if(!$||$.length===0)return[];const g=new Set,b=[];for(const _ of $){const k=(_.summary||"").trim();if(k&&!g.has(k.toLowerCase())&&(g.add(k.toLowerCase()),b.push(k),b.length>=4))break}return b},[p,s?.code,n?.name,n?.title]),u=N.length>0?N:(()=>{const f=[];return s.gemini_outcomes&&f.push(...s.gemini_outcomes.slice(0,3)),s.learningOutcome&&f.length<3&&f.push(s.learningOutcome),f})(),v=y.useMemo(()=>{if(!l)return null;const f=[...u],w=h&&h.length>3?h:s.title,$=(w||"").toLowerCase(),g=[...s.canonical_tags||[],...s.ai_tags||[],...s.gemini_system_tags||[]].map(k=>typeof k=="string"?k.toLowerCase():""),b=(l.quick_fix?.steps||[]).filter(k=>{const S=k.toLowerCase();return S.includes($)||g.some(I=>I.length>3&&S.includes(I))}),_=b.length>0?b:l.quick_fix?.steps||[];return{...l,step_focus:{topic:w,points:f,isFiltered:b.length>0},quick_fix:l.quick_fix?{...l.quick_fix,steps:_}:null}},[l,u,h,s]);return e.jsxs("div",{className:"video-stage",children:[e.jsxs("div",{className:"video-header",children:[e.jsx("h3",{children:s.title||s.name}),t.length>1&&e.jsxs("span",{className:"video-counter",children:["Video ",o+1," of ",t.length]})]}),e.jsxs("div",{className:"video-focus-callout",children:[h&&h.length>3&&e.jsxs("div",{className:"focus-topic",children:[e.jsx("span",{className:"focus-icon",children:"üéØ"}),e.jsxs("span",{className:"focus-label",children:["Focus on: ",e.jsx("strong",{children:h})]})]}),u.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"focus-subheading",children:N.length>0?"üìñ What you'll learn in this video:":"üìå Key points to watch for:"}),e.jsx("ul",{className:"focus-points",children:u.map((f,w)=>e.jsx("li",{children:f},w))})]})]}),e.jsx("div",{className:"video-container",children:d?e.jsx("iframe",{src:`https://drive.google.com/file/d/${d}/preview`,title:n.title||s.title,allow:"autoplay",allowFullScreen:!0},d):e.jsxs("div",{className:"video-embed-error",children:[e.jsx("div",{className:"embed-error-icon",children:"üìπ"}),e.jsx("p",{className:"embed-error-title",children:"Video temporarily unavailable"}),e.jsx("p",{className:"embed-error-detail",children:"No video file is associated with this lesson."})]})}),d&&e.jsx("a",{href:`https://drive.google.com/file/d/${d}/view`,target:"_blank",rel:"noopener noreferrer",className:"drive-fallback-link",children:"üîó Video not loading? Open in Google Drive"}),v&&e.jsx(ps,{microLesson:v,courses:a}),e.jsxs("div",{className:"video-controls",children:[e.jsx("button",{className:"complete-btn",onClick:c,children:r?"Mark Complete & Continue ‚Üí":"Complete & Try Exercise ‚Üí"}),e.jsx("button",{className:"exit-btn",onClick:i,children:"Exit Path"})]})]})}function ps({microLesson:s,courses:t}){const[n,o]=y.useState(!1),[r,l]=y.useState("quick_fix"),a=s?.quick_fix,c=s?.why_it_works,i=s?.related_situations,d=s?.step_focus,p=x=>{l(h=>h===x?null:x)},m=x=>x?x.replace(/\s*\[\d+(?:[,\s]*\d+)*\]/g,"").trim():null;return e.jsxs("div",{className:`gp-ai-lesson ${n?"open":"collapsed"}`,children:[e.jsxs("button",{className:"gp-ai-lesson-toggle",onClick:()=>o(x=>!x),children:[e.jsx("span",{className:"gp-ai-badge",children:"‚ú® AI Guide"}),e.jsx("span",{className:"gp-ai-subtitle",children:d?.topic?`Focus: ${d.topic}`:"What to look for"}),e.jsx("span",{className:"gp-ai-chevron",children:n?"‚ñæ":"‚ñ∏"})]}),n&&e.jsxs("div",{className:"gp-ai-body",children:[d?.points?.length>0&&e.jsxs("div",{className:`gp-ai-section ${r==="step_focus"?"expanded":""}`,children:[e.jsxs("button",{className:"gp-ai-section-toggle",onClick:()=>p("step_focus"),children:[e.jsx("span",{children:"üéØ Focus for This Video"}),e.jsx("span",{className:"gp-ai-section-chevron",children:r==="step_focus"?"‚ñæ":"‚ñ∏"})]}),r==="step_focus"&&e.jsx("ul",{className:"gp-ai-steps",children:d.points.map((x,h)=>e.jsx("li",{children:m(x)},h))})]}),a&&e.jsxs("div",{className:`gp-ai-section ${r==="quick_fix"?"expanded":""}`,children:[e.jsxs("button",{className:"gp-ai-section-toggle",onClick:()=>p("quick_fix"),children:[e.jsxs("span",{children:["‚ö° ",a.title||"Quick Fix"]}),d?.isFiltered&&e.jsx("span",{className:"gp-ai-filtered-tag",children:"filtered for this step"}),e.jsx("span",{className:"gp-ai-section-chevron",children:r==="quick_fix"?"‚ñæ":"‚ñ∏"})]}),r==="quick_fix"&&a.steps&&e.jsx("ol",{className:"gp-ai-steps",children:a.steps.map((x,h)=>e.jsx("li",{children:m(x)},h))})]}),c&&e.jsxs("div",{className:`gp-ai-section ${r==="why"?"expanded":""}`,children:[e.jsxs("button",{className:"gp-ai-section-toggle",onClick:()=>p("why"),children:[e.jsx("span",{children:"üß† Why This Works"}),c.key_concept&&e.jsx("span",{className:"gp-ai-concept-tag",children:c.key_concept}),e.jsx("span",{className:"gp-ai-section-chevron",children:r==="why"?"‚ñæ":"‚ñ∏"})]}),r==="why"&&e.jsx("p",{className:"gp-ai-explanation",children:m(c.explanation)})]}),i&&i.length>0&&e.jsxs("div",{className:`gp-ai-section ${r==="related"?"expanded":""}`,children:[e.jsxs("button",{className:"gp-ai-section-toggle",onClick:()=>p("related"),children:[e.jsx("span",{children:"üîó Related Situations"}),e.jsx("span",{className:"gp-ai-count-tag",children:i.length}),e.jsx("span",{className:"gp-ai-section-chevron",children:r==="related"?"‚ñæ":"‚ñ∏"})]}),r==="related"&&e.jsx("div",{className:"gp-ai-scenarios",children:i.map((x,h)=>e.jsxs("div",{className:"gp-ai-scenario",children:[e.jsxs("strong",{children:["üí° ",x.scenario]}),e.jsx("p",{children:m(x.connection)})]},h))})]})]})]})}function he({course:s,stepNumber:t,totalSteps:n,onComplete:o,onExit:r}){const[l,a]=y.useState(!1),c=s._resourceType==="doc"?"üìñ":"‚ñ∂Ô∏è",i=s._resourceType==="doc"?"Documentation":"YouTube Video",d=s._resourceType==="doc"?"Epic Docs":s._channel||"YouTube",p=s._resourceType!=="doc",m=(()=>{if(!p||!s._url)return null;try{const h=new URL(s._url);if(h.hostname.includes("youtube.com"))return h.searchParams.get("v");if(h.hostname.includes("youtu.be"))return h.pathname.slice(1)}catch{}return null})(),x=h=>{const N=Math.floor(h/60),u=h%60;return`${N}:${u.toString().padStart(2,"0")}`};return e.jsxs("div",{className:"reading-step",children:[e.jsxs("div",{className:"reading-step-header",children:[e.jsxs("span",{className:"reading-step-badge",children:[c," ",i]}),e.jsxs("span",{className:"reading-step-progress",children:["Step ",t," of ",n]})]}),e.jsx("h2",{className:"reading-step-title",children:s.title}),e.jsxs("div",{className:"reading-step-meta",children:[s._tier&&e.jsx("span",{className:`tier-badge tier-${s._tier}`,children:s._tier}),s._channelTrust&&e.jsx("span",{className:`channel-trust-badge trust-${s._channelTrust}`,children:s._channelTrust==="official"?"‚úì Official":"‚≠ê Expert"}),e.jsxs("span",{className:"reading-step-time",children:["‚è± ",s._readTimeMinutes," min ",p?"watch":"read"]})]}),s._topics&&s._topics.length>0&&e.jsx("div",{className:"reading-step-topics",children:s._topics.map((h,N)=>e.jsx("span",{className:"topic-chip",children:h.replace(/_/g," ")},N))}),s._description&&e.jsx("p",{className:"reading-step-description",children:s._description}),m&&e.jsx("div",{className:"reading-step-player",children:e.jsx("iframe",{src:`https://www.youtube-nocookie.com/embed/${m}?rel=0&modestbranding=1`,title:s.title,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,className:"reading-step-iframe"})}),s._keySteps&&s._keySteps.length>0?e.jsxs("div",{className:"key-steps-section",children:[e.jsx("h3",{className:"key-steps-heading",children:"üéØ Key Takeaways"}),e.jsx("ol",{className:"key-steps-list",children:s._keySteps.map((h,N)=>e.jsx("li",{className:"key-step-item",children:ds(h)},N))})]}):s._description?e.jsxs("div",{className:"key-steps-section key-steps-fallback",children:[e.jsx("h3",{className:"key-steps-heading",children:"üéØ What to Focus On"}),e.jsxs("ul",{className:"key-steps-list",children:[s._sections&&s._sections.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("li",{className:"key-step-item",children:["Read through the ",e.jsx("strong",{children:s.title})," page, focusing on these sections:"]}),s._sections.slice(0,5).map((h,N)=>e.jsxs("li",{className:"key-step-item",children:["üìñ Work through the ",e.jsx("strong",{children:h})," section"]},N))]}):e.jsxs(e.Fragment,{children:[e.jsxs("li",{className:"key-step-item",children:["Understand how ",e.jsx("strong",{children:s.title})," works in UE5"]}),s._topics&&s._topics.length>0&&s._topics.slice(0,2).map((h,N)=>e.jsxs("li",{className:"key-step-item",children:["Pay attention to ",e.jsx("strong",{children:h.replace(/_/g," ")})," concepts and workflows"]},N)),s._subsystem&&e.jsxs("li",{className:"key-step-item",children:["Note how ",e.jsx("strong",{children:s._subsystem})," integrates with the editor"]})]}),e.jsx("li",{className:"key-step-item",children:"Try applying these techniques in your own UE5 project"})]})]}):null,s._chapters&&s._chapters.length>0&&e.jsxs("div",{className:"chapters-section",children:[e.jsx("h3",{className:"chapters-heading",children:"üìë Chapters"}),e.jsx("div",{className:"chapters-list",children:s._chapters.map((h,N)=>e.jsxs("a",{href:m?`https://www.youtube.com/watch?v=${m}&t=${h.seconds}`:"#",target:"_blank",rel:"noopener noreferrer",className:"chapter-item",children:[e.jsx("span",{className:"chapter-time",children:x(h.seconds)}),e.jsx("span",{className:"chapter-label",children:h.label})]},N))})]}),s._seeAlso&&s._seeAlso.length>0&&e.jsxs("div",{className:"see-also-section",children:[e.jsx("h3",{className:"see-also-heading",children:"üîó See Also"}),e.jsx("div",{className:"see-also-links",children:s._seeAlso.map((h,N)=>{const u=Re[h.docKey];return u?e.jsxs("a",{href:u.url,target:"_blank",rel:"noopener noreferrer",className:"see-also-link",title:u.description||h.label,children:["‚Üí ",h.label]},N):null})})]}),e.jsx("div",{className:"reading-step-source",children:e.jsxs("span",{className:"reading-step-source-label",children:["Source: ",d]})}),e.jsxs("a",{href:s._url,target:"_blank",rel:"noopener noreferrer",className:"reading-step-link",onClick:()=>a(!0),children:[s._resourceType==="doc"?"üìÑ Open Documentation":"‚ñ∂Ô∏è Watch on YouTube",e.jsx("span",{className:"reading-step-link-arrow",children:"‚Üó"})]}),e.jsxs("div",{className:"reading-step-actions",children:[e.jsx("button",{className:`reading-step-complete ${l?"ready":""}`,onClick:o,title:l?"Continue to next step":"Mark as read and continue",children:l?"‚úì Read ‚Äî Continue ‚Üí":"Mark as Read ‚Üí Continue"}),e.jsx("button",{className:"reading-step-exit",onClick:r,children:"‚úï Exit Path"})]})]})}he.propTypes={course:j.object.isRequired,stepNumber:j.number.isRequired,totalSteps:j.number.isRequired,onComplete:j.func.isRequired,onExit:j.func.isRequired};let F=null;async function ms(){if(!F){const s=await A(()=>import("./data-embeddings-EsTyY_EC.js"),[]);F=s.default||s}return F}function ue(s,t){if(!s||!t||s.length!==t.length)return 0;let n=0,o=0,r=0;for(let a=0;a<s.length;a++)n+=s[a]*t[a],o+=s[a]*s[a],r+=t[a]*t[a];const l=Math.sqrt(o)*Math.sqrt(r);return l===0?0:n/l}async function Es(s,t=5,n=.3){const o=await ms();if(!s||!o?.courses)return[];const r=[];for(const[l,a]of Object.entries(o.courses)){const c=ue(s,a.embedding);c>=n&&r.push({code:l,title:a.title,similarity:c})}return r.sort((l,a)=>a.similarity-l.similarity),r.slice(0,t)}let G=null,Y=null;async function gs(){if(!G){const s=await A(()=>import("./data-search-SjqZFhcO.js").then(t=>t.s),[]);G=s.default||s}return G}async function fs(){if(!Y){const s=await A(()=>import("./data-search-SjqZFhcO.js").then(t=>t.a),[]);Y=s.default||s}return Y}let W=null,E=null;function xs(s,t=768){const n=atob(s),o=new Uint8Array(n.length);for(let a=0;a<n.length;a++)o[a]=n.charCodeAt(a);const r=new DataView(o.buffer),l=new Float32Array(t);for(let a=0;a<t;a++){const c=r.getUint16(a*2,!0);l[a]=js(c)}return l}function js(s){const t=s>>15&1,n=s>>10&31,o=s&1023;return n===0?(t?-1:1)*Math.pow(2,-14)*(o/1024):n===31?o?NaN:t?-1/0:1/0:(t?-1:1)*Math.pow(2,n-15)*(1+o/1024)}async function Ns(){if(E)return E;if(!W)try{const t=await fetch(new URL("../data/segment_embeddings.json",import.meta.url));if(!t.ok)throw new Error(`HTTP ${t.status}`);W=await t.json()}catch(t){return ee("‚ö†Ô∏è segment_embeddings.json not available:",t.message),null}const s=W?.segments;if(!s)return null;E=new Map;for(const[t,n]of Object.entries(s))E.set(t,{vector:xs(n.embedding),courseCode:n.course_code,videoKey:n.video_key,videoTitle:n.video_title,startTimestamp:n.start_timestamp,endTimestamp:n.end_timestamp,startSeconds:n.start_seconds,text:n.text,tokenEstimate:n.token_estimate});return qe(`[SegmentSearch] Decoded ${E.size} segment embeddings`),E}async function ys(s,t=[]){if(!s||s.length<3)return[];const n=s.toLowerCase().split(/\s+/).filter(a=>a.length>2&&!oe.has(a));if(n.length===0)return[];const o=await gs(),r=[],l=o?.course_words||{};for(const[a,c]of Object.entries(l)){let i=0;const d=[];for(const p of n)if(c[p]&&(i+=c[p]*10,d.push(p)),p.length>=4)for(const[m,x]of Object.entries(c))m!==p&&m.length>=4&&(m.startsWith(p)||p.startsWith(m))&&(i+=x*3,d.includes(m)||d.push(m));if(i>=30&&d.length>0){const p=t.find(x=>x.code===a),m=await vs(a,d);r.push({courseCode:a,courseTitle:p?.title||a,score:i,matchedKeywords:d,topSegments:m,estimatedSegment:m.length>0?m[0]:null,videoCount:p?.video_count||0,duration:p?.duration_formatted||"Unknown"})}}return r.sort((a,c)=>c.score-a.score).slice(0,5)}async function vs(s,t){const o=(await fs())[s];if(!o||!o.videos)return[];const r=[];for(const[l,a]of Object.entries(o.videos))if(a.segments)for(const c of a.segments){const i=c.text.toLowerCase();let d=0;const p=[];for(const m of t){const x=m.toLowerCase(),h=new RegExp(x.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi"),N=i.match(h);N&&(d+=N.length*10,p.push(m)),i.includes(x)&&(d+=5,p.includes(m)||p.push(m))}if(d>0){let m=c.text;if(m.length>120){const x=p[0]||"",h=m.toLowerCase().indexOf(x.toLowerCase());h>40&&(m="..."+m.substring(h-30)),m.length>120&&(m=m.substring(0,117)+"...")}r.push({videoKey:l,videoTitle:a.title,timestamp:c.start,startSeconds:c.start_seconds,endTimestamp:c.end,previewText:m,matchedKeywords:p,score:d})}}return r.sort((l,a)=>a.score-l.score).slice(0,3)}async function ks(s,t=10,n=.35){if(!s)return[];const o=await Ns();if(!o)return[];const r=[];for(const[a,c]of o){const i=ue(s,c.vector);i>=n&&r.push({id:a,courseCode:c.courseCode,videoKey:c.videoKey,videoTitle:c.videoTitle,timestamp:c.startTimestamp,endTimestamp:c.endTimestamp,startSeconds:c.startSeconds,previewText:c.text,similarity:i,source:"transcript"})}r.sort((a,c)=>c.similarity-a.similarity);const l=r.slice(0,t);if(l.length>0){const a=new Map;for(const[c,i]of o){const d=`${i.courseCode}:${i.videoKey}`;a.has(d)||a.set(d,[]),a.get(d).push({id:c,text:i.text,startSeconds:i.startSeconds})}for(const c of a.values())c.sort((i,d)=>i.startSeconds-d.startSeconds);for(const c of l){const i=`${c.courseCode}:${c.videoKey}`,d=a.get(i);if(!d)continue;const p=d.findIndex(h=>h.id===c.id);if(p===-1)continue;let m="";if(p>0){const N=(d[p-1].text||"").split(/[.!?]+\s*/);m=N[N.length-1]?.trim()||""}let x="";if(p<d.length-1&&(x=(d[p+1].text||"").split(/[.!?]+\s*/)[0]?.trim()||""),m||x){const h=[];m&&h.push("..."+m),h.push(c.previewText),x&&h.push(x+"..."),c.previewText=h.join(" ")}}}return l}async function Rs(s,t,n=[],o=8){const r=await ys(s,n);let l=[];t&&(l=await ks(t,o,.35));const a=new Set,c=[];for(const i of l){const d=`${i.courseCode}:${i.videoKey}:${i.timestamp}`;a.has(d)||(a.add(d),c.push({...i,searchType:"semantic",score:Math.round(i.similarity*100)}))}for(const i of r)for(const d of i.topSegments||[]){const p=`${i.courseCode}:${d.videoKey}:${d.timestamp}`;a.has(p)||(a.add(p),c.push({id:`kw_${i.courseCode}_${d.videoKey}`,courseCode:i.courseCode,videoKey:d.videoKey,videoTitle:d.videoTitle,timestamp:d.timestamp,startSeconds:d.startSeconds,previewText:d.previewText,similarity:0,score:d.score,searchType:"keyword",source:"transcript"}))}return c.slice(0,o)}export{O as A,ze as B,de as G,oe as S,ys as a,Is as b,J as c,ue as d,Es as f,fs as g,Rs as s};
