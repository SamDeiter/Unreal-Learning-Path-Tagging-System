import{j as e}from"./index-BilmmUn0.js";import{a as x}from"./vendor-cytoscape-hdah7_Xt.js";import{k as v}from"./data-courses-CecwKQwF.js";import"./vendor-firebase-DNc0QRT5.js";function $(){const[f,j]=x.useState(null),[d,k]=x.useState(null),{tagNames:u,tagSeries:S,dates:o,totalSeries:r}=x.useMemo(()=>{const s=v.snapshots||[];if(s.length===0)return{tagNames:[],tagSeries:{},dates:[],totalSeries:[]};const a=s.map(t=>t.date),l=s.map(t=>t.totalCourses),i=new Set;s.forEach(t=>Object.keys(t.tags||{}).forEach(c=>i.add(c)));const n=[...i].sort((t,c)=>(s[s.length-1].tags[c]||0)-(s[s.length-1].tags[t]||0)),p={};for(const t of n)p[t]=s.map(c=>c.tags[t]||0);return{tagNames:n,tagSeries:p,dates:a,totalSeries:l}},[]);if(u.length===0||o.length<2)return e.jsxs("div",{className:"sparkline-container",children:[e.jsx("h3",{className:"sparkline-title",children:"ðŸ“ˆ Tag Growth Trends"}),e.jsx("p",{className:"sparkline-empty",children:"Need at least 2 snapshots for trend data."})]});const N=(s,a=80,l=24,i="#6366f1")=>{const n=Math.min(...s),t=Math.max(...s)-n||1,c=s.map((m,h)=>{const g=h/(s.length-1)*a,D=l-(m-n)/t*(l-4)-2;return`${g},${D}`});return e.jsxs("svg",{width:a,height:l,className:"sparkline-svg",children:[e.jsx("polyline",{points:c.join(" "),fill:"none",stroke:i,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),s.length>0&&(()=>{const m=s[s.length-1],h=a,g=l-(m-n)/t*(l-4)-2;return e.jsx("circle",{cx:h,cy:g,r:"2.5",fill:i})})()]})},y=o[o.length-1],T=o[0];return e.jsxs("div",{className:"sparkline-container",children:[e.jsxs("div",{className:"sparkline-header",children:[e.jsx("h3",{className:"sparkline-title",children:"ðŸ“ˆ Tag Growth Trends"}),e.jsxs("span",{className:"sparkline-date-range",children:[T," â†’ ",y," (",o.length," snapshots)"]})]}),e.jsxs("div",{className:"sparkline-total-row",children:[e.jsx("span",{className:"sparkline-total-label",children:"Total Courses"}),N(r,100,28,"#10b981"),e.jsxs("span",{className:"sparkline-total-value",children:[r[r.length-1],e.jsxs("span",{className:"sparkline-delta",children:[r[r.length-1]-r[0]>0?"+":"",r[r.length-1]-r[0]]})]})]}),e.jsx("div",{className:"sparkline-grid",children:u.map(s=>{const a=S[s],l=a[a.length-1],i=a[0],n=l-i,p=f===s;return e.jsxs("div",{className:`sparkline-row ${p?"sparkline-row-hovered":""}`,onMouseEnter:()=>{j(s),k({tag:s,series:a,dates:o})},onMouseLeave:()=>{j(null),k(null)},children:[e.jsx("span",{className:"sparkline-tag-name",title:s,children:s}),N(a),e.jsxs("span",{className:"sparkline-value",children:[l,n!==0&&e.jsxs("span",{className:`sparkline-delta ${n>0?"positive":"negative"}`,children:[n>0?"+":"",n]})]})]},s)})}),d&&e.jsxs("div",{className:"sparkline-tooltip",children:[e.jsx("strong",{children:d.tag}),e.jsx("div",{className:"sparkline-tooltip-series",children:d.dates.map((s,a)=>e.jsxs("span",{children:[s,": ",e.jsx("strong",{children:d.series[a]})]},s))})]}),e.jsxs("div",{className:"sparkline-provenance",children:["Updated ",v._meta?.updateFrequency," Â· ",o.length," data points"]})]})}export{$ as default};
