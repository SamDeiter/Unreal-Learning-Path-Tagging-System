import{l as g,j as s,c as U,r as L}from"./index-Cgam5He1.js";import{a as t}from"./vendor-cytoscape-hdah7_Xt.js";import"./vendor-firebase-BQvzIQYL.js";import"./data-courses-aYLqO-5R.js";const S="https://samdeiter.github.io/Unreal-Learning-Path-Tagging-System";function T(){const[x,v]=t.useState([]),[k,l]=t.useState(!0),[h,m]=t.useState(!1),[c,p]=t.useState(null),[i,r]=t.useState(5),[u,C]=t.useState(null),[j,N]=t.useState(""),n=t.useCallback((e,a="success")=>{p({msg:e,type:a}),setTimeout(()=>p(null),3e3)},[]),b=t.useCallback(async()=>{l(!0);const e=await g();v(e),l(!1)},[]);t.useEffect(()=>{g().then(e=>{v(e),l(!1)})},[]);const f=async()=>{m(!0);const e=await U({maxUses:i,expiresInDays:u,note:j});e.code?(n(`Created invite: ${e.code}`),N(""),await b()):n(e.error||"Failed to create invite","error"),m(!1)},y=async e=>{const a=await L(e);a.success?(n(`Revoked ${e}`),await b()):n(a.error||"Failed to revoke","error")},w=e=>{const a=`${S}/?invite=${e}`;navigator.clipboard.writeText(a),n("Link copied to clipboard!")},o=x.filter(e=>!e.revoked),d=x.filter(e=>e.revoked);return s.jsxs("div",{className:"invite-manager",children:[c&&s.jsx("div",{className:`invite-toast ${c.type}`,children:c.msg}),s.jsxs("div",{className:"invite-create-card",children:[s.jsx("h2",{children:"ğŸŸï¸ Create Invite Code"}),s.jsxs("div",{className:"invite-create-form",children:[s.jsxs("div",{className:"form-row",children:[s.jsx("label",{children:"Max Uses"}),s.jsxs("div",{className:"stepper",children:[s.jsx("button",{onClick:()=>r(Math.max(1,i-1)),children:"âˆ’"}),s.jsx("span",{children:i===0?"âˆ":i}),s.jsx("button",{onClick:()=>r(i+1),children:"+"}),s.jsx("button",{className:`stepper-toggle ${i===0?"active":""}`,onClick:()=>r(i===0?5:0),children:i===0?"Limited":"Unlimited"})]})]}),s.jsxs("div",{className:"form-row",children:[s.jsx("label",{children:"Expires"}),s.jsx("div",{className:"expiry-options",children:[{label:"7 days",value:7},{label:"30 days",value:30},{label:"Never",value:null}].map(e=>s.jsx("button",{className:`expiry-btn ${u===e.value?"active":""}`,onClick:()=>C(e.value),children:e.label},e.label))})]}),s.jsxs("div",{className:"form-row",children:[s.jsx("label",{children:"Note (optional)"}),s.jsx("input",{type:"text",value:j,onChange:e=>N(e.target.value),placeholder:"e.g. For contractor team Q1",className:"note-input"})]}),s.jsx("button",{className:"create-btn",onClick:f,disabled:h,children:h?"Creating...":"âœ¨ Generate Invite Code"})]})]}),s.jsxs("div",{className:"invite-list-card",children:[s.jsxs("h2",{children:["ğŸ“‹ Active Invites (",o.length,")"]}),k?s.jsx("p",{className:"invite-loading",children:"Loading invites..."}):o.length===0?s.jsx("p",{className:"invite-empty",children:"No active invites. Create one above!"}):s.jsx("div",{className:"invite-table",children:o.map(e=>{const a=e.expiresAt&&e.expiresAt<new Date,I=e.maxUses===0?"âˆ":e.maxUses-e.usedCount;return s.jsxs("div",{className:`invite-row ${a?"expired":""}`,children:[s.jsxs("div",{className:"invite-code-display",children:[s.jsx("code",{children:e.code}),a&&s.jsx("span",{className:"badge expired-badge",children:"Expired"})]}),s.jsxs("div",{className:"invite-meta",children:[s.jsxs("span",{children:["Uses: ",e.usedCount,"/",e.maxUses===0?"âˆ":e.maxUses," (",I," left)"]}),e.expiresAt&&s.jsxs("span",{children:["Expires: ",e.expiresAt.toLocaleDateString()]}),e.note&&s.jsxs("span",{className:"invite-note",children:["ğŸ“ ",e.note]})]}),s.jsxs("div",{className:"invite-actions",children:[s.jsx("button",{className:"action-btn copy-btn",onClick:()=>w(e.code),title:"Copy invite link",children:"ğŸ“‹ Copy Link"}),s.jsx("button",{className:"action-btn revoke-btn",onClick:()=>y(e.code),title:"Revoke this invite",children:"ğŸš« Revoke"})]})]},e.code)})})]}),d.length>0&&s.jsxs("div",{className:"invite-list-card revoked-section",children:[s.jsxs("h2",{children:["ğŸš« Revoked (",d.length,")"]}),s.jsx("div",{className:"invite-table",children:d.map(e=>s.jsxs("div",{className:"invite-row revoked",children:[s.jsxs("div",{className:"invite-code-display",children:[s.jsx("code",{children:e.code}),s.jsx("span",{className:"badge revoked-badge",children:"Revoked"})]}),s.jsxs("div",{className:"invite-meta",children:[s.jsxs("span",{children:["Used ",e.usedCount," times"]}),e.note&&s.jsxs("span",{className:"invite-note",children:["ğŸ“ ",e.note]})]})]},e.code))})]})]})}export{T as default};
