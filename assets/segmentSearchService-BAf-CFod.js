import{o as Be,s as Qe,j as e,_ as q}from"./index-Bx6MaWme.js";import{a as v,P as g}from"./vendor-cytoscape-hdah7_Xt.js";import{b as z,q as he,d as pe,f as He,g as Je,l as Xe}from"./data-courses-CecwKQwF.js";import{a as O,L as et,d as me}from"./logger-CDyjTpW_.js";import{logVideoFeedback as le,getFeedbackStatus as tt,recordUpvote as st,recordDownvote as nt}from"./feedbackService-zokGkYj8.js";import{c as D}from"./createLucideIcon-YhyuTmrv.js";import{C as se}from"./check-eCXpKYRG.js";import{X as it}from"./x-HbUnH9yy.js";import{P as rt}from"./plus-mlfspTQG.js";const at=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Y=D("arrow-right",at);const ot=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],ct=D("book-open",ot);const lt=[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],dt=D("circle-play",lt);const ut=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],ht=D("flask-conical",ut);const pt=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],mt=D("star",pt);const ft=[["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}],["path",{d:"M7 10v12",key:"1qc93n"}]],gt=D("thumbs-up",ft);function xt({problemSummary:t,courses:s,diagnosis:i}){if(!s||s.length===0)return{title:"Your Learning Path",intro:"Let's solve your problem step by step.",instructors:[],totalDuration:null};const c=jt(s),l=Nt(s),d=kt({instructors:c,courseCount:s.length,totalDuration:l,rootCauses:i?.root_causes||[],courses:s});return{title:`Your Path: ${bt(t)}`,intro:d,instructors:c,totalDuration:l,courseCount:s.length,rootCauses:i?.root_causes||[]}}function yt(t,s,i){if(!s)return{type:"completion",text:"üéâ Congratulations! You've completed your learning path.",subtext:"You now have the skills to solve this problem and similar ones in the future."};const c=ne(t),l=ne(s),d=s.title||s.name||"the next lesson";return c&&l&&c!==l?{type:"transition",text:`Now let's hear from ${l}`,subtext:`${l} will cover: ${i||d}`,instructor:l}:{type:"continuation",text:`Next up: ${d}`,subtext:i||null,instructor:l}}function jt(t){const s=new Set,i=[];return t.forEach(c=>{const l=ne(c);if(l&&!s.has(l))s.add(l),i.push({name:l,courses:[c.title||c.name],totalDuration:ie(c)});else if(l){const d=i.find(a=>a.name===l);d&&(d.courses.push(c.title||c.name),d.totalDuration+=ie(c))}}),i}function ne(t){return t&&(t.instructor||t.author||t.creator||t.teacher||vt(t.title||t.name))||null}function vt(t){if(!t)return null;const s=t.match(/\bby\s+([A-Z][a-zA-Z]+(?:\s+[A-Z][a-zA-Z]+)?)/i);if(s)return s[1];const i=t.match(/\bwith\s+([A-Z][a-zA-Z]+(?:\s+[A-Z][a-zA-Z]+)?)/i);return i?i[1]:null}function Nt(t){const s=t.reduce((i,c)=>i+ie(c),0);return wt(s)}function ie(t){if(!t)return 0;if(t.videos?.length){const s=t.videos.reduce((i,c)=>i+(c.duration_seconds||0),0);if(s>0)return s}return t.duration_seconds?t.duration_seconds:t.duration_minutes?t.duration_minutes*60:0}function wt(t){if(!t||t<=0)return null;const s=Math.floor(t/3600),i=Math.floor(t%3600/60);return s>0?i>0?`${s} hr ${i} min`:`${s} hr`:`${i} min`}function bt(t){if(!t)return"Learning Path";if(t.length<=80)return t;const s=t.slice(0,80),i=s.lastIndexOf(" ");return(i>30?s.slice(0,i):s)+"‚Ä¶"}function kt({instructors:t,courseCount:s,totalDuration:i,rootCauses:c,courses:l}){const d=[];c.length>0&&d.push(`We've identified ${c.length} root cause${c.length>1?"s":""} for your issue:`);const a=(l||[]).reduce((u,r)=>u+(r.videos?.length||0),0);if(t.length===1)d.push(`${t[0].name} will guide you through ${s} lesson${s>1?"s":""}.`);else if(t.length>1){const u=t.map(n=>n.name),r=u.pop();d.push(`You'll learn from ${u.join(", ")} and ${r}.`)}else{const u=a>0?` covering ${a} video${a>1?"s":""}`:"";d.push(`You have ${s} lesson${s>1?"s":""} to complete${u}.`)}return i&&d.push(`Total time: ${i}.`),d.join(" ")}function _t(t,s){const i=Math.round((t+1)/s*100);return{text:`Video ${t+1} of ${s}`,percent:i,isComplete:t+1>=s}}function Ct(t,s,i,c=0){const d=[...t?.canonical_tags||[],...t?.gemini_system_tags||[],...t?.transcript_tags||[],...t?.extracted_tags||[],...Array.isArray(t?.tags)?t.tags:[]].map(f=>typeof f=="string"?f.split(".").pop():f.name||f.display_name||"").filter(Boolean).filter((f,N,j)=>j.indexOf(f)===N),a=t?.gemini_skill_level||"Intermediate",u=(s||"").toLowerCase(),r=[],n=new Set,o=f=>{for(const N of f)n.has(N.task)||(n.add(N.task),r.push(N))};if(u){const f=Object.keys(z).sort((N,j)=>j.length-N.length);for(const N of f)u.includes(N)&&o(z[N])}const p=[...d].sort((f,N)=>{const j=u.includes(f.toLowerCase())?1:0;return(u.includes(N.toLowerCase())?1:0)-j});for(const f of p){const N=f.toLowerCase();z[N]&&o(z[N])}if(r.length>0){const f=r[c%r.length];return{task:f.task,hint:f.hint,expectedResult:f.expectedResult,docsUrl:f.docsUrl||null,difficulty:a}}const m=d[0]||(i?i.split(/\s+/).slice(0,3).join(" "):"this concept"),h=i?`"${i}"`:"this lesson",y=t?.gemini_outcomes?.[0]||"";return{task:s?`Open UE5 and apply the technique from ${h} to address "${s}". In the Details panel, identify which ${m} settings you changed and note the before/after values.`:`Open UE5, create a test Actor, and set up ${m} from scratch following the approach from ${h}. Document which panels and properties you used.`,hint:y?`Focus on: ${y}. Check Details panel and World Settings for relevant options.`:`Look for ${m} options in the Details panel, Modes panel, or Project Settings ‚Üí Engine.`,expectedResult:s?`Your original issue ("${s}") should be resolved or visibly improved in the viewport. Compare before/after values in the Details panel to confirm the change took effect.`:`You should see ${m} applied correctly in the viewport or preview. The Details panel should reflect the new settings, and the editor should show no warnings related to your changes.`,difficulty:a}}const fe="ue5_learning_progress";function ge(){try{const t=localStorage.getItem(fe);return t?{...K(),...JSON.parse(t)}:K()}catch{return K()}}function K(){return{completedPaths:[],tagsEncountered:{},totalVideosWatched:0,reflections:[],streak:{lastDate:null,count:0}}}function St(t){try{localStorage.setItem(fe,JSON.stringify(t))}catch(s){O("[LearningProgress] Failed to save:",s.message)}}function Tt(t,s,i){const c=ge(),l=new Date().toISOString().split("T")[0];c.completedPaths.includes(t)||c.completedPaths.push(t);for(const d of s){const a=d.extracted_tags||d.tags||[];for(const u of a){const r=typeof u=="string"?u:u.name||u.display_name;r&&(c.tagsEncountered[r]=(c.tagsEncountered[r]||0)+1)}}if(c.totalVideosWatched+=s.length,c.streak.lastDate!==l){const d=new Date;d.setDate(d.getDate()-1);const a=d.toISOString().split("T")[0];c.streak.lastDate===a?c.streak.count+=1:c.streak.count=1,c.streak.lastDate=l}return i&&i.trim().length>0&&c.reflections.push({date:l,pathId:t,text:i.trim()}),St(c),c}function $t(){const t=ge(),s=new Date().toISOString().split("T")[0],i=new Date;i.setDate(i.getDate()-1);const c=i.toISOString().split("T")[0],l=t.streak.lastDate===s||t.streak.lastDate===c;return{count:l?t.streak.count:0,isActive:l}}const L={INTRO:"intro",PLAYING:"playing",QUIZ:"quiz",CHALLENGE:"challenge",BRIDGE:"bridge",COMPLETE:"complete"};function Lt({courses:t,diagnosis:s,problemSummary:i,pathSummary:c,onComplete:l,onExit:d}){const[a,u]=v.useState(L.INTRO),[r,n]=v.useState(0),[o,p]=v.useState(0),[m,h]=v.useState(""),y=v.useRef(0),[f,N]=v.useState(null),[j,w]=v.useState(!0);v.useEffect(()=>Be(I=>{N(I),w(!1)}),[]);const _=v.useCallback(async()=>{w(!0);const{error:S}=await Qe();S&&console.error("[GuidedPlayer] Sign in failed:",S),w(!1)},[]),x=t[r]||null,b=t[r+1]||null,C=x?.videos||[],k=C[o]||C[0]||null,T=o<C.length-1,E=o>0||r>0,$=T||!!b,R=C.length,Re=v.useMemo(()=>xt({problemSummary:i,courses:t,diagnosis:s}),[i,t,s]),Me=v.useMemo(()=>$t(),[]),oe=v.useMemo(()=>t.reduce((S,I)=>S+(I.videos?.length||1),0),[t]),ce=v.useMemo(()=>{let S=0;for(let I=0;I<r;I++)S+=t[I]?.videos?.length||1;return S+o},[t,r,o]),qe=v.useMemo(()=>_t(ce,oe),[ce,oe]),Pe=v.useMemo(()=>{if(a!==L.BRIDGE)return null;const S=x?.gemini_outcomes?.[0]||null;return yt(x,b,S)},[a,x,b]),Ae=v.useMemo(()=>a!==L.CHALLENGE?null:Ct(x,i,k?.title,r),[a,x,i,k,r]),De=v.useCallback(()=>{y.current=Date.now(),u(L.PLAYING)},[]),Oe=v.useCallback(()=>{if(x&&k&&f?.uid&&le(f.uid,x.code,k.key||k.title,"watched"),y.current=Date.now(),x?._readingStep){b?(n(S=>S+1),p(0),u(L.PLAYING)):(u(L.COMPLETE),l?.());return}if(T)p(S=>S+1);else{const S=he[x?.code];S&&Object.keys(S).length>0?u(L.QUIZ):u(L.CHALLENGE)}},[T,x,k,b,l,f]),ze=v.useCallback(()=>{if(o>0)p(S=>S-1);else if(r>0){const S=t[r-1]?.videos||[];n(I=>I-1),p(Math.max(0,S.length-1))}},[o,r,t]),Ve=v.useCallback(()=>{Date.now()-y.current<3e4&&x&&k&&f?.uid&&le(f.uid,x.code,k.key||k.title,"skipped"),y.current=Date.now(),T?p(I=>I+1):b&&(n(I=>I+1),p(0))},[T,b,x,k,f]),Fe=v.useCallback(()=>{n(0),p(0),u(L.PLAYING)},[]),Ue=v.useCallback(()=>{u(L.CHALLENGE)},[]),We=v.useCallback(()=>{b?(n(S=>S+1),p(0),u(L.PLAYING)):(u(L.COMPLETE),l?.())},[b,l]),Ge=v.useCallback(()=>{n(S=>S+1),p(0),u(L.PLAYING)},[]),Ye=v.useCallback(S=>{n(S),p(0),u(L.PLAYING)},[]),Ke=v.useCallback(()=>{const S=i?`path-${i.replace(/\s+/g,"-").toLowerCase().slice(0,40)}-${Date.now()}`:`path-${Date.now()}`;Tt(S,t,m),d?.()},[i,t,m,d]),Ze=m.trim().split(/\s+/).filter(Boolean).length;return{stage:a,currentIndex:r,videoIndex:o,reflectionText:m,setReflectionText:h,user:f,authLoading:j,currentCourse:x,nextCourse:b,currentVideos:C,currentVideo:k,hasMoreVideos:T,hasPreviousVideo:E,hasNextVideo:$,courseVideoCount:R,introContent:Re,streak:Me,progress:qe,bridgeContent:Pe,challengeContent:Ae,pathSummary:c,wordCount:Ze,courses:t,handleSignIn:_,handleStartLearning:De,handleVideoComplete:Oe,handlePreviousVideo:ze,handleNextVideo:Ve,handleBackToPath:Fe,handleQuizComplete:Ue,handleChallengeComplete:We,handleContinue:Ge,handleSkipTo:Ye,handleFinish:Ke,onExit:d}}function xe({challengeContent:t,onComplete:s}){return e.jsxs("div",{className:"challenge-card",children:[e.jsx("div",{className:"challenge-icon",children:"üî®"}),e.jsx("h3",{children:"Try It Yourself"}),e.jsx("div",{className:"challenge-difficulty",children:e.jsx("span",{className:`difficulty-badge ${t.difficulty.toLowerCase()}`,children:t.difficulty})}),e.jsx("p",{className:"challenge-task",children:t.task}),t.expectedResult&&e.jsxs("div",{className:"challenge-expected",children:[e.jsx("span",{className:"expected-label",children:"üëÅÔ∏è What to look for:"})," ",t.expectedResult]}),e.jsxs("div",{className:"challenge-hint",children:[e.jsx("span",{className:"hint-label",children:"üí° Hint:"})," ",t.hint]}),t.docsUrl&&e.jsx("a",{className:"docs-link",href:t.docsUrl,target:"_blank",rel:"noopener noreferrer",children:"üìñ Read the official UE5 docs ‚Üí"}),e.jsx("button",{className:"challenge-done-btn",onClick:s,children:"I tried it ‚Üí"}),e.jsx("button",{className:"challenge-skip-btn",onClick:s,children:"Skip challenge"})]})}xe.propTypes={challengeContent:g.shape({task:g.string.isRequired,hint:g.string.isRequired,expectedResult:g.string,docsUrl:g.string,difficulty:g.string.isRequired}).isRequired,onComplete:g.func.isRequired};g.shape({type:g.string.isRequired,text:g.string.isRequired,subtext:g.string}).isRequired,g.func.isRequired;function It(t){const s=new Set;for(const i of t)(i.ai_tags||[]).forEach(c=>s.add(c)),(i._matchedKeywords||[]).forEach(c=>s.add(c));return[...s].slice(0,8)}function Et(t,s){const i=[],c=new Set;if(t?.fixSteps?.length>0)for(const l of t.fixSteps){const d=typeof l=="string"?l:l.text||l.description||"";d&&!c.has(d.toLowerCase().slice(0,60))&&(c.add(d.toLowerCase().slice(0,60)),i.push(d))}if(s?.quick_fix?.steps?.length>0)for(const l of s.quick_fix.steps){const d=typeof l=="string"?l:l.text||l.action||"";d&&!c.has(d.toLowerCase().slice(0,60))&&(c.add(d.toLowerCase().slice(0,60)),i.push(d))}return i}function ye({courses:t,totalDuration:s,reflectionText:i,onReflectionChange:c,wordCount:l,onFinish:d,onBackToPath:a,problemSummary:u,fixRecipe:r,microLesson:n}){v.useEffect(()=>{if(i.trim())try{localStorage.setItem("lp_reflection_draft",JSON.stringify({text:i,timestamp:Date.now(),courseCount:t.length}))}catch{}},[i,t.length]),v.useEffect(()=>{try{const x=JSON.parse(localStorage.getItem("lp_reflection_draft")||"null");x?.text&&!i&&c(x.text)}catch{}},[]);const o=It(t),p=t.reduce((x,b)=>x+(b.videos?.length||1),0),m=r?.mostLikelyCause||n?.why_it_works?.explanation||null,h=Et(r,n),y=r?.fastChecks||[],f=n?.related_situations||[],N=m||h.length>0||y.length>0,[j,w]=v.useState(!1),_=()=>{const x=[];u&&x.push(`Problem: ${u}`),m&&x.push(`
Root Cause: ${m}`),h.length>0&&(x.push(`
Fix Steps:`),h.forEach((b,C)=>x.push(`  ${C+1}. ${b}`))),y.length>0&&(x.push(`
Quick Checks:`),y.forEach(b=>x.push(`  ‚úì ${typeof b=="string"?b:b.text||b}`))),navigator.clipboard.writeText(x.join(`
`)).then(()=>{w(!0),setTimeout(()=>w(!1),2e3)}).catch(()=>{})};return e.jsxs("div",{className:"complete-card",children:[e.jsx("div",{className:"complete-icon",children:"üéâ"}),e.jsx("h2",{children:"Path Complete!"}),u&&e.jsxs("p",{className:"complete-problem-context",children:["You explored: ",e.jsx("strong",{children:u})]}),N&&e.jsxs("div",{className:"fix-recipe-card",children:[e.jsxs("div",{className:"fix-recipe-header",children:[e.jsx("h3",{children:"üîß If You See This Again‚Ä¶"}),e.jsx("button",{className:"copy-recipe-btn",onClick:_,title:"Copy fix recipe to clipboard",children:j?"‚úì Copied!":"üìã Copy"})]}),m&&e.jsxs("div",{className:"fix-recipe-cause",children:[e.jsx("span",{className:"fix-recipe-cause-label",children:"üéØ Root Cause"}),e.jsx("p",{children:m})]}),h.length>0&&e.jsxs("div",{className:"fix-recipe-steps",children:[e.jsx("span",{className:"fix-recipe-section-label",children:"Fix Steps"}),e.jsx("ol",{className:"fix-steps-list",children:h.map((x,b)=>e.jsx("li",{children:x},b))})]}),y.length>0&&e.jsxs("div",{className:"fix-recipe-checks",children:[e.jsx("span",{className:"fix-recipe-section-label",children:"Quick Checks"}),e.jsx("ul",{className:"fix-checks-list",children:y.map((x,b)=>e.jsxs("li",{children:[e.jsx("span",{className:"check-icon",children:"‚úì"}),typeof x=="string"?x:x.text||x]},b))})]})]}),f.length>0&&e.jsxs("div",{className:"related-situations",children:[e.jsx("h3",{children:"‚ö° This Also Applies When‚Ä¶"}),e.jsx("ul",{children:f.map((x,b)=>e.jsx("li",{children:typeof x=="string"?x:x.scenario?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:x.scenario}),x.connection?` ‚Äî ${x.connection}`:""]}):x.description||x.text||JSON.stringify(x)},b))})]}),e.jsxs("div",{className:"complete-stats-grid",children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("span",{className:"stat-icon",children:"üìö"}),e.jsx("span",{className:"stat-value",children:t.length}),e.jsx("span",{className:"stat-label",children:"Lessons"})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("span",{className:"stat-icon",children:"üé¨"}),e.jsx("span",{className:"stat-value",children:p}),e.jsx("span",{className:"stat-label",children:"Videos"})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("span",{className:"stat-icon",children:"‚è±"}),e.jsx("span",{className:"stat-value",children:s||"‚Äî"}),e.jsx("span",{className:"stat-label",children:"Total Time"})]}),o.length>0&&e.jsxs("div",{className:"stat-card",children:[e.jsx("span",{className:"stat-icon",children:"üè∑Ô∏è"}),e.jsx("span",{className:"stat-value",children:o.length}),e.jsx("span",{className:"stat-label",children:"Topics"})]})]}),o.length>0&&e.jsxs("div",{className:"complete-topics",children:[e.jsx("h3",{children:"üè∑Ô∏è Topics Covered"}),e.jsx("div",{className:"topic-chips",children:o.map(x=>e.jsx("span",{className:"topic-chip",children:x.replace(/_/g," ")},x))})]}),e.jsxs("div",{className:"reflection-area",children:[e.jsx("h3",{children:"üìù What was your main takeaway?"}),e.jsx("p",{className:"reflection-subtitle",children:"Writing your reflection helps cement what you learned."}),e.jsx("textarea",{className:"reflection-input",placeholder:"I learned that...",value:i,onChange:x=>c(x.target.value),rows:4}),e.jsxs("div",{className:"reflection-meta",children:[l===0&&e.jsx("span",{className:"word-hint",children:"Try writing a few sentences"}),l>0&&l<10&&e.jsxs("span",{className:"word-hint",children:[l," words ‚Äî keep going!"]}),l>=10&&e.jsx("span",{className:"word-hint done",children:"Great reflection! ‚úì"})]})]}),e.jsxs("div",{className:"completion-actions",children:[e.jsx("button",{className:"finish-btn",onClick:()=>{d();try{localStorage.removeItem("lp_reflection_draft")}catch{}},children:i.trim()?"Save & Finish":"Back to Problems"}),a&&e.jsx("button",{className:"back-to-path-btn",onClick:a,children:"‚Üê Back to Learning Path"})]})]})}ye.propTypes={courses:g.array.isRequired,totalDuration:g.string,reflectionText:g.string.isRequired,onReflectionChange:g.func.isRequired,wordCount:g.number.isRequired,onFinish:g.func.isRequired,onBackToPath:g.func,problemSummary:g.string,fixRecipe:g.shape({mostLikelyCause:g.string,fixSteps:g.array,fastChecks:g.array}),microLesson:g.object};function re(t){return t?t.replace(/\.mp4$/i,"").replace(/_/g," ").replace(/^[A-Z]{2,5}\s+\d[\d.]*\s*/gi,"").replace(/^\d+\.\d+\s*/g,"").replace(/^0*\d{1,3}\s+/g,"").replace(/^(\w+)[ _]\1[ _]/i,"").replace(/^(?:and|or)\s+/i,"").replace(/\s+\d{1,3}\s*(NEW|FINAL|EDIT|EDITED|OLD|DRAFT|v\d+)?\s*$/gi,"").replace(/\s+(NEW|FINAL|EDIT|EDITED|OLD|DRAFT|v\d+)\s*$/gi,"").replace(/([a-z])(\d{2})$/g,"$1").replace(/([a-z])([A-Z])/g,"$1 $2").replace(/([A-Z]+)([A-Z][a-z])/g,"$1 $2").replace(/\s+(?:5[0-5]|4[0-9])$/g,"").replace(/[-]+\s*$/g,"").replace(/^\s*[-]+/g,"").replace(/\s{2,}/g," ").trim()||t:"Untitled Video"}function je({courses:t,currentIndex:s,onSkipTo:i}){const c=t.map(l=>l.code);return e.jsxs("div",{className:"course-sidebar",children:[e.jsx("h4",{children:"Your Path"}),e.jsx("div",{className:"sidebar-courses",children:t.map((l,d)=>{const a=pe[l.code],u=a?.prerequisites?.filter(r=>!c.includes(r))||[];return e.jsxs("button",{className:`sidebar-course ${d===s?"active":""} ${d<s?"completed":""}`,onClick:()=>i(d),title:re(l.videos?.[0]?.title||l.title||l.name),children:[e.jsx("span",{className:"index",children:d<s?"‚úì":d+1}),e.jsx("span",{className:"title",children:re(l.videos?.[0]?.title||l.title||l.name)}),a?.difficulty&&e.jsx("span",{className:`difficulty-tag ${a.difficulty}`,children:a.difficulty}),u.length>0&&e.jsx("span",{className:"prereq-warning",title:`Recommended: ${u.join(", ")} first`,children:"‚ö†Ô∏è"})]},l.code||d)})})]})}je.propTypes={courses:g.array.isRequired,currentIndex:g.number.isRequired,onSkipTo:g.func.isRequired};function ve({courseCode:t,videoKey:s,onComplete:i,onSkip:c}){const[l,d]=v.useState(0),[a,u]=v.useState(null),[r,n]=v.useState(!1),[o,p]=v.useState(0),[m,h]=v.useState(!1),y=v.useMemo(()=>{if(!t||!s)return[];const C=he[t];if(!C)return[];if(C[s])return C[s];const k=E=>(E||"").replace(/\.mp4$/i,"").replace(/^[\d._]+/,"").replace(/[\s_]+/g,"").toLowerCase(),T=k(s);for(const[E,$]of Object.entries(C)){const R=k(E);if(R===T||R.includes(T)||T.includes(R))return $}return[]},[t,s]);if(y.length===0)return null;const f=y[l],N=a===f?.correct,j=y.length,w=C=>{r||u(C)},_=()=>{a!==null&&(n(!0),a===f.correct&&p(C=>C+1))},x=()=>{l<j-1?(d(C=>C+1),u(null),n(!1)):h(!0)},b=()=>{i({score:o,total:j})};if(m){const C=Math.round(o/j*100),k=C>=80?mt:C>=50?gt:ct,T=C>=80?"Excellent! You've got a strong grasp of this material.":C>=50?"Good effort! Consider rewatching for the topics you missed.":"You might want to re-watch this section before moving on.";return e.jsx("div",{className:"quiz-card",children:e.jsxs("div",{className:"quiz-score-summary",children:[e.jsx("div",{className:"score-icon-container",children:e.jsx(k,{size:48,className:"score-icon"})}),e.jsxs("h3",{children:[o,"/",j," Correct"]}),e.jsx("div",{className:"score-bar",children:e.jsx("div",{className:"score-fill",style:{width:`${C}%`}})}),e.jsx("p",{className:"score-message",children:T}),e.jsxs("button",{className:"quiz-continue-btn",onClick:b,children:["Continue ",e.jsx(Y,{size:16})]})]})})}return e.jsxs("div",{className:"quiz-card",children:[e.jsxs("div",{className:"quiz-header",children:[e.jsx("span",{className:"quiz-icon",children:e.jsx(ht,{size:20})}),e.jsx("h3",{children:"Quick Check"}),e.jsxs("span",{className:"quiz-progress",children:[l+1," / ",j]})]}),e.jsx("p",{className:"quiz-question",children:f.question}),e.jsx("div",{className:"quiz-options",children:f.options.map((C,k)=>{let T="quiz-option";return a===k&&(T+=" selected"),r&&(k===f.correct?T+=" correct":a===k&&(T+=" incorrect")),e.jsxs("button",{className:T,onClick:()=>w(k),disabled:r,children:[e.jsx("span",{className:"option-letter",children:String.fromCharCode(65+k)}),e.jsx("span",{className:"option-text",children:C}),r&&k===f.correct&&e.jsx("span",{className:"option-icon",children:e.jsx(se,{size:16})}),r&&a===k&&k!==f.correct&&e.jsx("span",{className:"option-icon",children:e.jsx(it,{size:16})})]},k)})}),r&&f.explanation&&e.jsxs("div",{className:`quiz-explanation ${N?"correct":"incorrect"}`,children:[e.jsx("span",{className:"explanation-icon",children:N?e.jsx(se,{size:16}):e.jsx(et,{size:16})}),e.jsx("p",{children:f.explanation})]}),e.jsxs("div",{className:"quiz-actions",children:[r?e.jsx("button",{className:"quiz-next-btn",onClick:x,children:l<j-1?e.jsxs(e.Fragment,{children:["Next Question ",e.jsx(Y,{size:16})]}):e.jsxs(e.Fragment,{children:["See Results ",e.jsx(Y,{size:16})]})}):e.jsx("button",{className:"quiz-check-btn",onClick:_,disabled:a===null,children:"Check Answer"}),e.jsx("button",{className:"quiz-skip-btn",onClick:c,children:"Skip Quiz"})]})]})}ve.propTypes={courseCode:g.string,videoKey:g.string,onComplete:g.func.isRequired,onSkip:g.func.isRequired};const Ne=new Set(["the","and","for","with","this","that","are","was","has","have","not","can","into","from","how","you","your","will","would","also","just","like","more","very","some","want","need","make","use","used","using","help","helpful","helps","get","getting","let","look","going","come","here","there","know","thing","really","actually","basically","something","everything","slow","fast","leading","exhibiting","experiencing","causing","about","been","being","could","does","doing","done","each","even","every","first","give","good","great","kind","made","much","over","part","right","same","see","show","start","still","take","tell","than","them","then","these","they","those","through","time","took","turn","way","well","what","when","where","which","while","work","working","unreal","engine","introduction","quick"]),Rt=new Set(["gonna","going","really","actually","basically","right","thing","things","about","would","could","should","there","their","these","those","where","which","being","doing","using","other","first","second","third","after","before","every","still","again","already","engine","unreal","because","simply","called","allows","looking","provides"]);function Z(t){return(t||"").replace(/\.mp4$/i,"").replace(/^[\d._]+/,"").replace(/[\s_]+/g,"").toLowerCase()}function we({courseCode:t,videoTitle:s,problemSummary:i,matchedKeywords:c}){const[l,d]=v.useState(null);v.useEffect(()=>{let r=!1;return q(()=>import("./data-transcripts-CYT280mV.js"),[]).then(n=>{r||d(n.default||n)}),()=>{r=!0}},[]);const a=v.useMemo(()=>{if(!t||!l)return[];const r=l[t];if(!r)return[];const n=Z(s);let o=null;for(const[f,N]of Object.entries(r))if(Z(f)===n){o=N;break}if(!o)for(const[f,N]of Object.entries(r)){const j=Z(f);if(j.includes(n)||n.includes(j)){o=N;break}}if(!o||o.length===0)return[];const p=[];if(i&&p.push(...i.toLowerCase().split(/\s+/).filter(f=>f.length>3&&!Ne.has(f))),c&&p.push(...c.map(f=>(typeof f=="string"?f:f.display_name||f.id||"").toLowerCase())),p.length===0){const f=o.filter(j=>j.start&&j.start!=="0:00");if(f.length===0)return[];const N=Math.max(1,Math.floor(f.length/3));return f.filter((j,w)=>w%N===0).slice(0,3).map(j=>({...j,score:0,isChapter:!0}))}const h=o.map(f=>{const N=f.text.toLowerCase();let j=0;const w=[];for(const _ of p)N.includes(_)&&(j+=10,w.includes(_)||w.push(_));return{...f,score:j,hits:[...new Set(w)]}}).filter(f=>f.score>0).sort((f,N)=>N.score-f.score);if(h.length>0){const f=h.slice(0,3);return f.sort((N,j)=>{const w=_=>{const x=(_||"0:00").split(":").map(Number);return x.length===3?x[0]*3600+x[1]*60+x[2]:x[0]*60+(x[1]||0)};return w(N.start)-w(j.start)}),f}const y=Math.max(1,Math.floor(o.length/3));return o.filter((f,N)=>N%y===0).slice(0,3).map(f=>({...f,score:0,isChapter:!0}))},[t,s,i,c,l]),u=v.useCallback(r=>{if(r.summary)return r.summary;const o=(r.text||"").replace(/[.,;:!?'"()]/g,"").split(/\s+/).filter(h=>h.length>=5&&!Rt.has(h.toLowerCase())).map(h=>h.toLowerCase()),p={};for(const h of o)p[h]=(p[h]||0)+1;const m=Object.entries(p).sort((h,y)=>y[1]-h[1]).slice(0,3).map(([h])=>h.charAt(0).toUpperCase()+h.slice(1));return m.length>0?m.join(", "):"Overview"},[]);return a.length===0?null:e.jsx("div",{className:"video-info-cards",children:e.jsxs("div",{className:"info-card transcript-card",children:[e.jsx("h4",{children:a[0]?.isChapter?"üìã Video Chapters":`üéØ üé¨ Video Callouts: ${i||"your search"}`}),e.jsx("div",{className:"timestamp-list",children:a.map((r,n)=>e.jsxs("div",{className:`timestamp-item ${r.score>0?"relevant":""}`,children:[e.jsx("span",{className:"timestamp-badge",children:r.start}),e.jsx("span",{className:"timestamp-text",children:u(r)})]},n))})]})})}we.propTypes={courseCode:g.string,videoTitle:g.string,problemSummary:g.string,matchedKeywords:g.array};const Mt=new Set(["intro","introduction","outro","summary","review","overview","welcome"]);function be(t,s=5){return!t||!Array.isArray(t)?[]:t.map(i=>(i.name||"").replace(/\.[^.]+$/,"").split("_").filter(a=>a.length>3&&!/^[\d.]+$/.test(a)&&!/^\d{1,3}$/.test(a)).reduce((a,u)=>u.length>a.length?u:a,"").replace(/([a-z])([A-Z])/g,"$1 $2").replace(/([A-Z]+)([A-Z][a-z])/g,"$1 $2")).filter(i=>i.length>3&&!Mt.has(i.toLowerCase())).filter((i,c,l)=>l.indexOf(i)===c).slice(0,s)}function fs(t,s=[]){const i=be(t);return i.length>0?`You'll learn: ${i.join(", ")}`:s.length>0?s.slice(0,4).join(", "):""}function qt(t){if(!t||typeof t!="string")return t;t=t.replace(/\s*\[\d+(?:[,\s]*\d+)*\]/g,"").trim();const s=[];let i=t,c=0;for(;i.length>0;){const l=[{re:/\*\*(.+?)\*\*/,wrap:r=>e.jsx("strong",{children:r},c++)},{re:/\*(.+?)\*/,wrap:r=>e.jsx("em",{children:r},c++)},{re:/`([^`]+)`/,wrap:r=>e.jsx("code",{className:"inline-code",children:r},c++)},{re:/\[([^\]]+)\]\(([^)]+)\)/,wrap:(r,n)=>{const o=/^https?:\/\//i.test(n)?n:"#";return e.jsx("a",{href:o,target:"_blank",rel:"noopener noreferrer",children:r},c++)}}];let d=null,a=i.length,u=null;for(const r of l){const n=i.match(r.re);n&&n.index<a&&(d=n,a=n.index,u=r)}if(!d){s.push(i);break}a>0&&s.push(i.slice(0,a)),s.push(u.wrap(d[1],d[2])),i=i.slice(a+d[0].length)}return s}function ke(t){const s=Lt(t);return e.jsxs("div",{className:"guided-player",children:[e.jsxs("div",{className:"progress-bar",children:[e.jsx("div",{className:"progress-fill",style:{width:`${s.progress.percent}%`}}),e.jsx("span",{className:"progress-text",children:s.progress.text})]}),s.stage===L.INTRO&&e.jsx(Pt,{introContent:s.introContent,streak:s.streak,courses:s.courses,pathSummary:s.pathSummary,user:s.user,authLoading:s.authLoading,onSignIn:s.handleSignIn,onStart:s.handleStartLearning}),s.stage===L.PLAYING&&s.currentCourse&&!s.currentCourse._readingStep&&e.jsx(At,{course:s.currentCourse,currentVideos:s.currentVideos,currentVideo:s.currentVideo,videoIndex:s.videoIndex,hasMoreVideos:s.hasMoreVideos,microLesson:t.microLesson,courses:s.courses,onVideoComplete:s.handleVideoComplete,onExit:s.onExit}),s.stage===L.PLAYING&&s.currentCourse&&s.currentCourse._readingStep&&e.jsx(_e,{course:s.currentCourse,stepNumber:s.currentIndex+1,totalSteps:s.courses.length,onComplete:s.handleVideoComplete,onExit:s.onExit}),s.stage===L.QUIZ&&e.jsx(ve,{courseCode:s.currentCourse?.code,videoKey:s.currentVideo?.title||s.currentVideo?.name||"",onComplete:s.handleQuizComplete,onSkip:s.handleQuizComplete}),s.stage===L.CHALLENGE&&s.challengeContent&&e.jsx(xe,{challengeContent:s.challengeContent,onComplete:s.handleChallengeComplete}),s.stage===L.COMPLETE&&e.jsx(ye,{courses:s.courses,totalDuration:s.introContent.totalDuration,reflectionText:s.reflectionText,onReflectionChange:s.setReflectionText,wordCount:s.wordCount,onFinish:s.handleFinish,onBackToPath:s.handleBackToPath,problemSummary:t.problemSummary,fixRecipe:t.fixRecipe,microLesson:t.microLesson}),s.stage!==L.INTRO&&s.stage!==L.COMPLETE&&e.jsxs("div",{className:"sidebar-column",children:[e.jsx(je,{courses:s.courses,currentIndex:s.currentIndex,onSkipTo:s.handleSkipTo}),s.stage===L.PLAYING&&s.currentCourse&&e.jsx(we,{courseCode:s.currentCourse.code,videoTitle:s.currentVideo?.title||s.currentVideo?.name||"",problemSummary:t.problemSummary,matchedKeywords:s.currentCourse._matchedKeywords})]})]})}ke.propTypes={courses:g.array.isRequired,diagnosis:g.object,problemSummary:g.string,microLesson:g.object,fixRecipe:g.shape({mostLikelyCause:g.string,fixSteps:g.array,fastChecks:g.array}),pathSummary:g.shape({path_summary:g.string,topics_covered:g.arrayOf(g.string)}),onComplete:g.func,onExit:g.func};ke.defaultProps={diagnosis:null,problemSummary:"",microLesson:null,fixRecipe:null,pathSummary:null,onComplete:()=>{},onExit:()=>{}};function Pt({introContent:t,streak:s,courses:i,pathSummary:c,user:l,authLoading:d,onSignIn:a,onStart:u}){return e.jsxs("div",{className:"intro-card",children:[e.jsx("h2",{children:t.title}),e.jsx("p",{className:"intro-text",children:t.intro}),t.rootCauses?.length>0&&e.jsx("ol",{className:"root-cause-list",children:t.rootCauses.map((r,n)=>e.jsx("li",{children:r.replace(/\s*\[\d+\]/g,"")},n))}),s.isActive&&s.count>1&&e.jsxs("div",{className:"streak-badge",children:["üî• ",s.count,"-day learning streak!"]}),e.jsxs("div",{className:"course-preview",children:[e.jsx("h3",{children:"üìö What You'll Learn"}),c?.path_summary&&!/unavailable/i.test(c.path_summary)&&e.jsx("div",{className:"path-summary-section",children:e.jsx("p",{className:"path-summary-text",children:c.path_summary})}),c?.topics_covered?.length>0&&e.jsx("ul",{className:"path-topics-list",children:c.topics_covered.slice(0,6).map((r,n)=>e.jsx("li",{children:(r||"").replace(/_/g," ")},n))}),e.jsxs("div",{className:"course-list",children:[i.slice(0,5).map((r,n)=>{const o=He[r.code]||[],p=r.videos?.[0]?.title||r.title||r.name,m=o.length===0?be(r.videos,4):[],h=r.learningOutcome||"",y=r.videos?.length||0,f=(r.videos||[]).reduce((j,w)=>j+(w.duration_seconds||0),0),N=Math.round(f/60);return e.jsxs("div",{className:"course-preview-item",children:[e.jsx("span",{className:"number",children:n+1}),e.jsxs("div",{className:"course-preview-details",children:[e.jsx("span",{className:"title",children:p?.replace(/\s+Part\s+[A-Z]$/i,"").trim()}),(y>0||N>0)&&e.jsxs("span",{className:"course-meta-line",children:[y>0&&`${y} video${y>1?"s":""}`,y>0&&N>0&&" ¬∑ ",N>0&&`${N} min`]}),o.length>0&&e.jsx("ul",{className:"objective-list",children:o.slice(0,2).map((j,w)=>e.jsx("li",{children:j},w))}),m.length>0&&e.jsx("ul",{className:"auto-topics-list",children:m.map((j,w)=>e.jsx("li",{children:j},w))}),h&&o.length===0&&m.length===0&&e.jsx("p",{className:"course-outcome",children:h})]})]},r.code||n)}),i.length>5&&e.jsxs("div",{className:"more-courses",children:["+",i.length-5," more"]})]})]}),e.jsx("div",{className:"auth-section",children:d?e.jsx("p",{className:"auth-loading",children:"Checking sign-in status..."}):l?e.jsxs("div",{className:"auth-signed-in",children:[e.jsxs("span",{className:"user-email",children:["‚úì Signed in as ",l.email]}),e.jsx("button",{className:"start-btn",onClick:u,children:"‚ñ∂ Start Learning"})]}):e.jsxs("div",{className:"auth-prompt",children:[e.jsx("p",{className:"signin-note",children:"Sign in with Google to watch videos from Google Drive"}),e.jsx("button",{className:"signin-btn",onClick:a,children:"üîê Sign in with Google"}),e.jsx("button",{className:"start-btn secondary",onClick:u,children:"Skip sign-in (videos may not load)"})]})})]})}function B(t){return(t||"").replace(/\.mp4$/i,"").replace(/^[\d._]+/,"").replace(/[\s_]+/g,"").toLowerCase()}function At({course:t,currentVideos:s,currentVideo:i,videoIndex:c,hasMoreVideos:l,microLesson:d,courses:a,onVideoComplete:u,onExit:r}){const n=i?.drive_id,[o,p]=v.useState(null);v.useEffect(()=>{let j=!1;return q(()=>import("./data-transcripts-CYT280mV.js"),[]).then(w=>{j||p(w.default||w)}),()=>{j=!0}},[]);const h=(i?.name||"").replace(/\.[^.]+$/,"").split("_").filter(j=>j.length>3&&!/^[\d.]+$/.test(j)&&!/^\d{1,3}$/.test(j)).reduce((j,w)=>w.length>j.length?w:j,"").replace(/([a-z])([A-Z])/g,"$1 $2").replace(/([A-Z]+)([A-Z][a-z])/g,"$1 $2"),y=v.useMemo(()=>{if(!o||!t?.code)return[];const j=o[t.code];if(!j)return[];const w=B(i?.name||i?.title||"");let _=null;for(const[C,k]of Object.entries(j))if(B(C)===w){_=k;break}if(!_)for(const[C,k]of Object.entries(j)){const T=B(C);if(T.includes(w)||w.includes(T)){_=k;break}}if(!_||_.length===0)return[];const x=new Set,b=[];for(const C of _){const k=(C.summary||"").trim();if(k&&!x.has(k.toLowerCase())&&(x.add(k.toLowerCase()),b.push(k),b.length>=4))break}return b},[o,t?.code,i?.name,i?.title]),f=y.length>0?y:(()=>{const j=[];return t.gemini_outcomes&&j.push(...t.gemini_outcomes.slice(0,3)),t.learningOutcome&&j.length<3&&j.push(t.learningOutcome),j})(),N=v.useMemo(()=>{if(!d)return null;const j=[...f],w=h&&h.length>3?h:t.title,_=(w||"").toLowerCase(),x=[...t.canonical_tags||[],...t.ai_tags||[],...t.gemini_system_tags||[]].map(k=>typeof k=="string"?k.toLowerCase():""),b=(d.quick_fix?.steps||[]).filter(k=>{const T=k.toLowerCase();return T.includes(_)||x.some(E=>E.length>3&&T.includes(E))}),C=b.length>0?b:d.quick_fix?.steps||[];return{...d,step_focus:{topic:w,points:j,isFiltered:b.length>0},quick_fix:d.quick_fix?{...d.quick_fix,steps:C}:null}},[d,f,h,t]);return e.jsxs("div",{className:"video-stage",children:[e.jsxs("div",{className:"video-header",children:[e.jsx("h3",{children:t.title||t.name}),s.length>1&&e.jsxs("span",{className:"video-counter",children:["Video ",c+1," of ",s.length]})]}),e.jsxs("div",{className:"video-focus-callout",children:[h&&h.length>3&&e.jsxs("div",{className:"focus-topic",children:[e.jsx("span",{className:"focus-icon",children:"üéØ"}),e.jsxs("span",{className:"focus-label",children:["Focus on: ",e.jsx("strong",{children:h})]})]}),f.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"focus-subheading",children:y.length>0?"üìñ What you'll learn in this video:":"üìå Key points to watch for:"}),e.jsx("ul",{className:"focus-points",children:f.map((j,w)=>e.jsx("li",{children:j},w))})]})]}),e.jsx("div",{className:"video-container",children:n?e.jsx("iframe",{src:`https://drive.google.com/file/d/${n}/preview`,title:i.title||t.title,allow:"autoplay",allowFullScreen:!0},n):e.jsxs("div",{className:"video-embed-error",children:[e.jsx("div",{className:"embed-error-icon",children:"üìπ"}),e.jsx("p",{className:"embed-error-title",children:"Video temporarily unavailable"}),e.jsx("p",{className:"embed-error-detail",children:"No video file is associated with this lesson."})]})}),n&&e.jsx("a",{href:`https://drive.google.com/file/d/${n}/view`,target:"_blank",rel:"noopener noreferrer",className:"drive-fallback-link",children:"üîó Video not loading? Open in Google Drive"}),N&&e.jsx(Dt,{microLesson:N,courses:a}),e.jsxs("div",{className:"video-controls",children:[e.jsx("button",{className:"complete-btn",onClick:u,children:l?"Mark Complete & Continue ‚Üí":"Complete & Try Exercise ‚Üí"}),e.jsx("button",{className:"exit-btn",onClick:r,children:"Exit Path"})]})]})}function Dt({microLesson:t,courses:s}){const[i,c]=v.useState(!1),[l,d]=v.useState("quick_fix"),a=t?.quick_fix,u=t?.why_it_works,r=t?.related_situations,n=t?.step_focus,o=m=>{d(h=>h===m?null:m)},p=m=>m?m.replace(/\s*\[\d+(?:[,\s]*\d+)*\]/g,"").trim():null;return e.jsxs("div",{className:`gp-ai-lesson ${i?"open":"collapsed"}`,children:[e.jsxs("button",{className:"gp-ai-lesson-toggle",onClick:()=>c(m=>!m),children:[e.jsx("span",{className:"gp-ai-badge",children:"‚ú® AI Guide"}),e.jsx("span",{className:"gp-ai-subtitle",children:n?.topic?`Focus: ${n.topic}`:"What to look for"}),e.jsx("span",{className:"gp-ai-chevron",children:i?"‚ñæ":"‚ñ∏"})]}),i&&e.jsxs("div",{className:"gp-ai-body",children:[n?.points?.length>0&&e.jsxs("div",{className:`gp-ai-section ${l==="step_focus"?"expanded":""}`,children:[e.jsxs("button",{className:"gp-ai-section-toggle",onClick:()=>o("step_focus"),children:[e.jsx("span",{children:"üéØ Focus for This Video"}),e.jsx("span",{className:"gp-ai-section-chevron",children:l==="step_focus"?"‚ñæ":"‚ñ∏"})]}),l==="step_focus"&&e.jsx("ul",{className:"gp-ai-steps",children:n.points.map((m,h)=>e.jsx("li",{children:p(m)},h))})]}),a&&e.jsxs("div",{className:`gp-ai-section ${l==="quick_fix"?"expanded":""}`,children:[e.jsxs("button",{className:"gp-ai-section-toggle",onClick:()=>o("quick_fix"),children:[e.jsxs("span",{children:["‚ö° ",a.title||"Quick Fix"]}),n?.isFiltered&&e.jsx("span",{className:"gp-ai-filtered-tag",children:"filtered for this step"}),e.jsx("span",{className:"gp-ai-section-chevron",children:l==="quick_fix"?"‚ñæ":"‚ñ∏"})]}),l==="quick_fix"&&a.steps&&e.jsx("ol",{className:"gp-ai-steps",children:a.steps.map((m,h)=>e.jsx("li",{children:p(m)},h))})]}),u&&e.jsxs("div",{className:`gp-ai-section ${l==="why"?"expanded":""}`,children:[e.jsxs("button",{className:"gp-ai-section-toggle",onClick:()=>o("why"),children:[e.jsx("span",{children:"üß† Why This Works"}),u.key_concept&&e.jsx("span",{className:"gp-ai-concept-tag",children:u.key_concept}),e.jsx("span",{className:"gp-ai-section-chevron",children:l==="why"?"‚ñæ":"‚ñ∏"})]}),l==="why"&&e.jsx("p",{className:"gp-ai-explanation",children:p(u.explanation)})]}),r&&r.length>0&&e.jsxs("div",{className:`gp-ai-section ${l==="related"?"expanded":""}`,children:[e.jsxs("button",{className:"gp-ai-section-toggle",onClick:()=>o("related"),children:[e.jsx("span",{children:"üîó Related Situations"}),e.jsx("span",{className:"gp-ai-count-tag",children:r.length}),e.jsx("span",{className:"gp-ai-section-chevron",children:l==="related"?"‚ñæ":"‚ñ∏"})]}),l==="related"&&e.jsx("div",{className:"gp-ai-scenarios",children:r.map((m,h)=>e.jsxs("div",{className:"gp-ai-scenario",children:[e.jsxs("strong",{children:["üí° ",m.scenario]}),e.jsx("p",{children:p(m.connection)})]},h))})]})]})]})}function _e({course:t,stepNumber:s,totalSteps:i,onComplete:c,onExit:l}){const[d,a]=v.useState(!1),u=t._resourceType==="doc"?"üìñ":"‚ñ∂Ô∏è",r=t._resourceType==="doc"?"Documentation":"YouTube Video",n=t._resourceType==="doc"?"Epic Docs":t._channel||"YouTube",o=t._resourceType!=="doc",p=(()=>{if(!o||!t._url)return null;try{const h=new URL(t._url);if(h.hostname.includes("youtube.com"))return h.searchParams.get("v");if(h.hostname.includes("youtu.be"))return h.pathname.slice(1)}catch{}return null})(),m=h=>{const y=Math.floor(h/60),f=h%60;return`${y}:${f.toString().padStart(2,"0")}`};return e.jsxs("div",{className:"reading-step",children:[e.jsxs("div",{className:"reading-step-header",children:[e.jsxs("span",{className:"reading-step-badge",children:[u," ",r]}),e.jsxs("span",{className:"reading-step-progress",children:["Step ",s," of ",i]})]}),e.jsx("h2",{className:"reading-step-title",children:t.title}),e.jsxs("div",{className:"reading-step-meta",children:[t._tier&&e.jsx("span",{className:`tier-badge tier-${t._tier}`,children:t._tier}),t._channelTrust&&e.jsx("span",{className:`channel-trust-badge trust-${t._channelTrust}`,children:t._channelTrust==="official"?"‚úì Official":"‚≠ê Expert"}),e.jsxs("span",{className:"reading-step-time",children:["‚è± ",t._readTimeMinutes," min ",o?"watch":"read"]})]}),t._topics&&t._topics.length>0&&e.jsx("div",{className:"reading-step-topics",children:t._topics.map((h,y)=>e.jsx("span",{className:"topic-chip",children:h.replace(/_/g," ")},y))}),t._description&&e.jsx("p",{className:"reading-step-description",children:t._description}),p&&e.jsx("div",{className:"reading-step-player",children:e.jsx("iframe",{src:`https://www.youtube-nocookie.com/embed/${p}?rel=0&modestbranding=1`,title:t.title,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,className:"reading-step-iframe"})}),t._keySteps&&t._keySteps.length>0?e.jsxs("div",{className:"key-steps-section",children:[e.jsx("h3",{className:"key-steps-heading",children:"üéØ Key Takeaways"}),e.jsx("ol",{className:"key-steps-list",children:t._keySteps.map((h,y)=>e.jsx("li",{className:"key-step-item",children:qt(h)},y))})]}):t._description?e.jsxs("div",{className:"key-steps-section key-steps-fallback",children:[e.jsx("h3",{className:"key-steps-heading",children:"üéØ What to Focus On"}),e.jsxs("ul",{className:"key-steps-list",children:[t._sections&&t._sections.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("li",{className:"key-step-item",children:["Read through the ",e.jsx("strong",{children:t.title})," page, focusing on these sections:"]}),t._sections.slice(0,5).map((h,y)=>e.jsxs("li",{className:"key-step-item",children:["üìñ Work through the ",e.jsx("strong",{children:h})," section"]},y))]}):e.jsxs(e.Fragment,{children:[e.jsxs("li",{className:"key-step-item",children:["Understand how ",e.jsx("strong",{children:t.title})," works in UE5"]}),t._topics&&t._topics.length>0&&t._topics.slice(0,2).map((h,y)=>e.jsxs("li",{className:"key-step-item",children:["Pay attention to ",e.jsx("strong",{children:h.replace(/_/g," ")})," concepts and workflows"]},y)),t._subsystem&&e.jsxs("li",{className:"key-step-item",children:["Note how ",e.jsx("strong",{children:t._subsystem})," integrates with the editor"]})]}),e.jsx("li",{className:"key-step-item",children:"Try applying these techniques in your own UE5 project"})]})]}):null,t._chapters&&t._chapters.length>0&&e.jsxs("div",{className:"chapters-section",children:[e.jsx("h3",{className:"chapters-heading",children:"üìë Chapters"}),e.jsx("div",{className:"chapters-list",children:t._chapters.map((h,y)=>e.jsxs("a",{href:p?`https://www.youtube.com/watch?v=${p}&t=${h.seconds}`:"#",target:"_blank",rel:"noopener noreferrer",className:"chapter-item",children:[e.jsx("span",{className:"chapter-time",children:m(h.seconds)}),e.jsx("span",{className:"chapter-label",children:h.label})]},y))})]}),t._seeAlso&&t._seeAlso.length>0&&e.jsxs("div",{className:"see-also-section",children:[e.jsx("h3",{className:"see-also-heading",children:"üîó See Also"}),e.jsx("div",{className:"see-also-links",children:t._seeAlso.map((h,y)=>{const f=Je[h.docKey];return f?e.jsxs("a",{href:f.url,target:"_blank",rel:"noopener noreferrer",className:"see-also-link",title:f.description||h.label,children:["‚Üí ",h.label]},y):null})})]}),e.jsx("div",{className:"reading-step-source",children:e.jsxs("span",{className:"reading-step-source-label",children:["Source: ",n]})}),e.jsxs("a",{href:t._url,target:"_blank",rel:"noopener noreferrer",className:"reading-step-link",onClick:()=>a(!0),children:[t._resourceType==="doc"?"üìÑ Open Documentation":"‚ñ∂Ô∏è Watch on YouTube",e.jsx("span",{className:"reading-step-link-arrow",children:"‚Üó"})]}),e.jsxs("div",{className:"reading-step-actions",children:[e.jsx("button",{className:`reading-step-complete ${d?"ready":""}`,onClick:c,title:d?"Continue to next step":"Mark as read and continue",children:d?"‚úì Read ‚Äî Continue ‚Üí":"Mark as Read ‚Üí Continue"}),e.jsx("button",{className:"reading-step-exit",onClick:l,children:"‚úï Exit Path"})]})]})}_e.propTypes={course:g.object.isRequired,stepNumber:g.number.isRequired,totalSteps:g.number.isRequired,onComplete:g.func.isRequired,onExit:g.func.isRequired};function de(t){const s=Math.round(t/60);if(s<1)return"<1 min";if(s>=60){const i=Math.floor(s/60),c=s%60;return c>0?`${i}h ${c}m`:`${i}h`}return`${s} min`}const Ot={video:"üì∫",doc:"üìñ",youtube:"‚ñ∂Ô∏è"};function zt({cart:t,onRemove:s,onClear:i,onWatchPath:c}){const l=t.reduce((n,o)=>n+(o.duration||(o.readTimeMinutes||o.durationMinutes||0)*60),0),d=t.filter(n=>(n.type||"video")==="video").length,a=t.filter(n=>n.type==="doc").length,u=t.filter(n=>n.type==="youtube").length,r=[];return d>0&&r.push(`${d} video${d!==1?"s":""}`),a>0&&r.push(`${a} doc${a!==1?"s":""}`),u>0&&r.push(`${u} YT`),e.jsxs("div",{className:"cart-panel",children:[e.jsxs("div",{className:"cart-header",children:[e.jsx("h3",{className:"cart-title",children:"üõí My Learning Path"}),t.length>0&&e.jsx("button",{className:"cart-clear-btn",onClick:i,title:"Clear all",children:"Clear"})]}),t.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"cart-stats",children:[e.jsx("span",{className:"cart-stat-count",children:r.join(" ¬∑ ")}),e.jsx("span",{className:"cart-stat-dot",children:"¬∑"}),e.jsx("span",{className:"cart-stat-time",children:de(l)})]}),l>28800&&e.jsx("div",{className:"cart-warning",children:"‚ö†Ô∏è That's over 8 hours of content ‚Äî consider narrowing your focus to the most relevant items."}),e.jsx("div",{className:"cart-items",children:t.map((n,o)=>{const p=n.itemId||n.driveId||o,m=n.type||"video",h=Ot[m]||"üì∫",y=m==="video"?re(n.title):n.title,f=n.duration>0?de(n.duration):n.readTimeMinutes?`${n.readTimeMinutes} min read`:n.durationMinutes?`${n.durationMinutes} min`:null;return e.jsxs("div",{className:`cart-item cart-item-${m}`,children:[e.jsx("span",{className:"cart-item-num",children:o+1}),e.jsx("span",{className:"cart-item-icon",title:m,children:h}),e.jsxs("div",{className:"cart-item-info",children:[e.jsx("span",{className:"cart-item-title",children:y}),f&&e.jsx("span",{className:"cart-item-dur",children:f})]}),e.jsx("button",{className:"cart-item-remove",onClick:()=>s(p),"aria-label":`Remove ${n.title}`,children:"√ó"})]},p)})}),e.jsx("button",{className:"cart-watch-btn",onClick:c,children:"‚ñ∂ Watch Path"})]}):e.jsxs("div",{className:"cart-empty",children:[e.jsx("span",{className:"cart-empty-icon",children:"üì∫"}),e.jsx("p",{children:"Add videos, docs, and resources to build your learning path"})]})]})}zt.propTypes={cart:g.arrayOf(g.shape({itemId:g.string,driveId:g.string,type:g.oneOf(["video","doc","youtube"]),title:g.string.isRequired,duration:g.number,readTimeMinutes:g.number,durationMinutes:g.number})).isRequired,onRemove:g.func.isRequired,onClear:g.func.isRequired,onWatchPath:g.func.isRequired};const Ce={},Se={};(Xe.courses||[]).forEach(t=>{Ce[t.code]=t.title,Se[t.code]=t.versions||[]});function Vt(t){const s=Se[t];return!s||s.length===0?!1:s.every(i=>{const c=String(i).replace(/^V/i,"");return c.startsWith("4")&&!c.startsWith("4.")?/^4\d{1,2}$/.test(c):c.startsWith("4.")})}function Ft(t){if(!t||t<=0)return"";const s=Math.round(t/60);return s<1?"<1 min":`${s} min`}function Ut({video:t,isAdded:s,onToggle:i,userQuery:c}){const{title:l,duration:d,driveId:a,courseCode:u,_curatedMatch:r,role:n,reason:o,matchPercent:p}=t,m=p>=100?"best":p>=70?"strong":p>=40?"good":"related",h=p>=100?"Best Match":p>=70?"Strong Match":p>=40?"Good Match":"Related",y=l?.replace(/\s+(?:Part\s+[A-Z]|PT\s*\d+)$/i,"").trim()||l,f=u?pe[u]:null,N=f?.prereqs||[],[j,w]=v.useState(()=>tt(a)),[_,x]=v.useState(!1),b=v.useRef(null),C=v.useRef(null);v.useEffect(()=>{if(!_)return;const $=R=>{b.current&&!b.current.contains(R.target)&&x(!1)};return document.addEventListener("mousedown",$),()=>document.removeEventListener("mousedown",$)},[_]);const k=$=>{$.stopPropagation(),st(a,c||""),w("up")},T=$=>{$.stopPropagation(),nt(a,c||""),w("down")},E=a?`https://drive.google.com/thumbnail?id=${a}&sz=w320`:null;return e.jsx("div",{ref:C,className:`video-result-card ${s?"added":""} ${r?"curated":""} ${j==="down"?"demoted":""}`,role:"button",tabIndex:0,children:e.jsxs("div",{className:"vrc-compact",children:[e.jsxs("div",{className:"vrc-thumbnail",children:[E?e.jsx("img",{src:E,alt:y,onError:$=>{$.target.style.display="none",$.target.nextSibling.style.display="flex"}}):null,e.jsx("div",{className:"vrc-thumb-fallback",style:{display:E?"none":"flex"},children:e.jsx("span",{className:"vrc-play-icon",children:e.jsx(dt,{size:24})})}),d>0&&e.jsx("span",{className:"vrc-duration",children:Ft(d)})]}),e.jsxs("div",{className:"vrc-badge-row",children:[p!=null&&e.jsxs("span",{className:`vrc-match-badge vrc-match-${m}`,title:`${p}% match`,children:[e.jsx("span",{className:"vrc-match-dot"}),h]}),r&&e.jsx("span",{className:"vrc-curated-badge",children:"‚úì Solution"}),n&&n!=="core"&&e.jsxs("div",{className:"vrc-role-wrapper",ref:n==="prerequisite"?b:null,children:[e.jsxs("button",{className:`vrc-role-badge vrc-role-${n} ${n==="prerequisite"?"vrc-role-clickable":""}`,onClick:$=>{$.stopPropagation(),n==="prerequisite"&&x(R=>!R)},title:n==="prerequisite"?"Click to see why this is a prerequisite":void 0,children:[n==="prerequisite"&&"üîó Prerequisite",n==="troubleshooting"&&"üîß Troubleshooting",n==="supplemental"&&"üìö Supplemental"]}),_&&n==="prerequisite"&&e.jsxs("div",{className:"vrc-prereq-tooltip",children:[e.jsx("strong",{children:"Prerequisite Course"}),N.length>0?e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"Watch these first:"}),e.jsx("ul",{className:"vrc-prereq-list",children:N.map($=>e.jsxs("li",{children:["üìò ",Ce[$]||$,f?.reasons?.[$]&&e.jsxs("span",{className:"vrc-prereq-why",children:[" ‚Äî ",f.reasons[$]]})]},$))})]}):e.jsx("p",{children:"Watch this first ‚Äî it covers foundational concepts needed before advancing."}),o&&e.jsx("p",{className:"vrc-tip-reason",children:o})]})]}),u&&Vt(u)&&e.jsx("span",{className:"vrc-ue4-badge",title:"This content was created for Unreal Engine 4 ‚Äî some details may differ in UE5",children:"‚ö†Ô∏è UE4"})]}),e.jsx("div",{className:"vrc-info",children:e.jsx("h4",{className:"vrc-title",children:y})}),e.jsxs("div",{className:"vrc-actions",children:[e.jsxs("div",{className:"vrc-feedback",children:[e.jsx("button",{className:`vrc-fb-btn ${j==="up"?"active-up":""}`,onClick:k,"aria-label":"Helpful",title:"This was helpful",children:e.jsx("span",{className:"vrc-fb-emoji",children:"üëç"})}),e.jsx("button",{className:`vrc-fb-btn ${j==="down"?"active-down":""}`,onClick:T,"aria-label":"Not helpful",title:"Not relevant",children:e.jsx("span",{className:"vrc-fb-emoji",children:"üëé"})})]}),e.jsx("button",{className:`vrc-add-btn ${s?"vrc-added":""}`,onClick:$=>{$.stopPropagation(),i(t)},"aria-label":s?"Remove from playlist":"Add to playlist",children:s?e.jsxs(e.Fragment,{children:[e.jsx(se,{size:14})," Added"]}):e.jsxs(e.Fragment,{children:[e.jsx(rt,{size:14})," Add"]})})]})]})})}Ut.propTypes={video:g.shape({driveId:g.string,title:g.string.isRequired,courseName:g.string,duration:g.number,matchedTags:g.arrayOf(g.string),courseCode:g.string,topSegments:g.array,docLinks:g.array,_curatedMatch:g.bool,role:g.oneOf(["prerequisite","core","troubleshooting","supplemental"]),reason:g.string,estimatedMinutes:g.number}).isRequired,isAdded:g.bool,onToggle:g.func.isRequired,userQuery:g.string};const Te="ue5_video_cart";function Wt(){try{const t=localStorage.getItem(Te);return t?JSON.parse(t):[]}catch{return[]}}function Q(t){try{localStorage.setItem(Te,JSON.stringify(t))}catch{}}function V(t){return t.itemId||t.driveId||t.id||`${t.type}_${t.url}`}function gs(){const[t,s]=v.useState(Wt),i=v.useCallback(n=>{s(o=>{const p=V(n);if(o.some(y=>V(y)===p))return o;const m={...n,itemId:p,type:n.type||"video"},h=[...o,m];return Q(h),h})},[]),c=v.useCallback(n=>{s(o=>{const p=o.filter(m=>V(m)!==n&&m.driveId!==n);return Q(p),p})},[]),l=v.useCallback(()=>{s([]),Q([])},[]),d=v.useCallback(n=>t.some(o=>V(o)===n||o.driveId===n),[t]),a=t.filter(n=>(n.type||"video")==="video").length,u=v.useMemo(()=>t.reduce((n,o)=>n+(o.duration||(o.readTimeMinutes||o.durationMinutes||0)*60),0),[t]),r=v.useMemo(()=>{const n={video:[],doc:[],youtube:[]};for(const o of t){const p=o.type||"video";(n[p]||n.video).push(o)}return n},[t]);return{cart:t,addToCart:i,removeFromCart:c,clearCart:l,isInCart:d,videoCount:a,totalDuration:u,itemsByType:r}}let H=null;async function Gt(){if(!H){const t=await q(()=>import("./data-embeddings-EsTyY_EC.js"),[]);H=t.default||t}return H}function ae(t,s){if(!t||!s||t.length!==s.length)return 0;let i=0,c=0,l=0;for(let a=0;a<t.length;a++)i+=t[a]*s[a],c+=t[a]*t[a],l+=s[a]*s[a];const d=Math.sqrt(c)*Math.sqrt(l);return d===0?0:i/d}async function xs(t,s=5,i=.3){const c=await Gt();if(!t||!c?.courses)return[];const l=[];for(const[d,a]of Object.entries(c.courses)){const u=ae(t,a.embedding);u>=i&&l.push({code:d,title:a.title,similarity:u})}return l.sort((d,a)=>a.similarity-d.similarity),l.slice(0,s)}let J=null,P=null;function Yt(t,s=768){const i=atob(t),c=new Uint8Array(i.length);for(let a=0;a<i.length;a++)c[a]=i.charCodeAt(a);const l=new DataView(c.buffer),d=new Float32Array(s);for(let a=0;a<s;a++){const u=l.getUint16(a*2,!0);d[a]=Kt(u)}return d}function Kt(t){const s=t>>15&1,i=t>>10&31,c=t&1023;return i===0?(s?-1:1)*Math.pow(2,-14)*(c/1024):i===31?c?NaN:s?-1/0:1/0:(s?-1:1)*Math.pow(2,i-15)*(1+c/1024)}async function Zt(){if(P)return P;if(!J)try{const s=await fetch(new URL("../data/docs_embeddings.json",import.meta.url));if(!s.ok)throw new Error(`HTTP ${s.status}`);J=await s.json()}catch(s){return O("‚ö†Ô∏è docs_embeddings.json not available:",s.message),null}const t=J?.docs;if(!t)return null;P=new Map;for(const[s,i]of Object.entries(t)){let c;if(typeof i.embedding=="string")c=Yt(i.embedding);else if(Array.isArray(i.embedding))c=new Float32Array(i.embedding);else{O(`[DocsSearch] Skipping doc ${s}: unknown embedding format (${typeof i.embedding})`);continue}P.set(s,{vector:c,slug:i.slug,url:i.url,title:i.title,section:i.section,text:i.text,tokenEstimate:i.token_estimate})}return me(`[DocsSearch] Decoded ${P.size} doc embeddings`),P}async function ys(t,s=5,i=.35){if(!t)return[];const c=await Zt();if(!c)return[];const l=[];for(const[d,a]of c){const u=ae(t,a.vector);u>=i&&l.push({id:d,slug:a.slug,url:a.url,title:a.title,section:a.section,previewText:a.text,similarity:u,source:"epic_docs"})}return l.sort((d,a)=>a.similarity-d.similarity),l.slice(0,s)}let F=null;async function $e(){if(F)return F;try{const t=await q(()=>import("./data-courses-CecwKQwF.js").then(s=>s.m),[]);return F=t.default||t,F}catch(t){return O("‚ö†Ô∏è doc_links.json not available:",t.message),{}}}const U={beginner:0,intermediate:1,advanced:2};function ue(t){return t.replace(/ies$/i,"y").replace(/ves$/i,"f").replace(/(es|s|ing|ed|tion|ment)$/i,"").toLowerCase()}function W(t,s){const i=t.split(/[\s_-]+/).filter(l=>l.length>2).map(ue),c=s.split(/[\s_-]+/).filter(l=>l.length>2).map(ue);return i.some(l=>c.some(d=>l===d||l.includes(d)||d.includes(l)))}async function Le(t,{maxTier:s="advanced",limit:i=10}={}){const c=await $e();if(!c||!t?.length)return[];const l=U[s]??2,d=t.map(n=>n.toLowerCase()),a=[];for(const[n,o]of Object.entries(c)){if((U[o.tier]??1)>l)continue;let m=0;const h=n.toLowerCase(),y=(o.label||"").toLowerCase(),f=(o.url||"").split("/").pop().replace(/-/g," ").toLowerCase(),N=(o.tags||[]).map(_=>_.toLowerCase()),j=(o.description||"").toLowerCase();let w=0;for(const _ of d){let x=!1;h===_?(m+=15,x=!0):h.includes(_)?(m+=8,x=!0):_.includes(h)?(m+=6,x=!0):o.subsystem===_?(m+=5,x=!0):y.includes(_)?(m+=6,x=!0):N.includes(_)?(m+=2,x=!0):N.some(b=>b.includes(_)||_.includes(b))?(m+=1,x=!0):f.includes(_)?(m+=2,x=!0):j.includes(_)?(m+=1,x=!0):W(_,h)?(m+=4,x=!0):W(_,y)?(m+=3,x=!0):(N.some(b=>W(_,b))||W(_,j))&&(m+=1,x=!0),x&&w++}w>=2&&(m+=w*5),m>=3&&a.push({key:n,label:o.label,description:o.description||"",url:o.url,tier:o.tier,subsystem:o.subsystem,readTimeMinutes:o.readTimeMinutes||10,prerequisites:o.prerequisites||[],sections:o.sections||[],keySteps:o.keySteps||[],seeAlso:o.seeAlso||[],_score:m,source:"epic_docs"})}a.sort((n,o)=>o._score!==n._score?o._score-n._score:(U[n.tier]??1)-(U[o.tier]??1));const u=[];for(const n of a){const o=new Set(n.key.split(/[-_]+/).filter(m=>m.length>2));u.some(m=>{const h=new Set(m.key.split(/[-_]+/).filter(f=>f.length>2));return[...o].filter(f=>h.has(f)).length/Math.min(o.size,h.size)>.6})||u.push(n)}const r=u.length>0?u[0]._score:1;return u.slice(0,i).map(({_score:n,...o})=>({...o,_rawScore:n,matchScore:Math.round(n/Math.max(r,1)*100)}))}async function Bt(t,{limit:s=8}={}){const i=await $e();if(!i)return[];const c=await Le(t,{limit:s*2});if(!c.length)return[];const l=new Map(c.map(n=>[n.key,n.matchScore??0])),d=new Map(c.map(n=>[n.key,n._rawScore??0])),a=new Set,u=[];function r(n){if(a.has(n))return;a.add(n);const o=i[n];if(o){for(const p of o.prerequisites||[])r(p);u.push({key:n,label:o.label,description:o.description||"",keySteps:o.keySteps||[],seeAlso:o.seeAlso||[],url:o.url,tier:o.tier,subsystem:o.subsystem,readTimeMinutes:o.readTimeMinutes||10,matchScore:l.get(n)??0,_rawScore:d.get(n)??0,source:"epic_docs"})}}for(const n of c)r(n.key);return u.sort((n,o)=>(o._rawScore??0)-(n._rawScore??0)),u.slice(0,s)}let M=null;async function Ie(){if(M!=null)return M;try{const t=await q(()=>import("./data-courses-CecwKQwF.js").then(s=>s.y),[]);return M=t.default||t,M}catch{return M={channels:{},resources:[]},M}}const G={beginner:0,intermediate:1,advanced:2};async function Ee(t,{maxTier:s="advanced",limit:i=5}={}){if(!t?.length)return[];const c=await Ie();if(!c?.resources?.length)return[];const l=G[s]??2,d=new Set(t.map(r=>r.toLowerCase())),a=[];for(const r of c.resources){if((G[r.tier]??1)>l)continue;const o=(r.topics||[]).map(h=>h.toLowerCase()),p=(r.tag_ids||[]).map(h=>h.toLowerCase());let m=0;for(const h of o){d.has(h)&&(m+=5);for(const y of d)(h.includes(y)||y.includes(h))&&(m+=2)}for(const h of p){d.has(h)&&(m+=5);const y=h.split(".");for(const f of y)d.has(f)&&(m+=3)}if(m>0){const h=c.channels?.[r.channelKey];a.push({id:r.id,title:r.title,url:r.url,channelName:h?.name||"Unreal Engine",channelTrust:"official",tier:r.tier,durationMinutes:r.durationMinutes,topics:r.topics,tag_ids:r.tag_ids||[],description:r.description||"",keyTakeaways:r.keyTakeaways||[],chapters:r.chapters||[],source:"epic_youtube",_score:m})}}const u=/\b(ue\s*5|unreal\s*engine\s*5|5\.\d)/i;for(const r of a)r._isUE5=u.test(r.title)||(r.topics||[]).some(n=>u.test(n));return a.sort((r,n)=>r._isUE5!==n._isUE5?r._isUE5?-1:1:n._score!==r._score?n._score-r._score:(G[r.tier]??1)-(G[n.tier]??1)),a.slice(0,i).map(({_score:r,_isUE5:n,...o})=>o)}async function Qt(t,{limit:s=5}={}){if(!t?.length)return[];const i=await Ie();if(!i?.resources?.length)return[];const c=new Set(t.map(d=>d.toLowerCase())),l=[];for(const d of i.resources){const a=(d.tag_ids||[]).map(r=>r.toLowerCase());let u=0;for(const r of a)c.has(r)&&(u+=5);if(u>0){const r=i.channels?.[d.channelKey];l.push({id:d.id,title:d.title,url:d.url,channelName:r?.name||"Unreal Engine",channelTrust:"official",tier:d.tier,durationMinutes:d.durationMinutes,topics:d.topics,tag_ids:d.tag_ids||[],description:d.description||"",keyTakeaways:d.keyTakeaways||[],chapters:d.chapters||[],source:"epic_youtube",_score:u})}}return l.sort((d,a)=>a._score-d._score),l.slice(0,s).map(({_score:d,...a})=>a)}async function Ht(t,s=[]){if(!t?.length)return{topics:[],firstPartyVideos:0,docsArticles:0,youtubeResources:0,coverageScore:0,gaps:[]};const i=await Le(t,{limit:10}),c=await Ee(t,{limit:10}),l={};for(const r of t){const n=r.toLowerCase(),o=s.filter(y=>{const f=(y.tags||[]).map(j=>j.toLowerCase()),N=(y.title||"").toLowerCase();return f.some(j=>j.includes(n))||N.includes(n)}).length,p=i.filter(y=>y.key?.toLowerCase().includes(n)||y.subsystem?.toLowerCase()===n||y.label?.toLowerCase().includes(n)).length,m=c.filter(y=>{const f=(y.topics||[]).some(j=>j.toLowerCase().includes(n)),N=(y.tag_ids||[]).some(j=>j.toLowerCase().includes(n));return f||N}).length,h=o+p+m;l[r]={firstPartyVideos:o,docsArticles:p,youtubeResources:m,total:h,covered:h>0}}const d=Object.values(l).filter(r=>r.covered).length,a=t.length>0?d/t.length:0,u=Object.entries(l).filter(([,r])=>!r.covered).map(([r])=>r);return{topics:t,topicCoverage:l,firstPartyVideos:s.length,docsArticles:i.length,youtubeResources:c.length,coverageScore:a,gaps:u}}async function js(t,s=[],{maxDocs:i=5,maxYoutube:c=3}={}){if(!t?.length)return{docs:[],youtube:[],totalTimeMinutes:0,coverageScore:0};let l=[];try{l=await Bt(t,{limit:i})}catch(o){console.warn("[Blended] Search failed for docs:",o.message)}let d=[];try{const o=await Ee(t,{limit:c}),p=await Qt(t,{limit:c}),m=new Set(o.map(h=>h.id));d=[...o];for(const h of p)m.has(h.id)||(d.push(h),m.add(h.id))}catch(o){console.warn("[Blended] Search failed for youtube:",o.message)}const a=s.reduce((o,p)=>o+(p.durationMinutes||10),0),u=l.reduce((o,p)=>o+(p.readTimeMinutes||10),0),r=d.reduce((o,p)=>o+(p.durationMinutes||15),0);let n={coverageScore:0,gaps:[]};try{n=await Ht(t,s)}catch(o){console.warn("[Blended] Coverage analysis failed:",o.message)}return{docs:l,youtube:d,totalTimeMinutes:a+u+r,coverageScore:n.coverageScore,gaps:n.gaps,externalEnabled:!0}}let X=null,ee=null;async function Jt(){if(!X){const t=await q(()=>import("./data-search-SjqZFhcO.js").then(s=>s.s),[]);X=t.default||t}return X}async function Xt(){if(!ee){const t=await q(()=>import("./data-search-SjqZFhcO.js").then(s=>s.a),[]);ee=t.default||t}return ee}let te=null,A=null;function es(t,s=768){const i=atob(t),c=new Uint8Array(i.length);for(let a=0;a<i.length;a++)c[a]=i.charCodeAt(a);const l=new DataView(c.buffer),d=new Float32Array(s);for(let a=0;a<s;a++){const u=l.getUint16(a*2,!0);d[a]=ts(u)}return d}function ts(t){const s=t>>15&1,i=t>>10&31,c=t&1023;return i===0?(s?-1:1)*Math.pow(2,-14)*(c/1024):i===31?c?NaN:s?-1/0:1/0:(s?-1:1)*Math.pow(2,i-15)*(1+c/1024)}async function ss(){if(A)return A;if(!te)try{const s=await fetch(new URL("../data/segment_embeddings.json",import.meta.url));if(!s.ok)throw new Error(`HTTP ${s.status}`);te=await s.json()}catch(s){return O("‚ö†Ô∏è segment_embeddings.json not available:",s.message),null}const t=te?.segments;if(!t)return null;A=new Map;for(const[s,i]of Object.entries(t))A.set(s,{vector:es(i.embedding),courseCode:i.course_code,videoKey:i.video_key,videoTitle:i.video_title,startTimestamp:i.start_timestamp,endTimestamp:i.end_timestamp,startSeconds:i.start_seconds,text:i.text,tokenEstimate:i.token_estimate});return me(`[SegmentSearch] Decoded ${A.size} segment embeddings`),A}async function ns(t,s=[]){if(!t||t.length<3)return[];const i=t.toLowerCase().split(/\s+/).filter(a=>a.length>2&&!Ne.has(a));if(i.length===0)return[];const c=await Jt(),l=[],d=c?.course_words||{};for(const[a,u]of Object.entries(d)){let r=0;const n=[];for(const o of i)if(u[o]&&(r+=u[o]*10,n.push(o)),o.length>=4)for(const[p,m]of Object.entries(u))p!==o&&p.length>=4&&(p.startsWith(o)||o.startsWith(p))&&(r+=m*3,n.includes(p)||n.push(p));if(r>=30&&n.length>0){const o=s.find(m=>m.code===a),p=await is(a,n);l.push({courseCode:a,courseTitle:o?.title||a,score:r,matchedKeywords:n,topSegments:p,estimatedSegment:p.length>0?p[0]:null,videoCount:o?.video_count||0,duration:o?.duration_formatted||"Unknown"})}}return l.sort((a,u)=>u.score-a.score).slice(0,5)}async function is(t,s){const c=(await Xt())[t];if(!c||!c.videos)return[];const l=[];for(const[d,a]of Object.entries(c.videos))if(a.segments)for(const u of a.segments){const r=u.text.toLowerCase();let n=0;const o=[];for(const p of s){const m=p.toLowerCase(),h=new RegExp(m.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi"),y=r.match(h);y&&(n+=y.length*10,o.push(p)),r.includes(m)&&(n+=5,o.includes(p)||o.push(p))}if(n>0){let p=u.text;if(p.length>120){const m=o[0]||"",h=p.toLowerCase().indexOf(m.toLowerCase());h>40&&(p="..."+p.substring(h-30)),p.length>120&&(p=p.substring(0,117)+"...")}l.push({videoKey:d,videoTitle:a.title,timestamp:u.start,startSeconds:u.start_seconds,endTimestamp:u.end,previewText:p,matchedKeywords:o,score:n})}}return l.sort((d,a)=>a.score-d.score).slice(0,3)}async function rs(t,s=10,i=.35){if(!t)return[];const c=await ss();if(!c)return[];const l=[];for(const[a,u]of c){const r=ae(t,u.vector);r>=i&&l.push({id:a,courseCode:u.courseCode,videoKey:u.videoKey,videoTitle:u.videoTitle,timestamp:u.startTimestamp,endTimestamp:u.endTimestamp,startSeconds:u.startSeconds,previewText:u.text,similarity:r,source:"transcript"})}l.sort((a,u)=>u.similarity-a.similarity);const d=l.slice(0,s);if(d.length>0){const a=new Map;for(const[u,r]of c){const n=`${r.courseCode}:${r.videoKey}`;a.has(n)||a.set(n,[]),a.get(n).push({id:u,text:r.text,startSeconds:r.startSeconds})}for(const u of a.values())u.sort((r,n)=>r.startSeconds-n.startSeconds);for(const u of d){const r=`${u.courseCode}:${u.videoKey}`,n=a.get(r);if(!n)continue;const o=n.findIndex(h=>h.id===u.id);if(o===-1)continue;let p="";if(o>0){const y=(n[o-1].text||"").split(/[.!?]+\s*/);p=y[y.length-1]?.trim()||""}let m="";if(o<n.length-1&&(m=(n[o+1].text||"").split(/[.!?]+\s*/)[0]?.trim()||""),p||m){const h=[];p&&h.push("..."+p),h.push(u.previewText),m&&h.push(m+"..."),u.previewText=h.join(" ")}}}return d}async function vs(t,s,i=[],c=8){const l=await ns(t,i);let d=[];s&&(d=await rs(s,c,.35));const a=new Set,u=[];for(const r of d){const n=`${r.courseCode}:${r.videoKey}:${r.timestamp}`;a.has(n)||(a.add(n),u.push({...r,searchType:"semantic",score:Math.round(r.similarity*100)}))}for(const r of l)for(const n of r.topSegments||[]){const o=`${r.courseCode}:${n.videoKey}:${n.timestamp}`;a.has(o)||(a.add(o),u.push({id:`kw_${r.courseCode}_${n.videoKey}`,courseCode:r.courseCode,videoKey:n.videoKey,videoTitle:n.videoTitle,timestamp:n.timestamp,startSeconds:n.startSeconds,previewText:n.previewText,similarity:0,score:n.score,searchType:"keyword",source:"transcript"}))}return u.slice(0,c)}export{Y as A,ct as B,zt as C,ke as G,Ne as S,Ut as V,js as a,fs as b,ns as c,re as d,ys as e,xs as f,Xt as g,vs as s,gs as u};
