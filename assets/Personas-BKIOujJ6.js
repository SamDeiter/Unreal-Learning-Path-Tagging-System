import{g as ge,a as xe,j as e}from"./index-CnaH99_u.js";import{a as z}from"./vendor-cytoscape-hdah7_Xt.js";import{p as be}from"./data-courses-VQusrsMX.js";import{s as ke,B as je,A as ee,G as Ne,b as se}from"./segmentSearchService-BCVsYub1.js";import{n as he,m as ye}from"./vendor-firebase-DNc0QRT5.js";import{d as E,a as te}from"./logger-CDyjTpW_.js";import{c as f}from"./createLucideIcon-YhyuTmrv.js";import{a as _e,S as ae,C as Ce}from"./sparkles-BiYYl4ru.js";import{C as Ae}from"./check-eCXpKYRG.js";import{M as ze}from"./message-square-B9rM_FIo.js";import"./feedbackService-D2dYsKFk.js";import"./x-HbUnH9yy.js";const Se=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Me=f("arrow-left",Se);const Te=[["path",{d:"M17 10c.7-.7 1.69 0 2.5 0a2.5 2.5 0 1 0 0-5 .5.5 0 0 1-.5-.5 2.5 2.5 0 1 0-5 0c0 .81.7 1.8 0 2.5l-7 7c-.7.7-1.69 0-2.5 0a2.5 2.5 0 0 0 0 5c.28 0 .5.22.5.5a2.5 2.5 0 1 0 5 0c0-.81-.7-1.8 0-2.5Z",key:"w610uw"}]],Le=f("bone",Te);const Pe=[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V9",key:"uvy0l4"}],["path",{d:"M19 21V3",key:"11j9sm"}]],Ie=f("chart-no-axes-column-increasing",Pe);const Re=[["path",{d:"m18 16 4-4-4-4",key:"1inbqp"}],["path",{d:"m6 8-4 4 4 4",key:"15zrgr"}],["path",{d:"m14.5 4-5 16",key:"e7oirm"}]],qe=f("code-xml",Re);const Ge=[["path",{d:"M2.7 10.3a2.41 2.41 0 0 0 0 3.41l7.59 7.59a2.41 2.41 0 0 0 3.41 0l7.59-7.59a2.41 2.41 0 0 0 0-3.41l-7.59-7.59a2.41 2.41 0 0 0-3.41 0Z",key:"1f1r0c"}]],$e=f("diamond",Ge);const Ee=[["line",{x1:"6",x2:"10",y1:"11",y2:"11",key:"1gktln"}],["line",{x1:"8",x2:"8",y1:"9",y2:"13",key:"qnk9ow"}],["line",{x1:"15",x2:"15.01",y1:"12",y2:"12",key:"krot7o"}],["line",{x1:"18",x2:"18.01",y1:"10",y2:"10",key:"1lcuu1"}],["path",{d:"M17.32 5H6.68a4 4 0 0 0-3.978 3.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 0 0 3 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 0 1 9.828 16h4.344a2 2 0 0 1 1.414.586L17 18c.5.5 1 1 2 1a3 3 0 0 0 3-3c0-1.545-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0 0 17.32 5z",key:"mfqc10"}]],Oe=f("gamepad-2",Ee);const Ke=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],De=f("loader",Ke);const He=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],We=f("map",He);const Be=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],Fe=f("palette",Be);const Ue=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],Qe=f("play",Ue);const Ve=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],re=f("refresh-cw",Ve);const Ze=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],oe=f("rocket",Ze);const Ye=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Je=f("target",Ye);const Xe=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],fe=f("trophy",Xe);const et=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],tt=f("wand-sparkles",et);const at=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]],it=f("wrench",at);const nt=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],st=f("zap",nt);function rt(m){return be.personas.find(g=>g.id===m)||null}function le(m){return m?Array.isArray(m.onboardingMessaging)&&m.onboardingMessaging.length>0?m.onboardingMessaging:{gamedev_gary:["ðŸŽ® Industry-standard for AAA and indie games","âš¡ Blueprint visual scripting - no C++ required to start","ðŸŒ Deploy to PC, console, and mobile"]}[m.id]||[]:[]}const ot={indie_isaac:{boostKeywords:["blueprint","gameplay","prototype","interaction","UI","UMG","save game","inventory","input","level design","your first","getting started","project","widget","player controller"],penaltyKeywords:["deep C++","networking","multiplayer","dedicated server","mass production","automotive","archviz"],requiredTopics:["viewport","blueprint","lighting","packaging"]},logic_liam:{boostKeywords:["C++","architecture","systems","framework","subsystem","profiling","optimization","GAS","gameplay ability","replication","networking","debugging","performance","memory","API","programming"],penaltyKeywords:["marketing","brand","product viz","archviz","automotive","configurator"],requiredTopics:["blueprint","C++","profiling"]},animator_alex:{boostKeywords:["animation","sequencer","cinematic","character","mocap","keyframe","motion","camera","performance","acting","lighting","storytelling","retarget"],penaltyKeywords:["networking","multiplayer","dedicated server","automotive","archviz","digital twin","manufacturing"],requiredTopics:["animation","sequencer","lighting"]},rigger_regina:{boostKeywords:["control rig","IK","FK","constraint","deformation","skinning","retarget","skeleton","bone","joint","weight","character","rig","animation"],penaltyKeywords:["networking","multiplayer","automotive","archviz","marketing","brand","digital twin"],requiredTopics:["animation","control rig","character"]},designer_cpg:{boostKeywords:["lighting","materials","lookdev","product viz","motion design","camera","presentation","rendering","photorealistic","studio","environment","scene","visualization"],penaltyKeywords:["deep C++","networking","multiplayer","dedicated server","GAS","gameplay ability","digital twin"],requiredTopics:["lighting","materials","camera"]},architect_amy:{boostKeywords:["archviz","architectural","interior","building","walkthrough","visualization","real estate","photorealistic","twinmotion"],penaltyKeywords:["multiplayer","gameplay","automotive","manufacturing"],requiredTopics:["lighting","materials"]},simulation_sam:{boostKeywords:["simulation","digital twin","training","enterprise","industrial","defense","manufacturing","factory"],penaltyKeywords:["archviz","automotive","gameplay","indie"],requiredTopics:["blueprint","simulation"]},vfx_victor:{boostKeywords:["vfx","effects","compositing","particles","niagara","explosion","destruction","smoke","fire","post-process"],penaltyKeywords:["archviz","automotive","manufacturing","digital twin"],requiredTopics:["niagara","effects"]},automotive_andy:{boostKeywords:["automotive","vehicle","car","configurator","showroom","paint","headlight","wheel","dashboard","lighting studio"],penaltyKeywords:["archviz","gameplay","digital twin","multiplayer"],requiredTopics:["materials","lighting"]}};async function ie(m){try{const g=ge(),S=he(g);await ye(S,"logTelemetry")({type:"onboarding_rag",...m}),E("[OnboardingTelemetry] Logged:",m.outcome,m)}catch(g){te("[OnboardingTelemetry] Failed to log:",g.message)}}const X="idle",ce="planning",de="searching",ue="assembling",pe="done",me="error";function lt(){const[m,g]=z.useState(X),[S,l]=z.useState(null),[O,k]=z.useState(null),K=z.useCallback(async D=>{g(ce),l(null),k(null);const j=ge(),V=he(j),w=ye(V,"queryLearningPath"),H=Date.now();try{E("[OnboardingRAG] Step 1 â€” Calling Planner CF...");const W=(await w({persona:D,mode:"onboarding",onboardingStep:"plan"})).data;if(!W?.success)throw new Error(W?.error||"Planner failed");const{searchQueries:B=[],archetype:F="unknown"}=W;E("[OnboardingRAG] Planner returned:",{searchQueries:B,archetype:F}),g(de),E("[OnboardingRAG] Step 2 â€” Running local segment search...");let N=[];for(const R of B.slice(0,5))try{const Z=(await ke(R,null,[],4)).map(y=>({videoTitle:y.videoTitle||y.courseTitle||"Unknown",courseCode:y.courseCode||"unknown",videoId:y.videoKey||y.videoId||"",timestamp:y.timestamp||"0:00",text:y.topSegments?.[0]?.preview||y.text||""}));N.push(...Z)}catch(q){te(`[OnboardingRAG] Search failed for "${R}":`,q.message)}const L=new Set;N=N.filter(R=>{const q=`${R.courseCode}::${R.videoId}`;return L.has(q)?!1:(L.add(q),!0)}),E(`[OnboardingRAG] Retrieved ${N.length} unique passages`),g(ue),E("[OnboardingRAG] Step 3 â€” Calling Assembler CF...");const P=(await w({persona:D,mode:"onboarding",onboardingStep:"assemble",archetype:F,passages:N.slice(0,15)})).data;if(!P?.success)throw new Error(P?.error||"Assembler failed");return E("[OnboardingRAG] Curriculum ready:",P.curriculum?.title),ie({outcome:"rag_success",archetype:F,passagesFound:N.length,modulesReturned:(P.curriculum?.modules||[]).length,searchQueries:B.length,pipelineDurationMs:Date.now()-H}),l({...P,passages:N}),g(pe),{...P,passages:N}}catch(o){return te("[OnboardingRAG] Pipeline error:",o.message),ie({outcome:"rag_fallback",errorMessage:o.message||"Unknown error",pipelineDurationMs:Date.now()-H}),k(o.message||"Something went wrong"),g(me),null}},[]),Q=z.useCallback(()=>{g(X),l(null),k(null)},[]);return{generateRAGPath:K,resetRAG:Q,ragState:m,ragResult:S,ragError:O,RAG_STATES:{IDLE:X,PLANNING:ce,SEARCHING:de,ASSEMBLING:ue,DONE:pe,ERROR:me}}}const A=[{id:"startPrompt",question:"What do you want to learn in UE5?",subtitle:"Describe in your own words (optional â€” helps personalize your path)",type:"freetext",placeholder:"e.g. I want to make a small RPG with inventory and combat..."},{id:"role",question:"Which best describes your role?",subtitle:"This determines your learning persona",type:"choice",options:[{value:"indie_isaac",label:"Indie Game Dev",description:"Solo/small-team â€” prototype fast, ship it",icon:Oe},{value:"logic_liam",label:"Games Programmer",description:"Architecture, systems, performance",icon:qe},{value:"animator_alex",label:"Animator / Film Artist",description:"Cinematics, sequencer, real-time previews",icon:_e},{value:"rigger_regina",label:"Rigger / Character TD",description:"Control Rig, deformation, retargeting",icon:Le},{value:"designer_cpg",label:"Designer (Retail/CPG)",description:"Product viz, lighting, stunning visuals",icon:$e}]},{id:"experience",question:"How many years of 3D / game engine experience do you have?",type:"choice",options:[{value:"beginner",label:"0â€“1 years",description:"Brand new to 3D or engines",icon:ae},{value:"junior",label:"2â€“5 years",description:"Used Maya, Blender, or another engine",icon:Fe},{value:"mid",label:"5â€“10 years",description:"Professional with shipped work",icon:tt},{value:"senior",label:"10+ years",description:"Senior / lead level",icon:it}]},{id:"goal",question:"What do you want to achieve in your first 10 hours?",type:"choice",options:[{value:"explore",label:"Explore and understand UE5",icon:We},{value:"project",label:"Start a specific project",icon:Je},{value:"skill",label:"Learn a specific skill",icon:je},{value:"portfolio",label:"Build a portfolio piece",icon:fe},{value:"transition",label:"Transition from another tool",icon:ee}]}];function bt(){const{courses:m}=xe(),[g,S]=z.useState(0),[l,O]=z.useState({startPrompt:"",role:null,experience:null,goal:null}),[k,K]=z.useState(null),{generateRAGPath:Q,resetRAG:D,ragState:j,ragError:V,RAG_STATES:w}=lt(),H=[w.PLANNING,w.SEARCHING,w.ASSEMBLING].includes(j),o=z.useMemo(()=>l.role?rt(l.role):null,[l.role]),W=()=>{const a=A[1].options.find(v=>v.value===l.role),h=A[2].options.find(v=>v.value===l.experience),u=A[3].options.find(v=>v.value===l.goal);return[l.startPrompt?`Goal: ${l.startPrompt}.`:"",`Role: ${a?.label||l.role}.`,`Experience: ${h?.label||l.experience}.`,`Objective: ${u?.label||l.goal}.`].filter(Boolean).join(" ")},B=async()=>{o&&localStorage.setItem("detected_persona",JSON.stringify(o));const a=W(),h=o?`${o.name} â€” ${o.industry}`:"General",u=await Q(a,h);if(u?.curriculum?.modules?.length>0){const _=u.passages||[],v={};_.forEach(t=>{t.videoTitle&&(v[t.videoTitle.toLowerCase()]=t),t.videoId&&(v[t.videoId.toLowerCase()]=t)});const M=t=>{if(!m||!t)return null;const s=t.toLowerCase();return m.find(c=>c.videos?.some(i=>{const r=(i.title||i.name||"").toLowerCase();return r===s||r.includes(s)||s.includes(r)}))},Y=(t,s)=>{const c=new Set(["the","and","for","are","with","from","this","that","your","into","how","can","will","has","was","been","have","what","when","not","unreal","engine","ue5","learn","using","about","getting","started","introduction","overview","course","module","lesson","video"]),i=(t||"").toLowerCase().split(/[\s\-_/()]+/).filter(p=>p.length>2&&!c.has(p)),r=(s||"").toLowerCase().split(/[\s\-_/()]+/).filter(p=>p.length>2&&!c.has(p));if(i.length===0||r.length===0)return 0;let d=0;for(const p of i)for(const b of r){if(p===b){d++;break}if(p.length>4&&b.length>4&&(p.includes(b)||b.includes(p))){d+=.5;break}}return d/Math.max(i.length,r.length)},I=new Set,G=(u.curriculum.modules||[]).map(t=>{let s=null;if(t.videoId&&m&&(s=m.find(i=>!I.has(i.title)&&i.videos?.some(r=>r.drive_id&&(r.title===t.videoId||r.name===t.videoId||r.drive_id===t.videoId)))),!s){const i=(t.videoId||"").toLowerCase(),r=v[i];r?.videoTitle&&(s=M(r.videoTitle),s&&I.has(s.title)&&(s=null))}if(!s&&m){let i=0,r=null;for(const d of _){if(!d.videoTitle)continue;const p=M(d.videoTitle);if(!p||I.has(p.title))continue;const b=Y(t.title+" "+(t.description||""),d.videoTitle);b>i&&b>=.15&&(i=b,r=p)}s=r}if(!s&&m){let i=0,r=null;for(const d of m){if(I.has(d.title)||!d.videos?.length||!d.videos[0]?.drive_id)continue;const p=Y(t.title+" "+(t.description||""),d.title||d.name||"");p>i&&p>=.15&&(i=p,r=d)}s=r}return s&&I.add(s.title),s?{...s,ragTitle:t.title,ragDescription:t.description,enriched:!0}:{title:t.title,name:t.title,description:t.description,code:`rag-${t.title.replace(/\s+/g,"-").toLowerCase().slice(0,30)}`,videos:[],enriched:!1}}),x=G.filter(t=>t.enriched&&t.videos?.length>0&&t.videos[0]?.drive_id),U={indie_isaac:"games",logic_liam:"games",animator_alex:"animation",rigger_regina:"animation",designer_cpg:"visualization",architect_amy:"architecture",simulation_sam:"simulation",vfx_victor:"vfx",automotive_andy:"automotive"}[o?.id]||"general",n=x.filter(t=>{const s=(t.tags?.industry||"general").toLowerCase(),c=(t.title||t.name||"").toLowerCase();if(s!=="general"&&s!==U)return!1;const i=[{match:["automotive","vehicle design","configurator","car paint","vred"],allow:["automotive"]},{match:["archviz","architectural","twinmotion","for architecture","aeco"],allow:["architecture","visualization"]},{match:["legacy production","virtual production","broadcast","icvfx","ndisplay"],allow:["animation","vfx","film","media"]}];for(const r of i)if(r.match.some(d=>c.includes(d))&&!r.allow.includes(U))return!1;return!0});if(ie({outcome:"enrichment",totalModules:G.length,enrichedCount:n.length,enrichmentRate:G.length>0?Math.round(n.length/G.length*100):0}),n.length>0){let t=0;const s=n.slice(0,8).map((c,i)=>{const r=c.duration||45;t+=r;const d=se(c.videos,c.ai_tags);return{...c,order:i+1,cumulativeTime:t,milestone:t>=120&&t<180?"2hr":t>=300&&t<360?"5hr":t>=600?"10hr":null,quickWin:i<2,learningOutcome:d}});K({persona:o,courses:s,totalTime:t,messaging:le(o),source:"rag"});return}}F()},F=()=>{if(!o||!m)return;const a=ot[o.id]||{boostKeywords:o.keywords||[],penaltyKeywords:[],requiredTopics:[]},h=l.experience||"beginner",u={beginner:["beginner","","general"],junior:["beginner","","general","intermediate"],mid:["beginner","","general","intermediate"],senior:["beginner","","general","intermediate","advanced"]},_=u[h]||u.beginner,v=m.filter(n=>{const t=(n.tags?.level||"").toLowerCase();return _.includes(t)}).filter(n=>n.videos?.length>0&&n.videos[0]?.drive_id),M=h==="junior",I=v.map(n=>{let t=0;const s=[...Array.isArray(n.ai_tags)?n.ai_tags:[],...Array.isArray(n.canonical_tags)?n.canonical_tags:[]];n.tags?.topic&&s.push(n.tags.topic),n.tags?.industry&&s.push(n.tags.industry);const c=s.map(C=>typeof C=="string"?C.toLowerCase():""),i=(n.title||n.name||"").toLowerCase(),r=`${i} ${c.join(" ")}`;for(const C of a.boostKeywords){const $=C.toLowerCase();i.includes($)&&(t+=5),c.some(J=>J.includes($))&&(t+=3)}for(const C of a.penaltyKeywords){const $=C.toLowerCase();r.includes($)&&(t-=10)}const d=(n.tags?.industry||"general").toLowerCase(),b={indie_isaac:"games",logic_liam:"games",animator_alex:"animation",rigger_regina:"animation",designer_cpg:"visualization",architect_amy:"architecture",simulation_sam:"simulation",vfx_victor:"vfx",automotive_andy:"automotive"}[o.id]||"general";d!=="general"&&d!==b&&(t-=200),d===b&&d!=="general"&&(t+=15);const ve=[{match:["legacy production","virtual production","broadcast","live action","compositing","stage operator","icvfx","ndisplay","cinematography","film production","in-camera","on-set"],allowPersonas:["animation","vfx","film","media"]},{match:["for automotive","automotive","vehicle design","configurator","car paint","vred"],allowPersonas:["automotive"]},{match:["archviz","architectural","twinmotion","for architecture","for design","aeco"],allowPersonas:["architecture","design"]},{match:["digital twin","crowd simulation"],allowPersonas:["simulation","enterprise"]},{match:["manufacturing","factory","assembly line"],allowPersonas:["manufacturing","enterprise"]}];for(const C of ve)if(C.match.some(J=>i.includes(J))&&!C.allowPersonas.includes(b)){t-=200;break}if((i.includes("executive")||i.includes("leadership")||i.includes("management overview"))&&(t-=30),h==="beginner"){const C=["multiplayer","networking","dedicated server","optimization","profiling","c++ programming","source control","packaging","deployment"];for(const $ of C)r.includes($)&&(t-=15)}n.code?.startsWith("100")&&(t+=40),i.includes("introduction")&&(t+=50),i.includes("intro")&&!i.includes("introduction")&&(t+=40),(i.includes("quickstart")||i.includes("your first"))&&(t+=35),i.includes("getting started")&&(t+=30),i.includes("fundamental")&&t>=0&&(t+=10);const we=se(n.videos,n.ai_tags);return{...n,relevanceScore:t,learningOutcome:we}}).sort((n,t)=>t.relevanceScore-n.relevanceScore),G=new Set;let x=I.filter(n=>{const t=(n.title||n.name||"").toLowerCase().replace(/\s+for\s+(games|automotive|aec|architecture|simulation|film).*$/i,"").replace(/[^a-z0-9]/g,"").replace(/\d+$/g,"");return G.has(t)?!1:(G.add(t),!0)});if(M){let n=0;const t=3;x=x.filter(s=>{if((s.tags?.level||"").toLowerCase()==="intermediate"){if(n>=t)return!1;n++}return!0})}if(x=x.slice(0,8),a.requiredTopics&&a.requiredTopics.length>0){for(const n of a.requiredTopics){const t=n.toLowerCase();if(!x.some(c=>{const i=(c.title||c.name||"").toLowerCase(),r=[...Array.isArray(c.ai_tags)?c.ai_tags:[],...Array.isArray(c.canonical_tags)?c.canonical_tags:[]].map(d=>typeof d=="string"?d.toLowerCase():"").join(" ");return i.includes(t)||r.includes(t)})){const c=I.find(i=>{if(x.some(p=>p.code===i.code))return!1;const r=(i.title||i.name||"").toLowerCase(),d=[...Array.isArray(i.ai_tags)?i.ai_tags:[],...Array.isArray(i.canonical_tags)?i.canonical_tags:[]].map(p=>typeof p=="string"?p.toLowerCase():"").join(" ");return r.includes(t)||d.includes(t)});c&&x.length>=8?x[x.length-1]=c:c&&x.push(c)}}x.sort((n,t)=>(t.relevanceScore||0)-(n.relevanceScore||0))}let T=0;const U=x.map((n,t)=>{const s=n.duration||45;return T+=s,{...n,order:t+1,cumulativeTime:T,milestone:T>=120&&T<180?"2hr":T>=300&&T<360?"5hr":T>=600?"10hr":null,quickWin:t<2}});K({persona:o,courses:U,totalTime:T,messaging:le(o),source:"local"})},[N,L]=z.useState(null),ne=(a,h)=>{O(u=>({...u,[a]:h})),A[g].type==="choice"&&g<A.length-1&&S(u=>u+1)},P=()=>{g<A.length-1&&S(a=>a+1)},R=()=>{S(0),O({startPrompt:"",role:null,experience:null,goal:null}),K(null),L(null),D(),localStorage.removeItem("detected_persona")},q=()=>{S(1),O(a=>({...a,role:null,experience:null,goal:null})),K(null),L(null),D(),localStorage.removeItem("detected_persona")},Z=l.role&&l.experience&&l.goal,y=A[g];return e.jsxs("div",{className:"personas-page",children:[e.jsxs("header",{className:"personas-header",children:[e.jsxs("h1",{children:[e.jsx(oe,{size:24,className:"icon-inline"})," New to UE5? Let's Get You Started"]}),e.jsx("p",{className:"personas-subtitle",children:"Answer a few quick questions and we'll create your personalized first 10-hour learning path"})]}),H?e.jsx("section",{className:"quiz-section rag-loading",children:e.jsxs("div",{className:"rag-loader",children:[e.jsx(De,{size:40,className:"spin-icon"}),e.jsxs("h2",{children:[j===w.PLANNING&&"Analyzing your profile...",j===w.SEARCHING&&"Searching course library...",j===w.ASSEMBLING&&"Building your curriculum..."]}),e.jsxs("p",{className:"rag-loader-sub",children:[j===w.PLANNING&&"Our AI is understanding your learning goals",j===w.SEARCHING&&"Finding the most relevant video segments",j===w.ASSEMBLING&&"Crafting a personalized learning path"]}),e.jsx("div",{className:"rag-progress-bar",children:e.jsx("div",{className:"rag-progress-fill",style:{width:j===w.PLANNING?"33%":j===w.SEARCHING?"66%":"90%"}})})]})}):k?N?e.jsx("div",{className:"guided-player-breakout",children:e.jsx(Ne,{courses:[N],problemSummary:`New to UE5 â€” ${o?.name||"General"}, ${A[2].options.find(a=>a.value===l.experience)?.label||""}, wants to ${A[3].options.find(a=>a.value===l.goal)?.label||"explore"}`,pathSummary:{path_summary:`A personalized learning path for ${k.persona.name}. This path covers foundational UE5 skills tailored to your background, starting with the essentials and building toward hands-on projects.`,topics_covered:k.courses.map(a=>a.title||a.name)},onComplete:()=>L(null),onExit:()=>L(null)})}):e.jsx(e.Fragment,{children:e.jsxs("section",{className:"generated-path",children:[e.jsxs("div",{className:"path-header",children:[e.jsx("span",{className:"path-icon",children:e.jsx(oe,{size:40})}),e.jsxs("div",{children:[e.jsx("h2",{children:"Your Personalized 10-Hour Path"}),e.jsxs("p",{children:["Optimized for ",k.persona.name]})]}),e.jsxs("div",{className:"path-actions",children:[e.jsxs("button",{className:"switch-persona-btn",onClick:q,children:[e.jsx(re,{size:14})," Switch Persona"]}),e.jsxs("button",{className:"reset-btn",onClick:R,children:[e.jsx(re,{size:16})," Start Over"]})]})]}),o&&e.jsx("div",{className:"persona-result-card",children:e.jsxs("div",{className:"persona-result-header",children:[o.emoji&&e.jsx("span",{className:"persona-emoji",children:o.emoji}),e.jsxs("div",{children:[e.jsx("h3",{children:o.name}),e.jsx("p",{children:o.description})]})]})}),e.jsx("div",{className:"motivation-messages",children:k.messaging.map((a,h)=>e.jsx("div",{className:"motivation-card",children:a},h))}),e.jsx("div",{className:"path-courses",children:k.courses.map((a,h)=>e.jsxs("div",{className:`path-course ${a.quickWin?"quick-win":""}`,children:[a.milestone&&e.jsxs("div",{className:"milestone-marker",children:[e.jsx(fe,{size:12,className:"icon-inline-small"})," ",a.milestone," ","Milestone!"]}),e.jsx("div",{className:"course-order",children:a.order}),e.jsxs("div",{className:"course-info",children:[e.jsx("h3",{title:(a.title||a.name||"").replace(/_/g," "),children:(()=>{let u=(a.title||a.name||"").replace(/_/g," ");const _=u.split(/\s+/),v=_[0],M=_.length>2?`${_[0]} ${_[1]}`:"";return M&&u.indexOf(M,M.length)>0?u=u.substring(M.length).trim():_.length>2&&u.toLowerCase().indexOf(v.toLowerCase(),v.length)>0&&(u=u.substring(v.length).trim()),u=u.replace(/^(\w+)\s+\1\b/i,"$1"),u.length>45?`${u.substring(0,45)}...`:u})()}),e.jsxs("div",{className:"course-meta",children:[e.jsxs("span",{children:[e.jsx(Ce,{size:12})," ",a.duration||45," min"]}),e.jsxs("span",{children:[e.jsx(Ie,{size:12})," ",Math.round(a.cumulativeTime/60*10)/10,"hr total"]}),a.quickWin&&e.jsxs("span",{className:"quick-win-badge",children:[e.jsx(st,{size:10})," Quick Win"]})]}),a.learningOutcome&&e.jsx("p",{className:"course-why",children:a.learningOutcome}),a.videos?.length>0&&a.videos[0]?.drive_id&&e.jsxs("button",{className:"course-watch-btn",onClick:()=>L(a),children:[e.jsx(Qe,{size:14})," Watch Course"]})]})]},a.code||h))}),e.jsx("div",{className:"path-summary",children:e.jsxs("p",{children:["Total time:"," ",e.jsxs("strong",{children:[Math.round(k.totalTime/60*10)/10," hours"]})]})})]})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"quiz-progress",children:A.map((a,h)=>e.jsx("div",{className:`progress-step ${h<=g?"active":""} ${a.type==="freetext"?l[a.id]||h<g?"completed":"":l[a.id]?"completed":""}`,children:(a.type==="freetext"?h<g:l[a.id])?e.jsx(Ae,{size:16}):h+1},a.id))}),V&&e.jsx("div",{className:"rag-error-banner",children:"âš ï¸ AI personalization unavailable â€” using local recommendations instead."}),e.jsxs("section",{className:"quiz-section",children:[e.jsx("h2",{children:y.question}),y.subtitle&&e.jsx("p",{className:"quiz-subtitle",children:y.subtitle}),y.type==="freetext"?e.jsxs("div",{className:"freetext-input",children:[e.jsxs("div",{className:"freetext-wrapper",children:[e.jsx(ze,{size:18,className:"freetext-icon"}),e.jsx("textarea",{value:l.startPrompt,onChange:a=>O(h=>({...h,startPrompt:a.target.value})),placeholder:y.placeholder,rows:3,className:"freetext-textarea"})]}),e.jsxs("button",{className:"freetext-next",onClick:P,children:[l.startPrompt?"Next":"Skip"," ",e.jsx(ee,{size:16})]})]}):e.jsx("div",{className:"quiz-options",children:y.options.map(a=>{const h=a.icon||ae;return e.jsxs("button",{className:`quiz-option ${l[y.id]===a.value?"selected":""}`,onClick:()=>ne(y.id,a.value),children:[e.jsx("span",{className:"option-icon-wrapper",children:e.jsx(h,{size:18})}),e.jsxs("span",{className:"option-content",children:[e.jsx("span",{className:"option-label",children:a.label}),a.description&&e.jsx("span",{className:"option-description",children:a.description})]})]},a.value)})}),e.jsxs("div",{className:"quiz-nav",children:[g>0&&e.jsxs("button",{className:"quiz-back",onClick:()=>S(a=>a-1),children:[e.jsx(Me,{size:16})," Back"]}),Z&&e.jsxs("button",{className:"quiz-generate",onClick:B,disabled:H,children:["Generate My Path ",e.jsx(ee,{size:16})]})]})]}),o&&e.jsxs("div",{className:"persona-preview",children:[e.jsx("span",{className:"preview-icon",children:o.emoji?e.jsx("span",{style:{fontSize:"32px"},children:o.emoji}):e.jsx(ae,{size:32})}),e.jsxs("div",{className:"preview-text",children:[e.jsx("strong",{children:o.name}),e.jsx("p",{children:o.description})]})]})]})]})}export{bt as default};
