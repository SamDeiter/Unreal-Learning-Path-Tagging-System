import{u as K,j as e}from"./index-Bx6MaWme.js";import{a as m}from"./vendor-cytoscape-hdah7_Xt.js";import{S as B,C as H}from"./sparkles-DyMeu0iU.js";import{P as O}from"./plus-mlfspTQG.js";import{S as Y}from"./search-BvlZ0fxD.js";import{X as J}from"./x-HbUnH9yy.js";import{c as D}from"./createLucideIcon-YhyuTmrv.js";import{C as U}from"./check-eCXpKYRG.js";import"./vendor-firebase-DNc0QRT5.js";import"./data-courses-CecwKQwF.js";function Z(n,{search:r="",level:u=null,topic:d=null}){return n.filter(l=>{if(r){const c=r.toLowerCase();if(!(l.title?.toLowerCase().includes(c)||l.code?.toLowerCase().includes(c)||l.tags?.topic?.toLowerCase().includes(c)||l.keywords?.some(g=>g.toLowerCase().includes(c))))return!1}return!(u&&l.tags?.level!==u||d&&l.tags?.topic!==d)})}function I(n){return(n||"").toLowerCase().replace(/[^a-z0-9\s]/g,"").trim()}function ee(n){return I(n).split(/\s+/).filter(r=>r.length>2)}function se(n,r){if(!r)return 0;const u=ee(n);if(u.length===0)return 0;let d=0;const l=I(r.title||r.folder_name||""),c=I(r.description||"");let o=[];Array.isArray(r.extracted_tags)&&(o=o.concat(r.extracted_tags)),Array.isArray(r.transcript_tags)&&(o=o.concat(r.transcript_tags)),Array.isArray(r.tags)?o=o.concat(r.tags):r.tags&&typeof r.tags=="object"&&(o=o.concat(Object.values(r.tags).filter(v=>typeof v=="string")));const g=o.map(I);u.forEach(v=>{l.includes(v)&&(d+=30),g.some(f=>f===v||f.includes(v))&&(d+=25),c.includes(v)&&(d+=10),l.split(/\s+/).some(f=>f.startsWith(v))&&(d+=15)});const w=g.filter(v=>u.some(f=>v.includes(f))).length;return d+=w*5,d}function te(n,r,u=8){return!n||n.trim().length<3||!r||!Array.isArray(r)?[]:r.map(l=>({...l,matchScore:se(n,l)})).filter(l=>l.matchScore>0).sort((l,c)=>c.matchScore-l.matchScore).slice(0,u)}const ae=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ne=D("clock",ae);const ie=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],re=D("layers",ie);function le(n,r){if(!r||!n)return n;const u=new RegExp(`(${r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return n.split(u).map((l,c)=>u.test(l)?e.jsx("mark",{className:"search-highlight",children:l},c):l)}function ce({courses:n}){const{courses:r,addCourse:u,learningIntent:d}=K(),[l,c]=m.useState(""),[o,g]=m.useState(null),w=m.useRef(null),v=m.useMemo(()=>{const t=d?.primaryGoal;return t?te(t,n,8):[]},[d,n]),f=m.useMemo(()=>v.filter(t=>!r.some(x=>x.code===t.code)),[v,r]);m.useEffect(()=>{const t=x=>{(x.ctrlKey||x.metaKey)&&x.key==="k"&&(x.preventDefault(),w.current?.focus()),x.key==="Escape"&&(l||o)&&(c(""),g(null),w.current?.blur())};return document.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t)},[l,o]);const y=m.useMemo(()=>Z(n,{search:l,level:o}),[n,l,o]),$=t=>r.some(x=>x.code===t),L=(t,x)=>{t.stopPropagation(),$(x.code)||u(x)},E=()=>{f.forEach(t=>{u(t)})};return e.jsxs("div",{className:"course-library",children:[d?.primaryGoal&&f.length>0&&e.jsxs("div",{className:"suggested-section",children:[e.jsxs("div",{className:"suggested-header",children:[e.jsxs("span",{className:"suggested-title",children:[e.jsx(B,{size:16,className:"icon-inline"}),' Suggested for "',d.primaryGoal,'"']}),e.jsxs("button",{className:"add-all-btn",onClick:E,title:"Add all suggested courses to your path",children:[e.jsx(O,{size:14})," Add All (",f.length,")"]})]}),e.jsx("div",{className:"suggested-list",children:f.slice(0,5).map((t,x)=>e.jsxs("div",{className:"suggested-card",onClick:S=>L(S,t),title:`Match score: ${t.matchScore}
${t.title}`,children:[e.jsx("span",{className:"suggested-code",children:t.code}),e.jsx("span",{className:"suggested-name",children:t.title}),e.jsx("span",{className:"suggested-add",children:e.jsx(O,{size:14})})]},`suggested-${t.code}-${x}`))})]}),!d?.primaryGoal&&e.jsxs("div",{className:"goal-hint",children:[e.jsx(B,{size:16,className:"icon-inline"})," Enter a ",e.jsx("strong",{children:"Primary Goal"})," above to get personalized course suggestions"]}),e.jsxs("div",{className:"library-header",children:[e.jsxs("div",{className:"search-container",children:[e.jsx(Y,{size:16,className:"search-icon"}),e.jsx("input",{ref:w,type:"text",className:"search-input",placeholder:"Search courses... (Ctrl+K)",value:l,onChange:t=>c(t.target.value)}),l&&e.jsx("button",{className:"search-clear",onClick:()=>c(""),title:"Clear search",children:e.jsx(J,{size:14})})]}),e.jsx("div",{className:"level-filters",children:["Beginner","Intermediate","Advanced"].map(t=>e.jsx("button",{className:`level-btn ${o===t?"active":""} ${t.toLowerCase()}`,onClick:()=>g(o===t?null:t),children:t},t))})]}),e.jsxs("div",{className:"library-info",children:[l||o?e.jsxs("span",{children:[e.jsx("strong",{children:y.length})," result",y.length!==1?"s":"",l&&e.jsxs(e.Fragment,{children:[" ",'for "',e.jsx("em",{children:l}),'"']}),o&&e.jsxs(e.Fragment,{children:[" â€¢ ",o]})]}):e.jsxs("span",{children:[y.length," courses"]}),(l||o)&&e.jsx("button",{className:"clear-filters",onClick:()=>{c(""),g(null)},children:"Clear All"})]}),e.jsxs("div",{className:"course-list",children:[y.map((t,x)=>e.jsxs("div",{className:`course-card ${$(t.code)?"in-path":""}`,title:`${t.title}

Code: ${t.code}
Level: ${t.tags?.level||"N/A"}
Duration: ${t.duration?`${t.duration.toFixed(1)} hours`:"Unknown"}
Videos: ${t.video_count||0}
Versions: ${t.versions?.join(", ")||"N/A"}`,children:[e.jsxs("div",{className:"card-content",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("span",{className:"course-code",children:t.code}),t.gemini_enriched&&e.jsx("span",{className:"ai-badge",title:"AI-enriched",children:e.jsx(B,{size:12})})]}),e.jsx("h3",{className:"course-title",children:le(t.title,l)}),e.jsxs("div",{className:"card-tags",children:[t.tags?.level&&e.jsx("span",{className:`tag tag-level ${t.tags.level.toLowerCase()}`,children:t.tags.level}),t.tags?.topic&&e.jsx("span",{className:"tag tag-topic",children:t.tags.topic})]}),e.jsxs("div",{className:"card-meta",children:[t.duration&&e.jsxs("span",{title:`${t.duration.toFixed(1)} hours of content`,className:"meta-item",children:[e.jsx(ne,{size:12})," ",t.duration.toFixed(1),"h"]}),e.jsxs("span",{title:`${t.video_count||0} video${(t.video_count||0)===1?"":"s"}`,className:"meta-item",children:[e.jsx(H,{size:12})," ",t.video_count||0]}),e.jsxs("span",{title:`${t.versions?.length||0} UE version${(t.versions?.length||0)===1?"":"s"}`,className:"meta-item",children:[e.jsx(re,{size:12})," ",t.versions?.length||0]})]})]}),e.jsx("button",{className:`add-btn ${$(t.code)?"added":""}`,onClick:S=>L(S,t),disabled:$(t.code),title:$(t.code)?"In path":"Add to path",children:$(t.code)?e.jsx(U,{size:16}):e.jsx(O,{size:16})})]},`${t.code}-${x}`)),y.length===0&&e.jsx("div",{className:"no-results",children:"No courses match your search."})]})]})}function oe({courses:n,preSelectedSkill:r,onSkillUsed:u}){const{addCourse:d,courses:l}=K(),[c,o]=m.useState(""),[g,w]=m.useState(new Set),[v,f]=m.useState(!1),[y,$]=m.useState(""),L=m.useRef(null);m.useEffect(()=>{r&&(o(r),u&&u())},[r,u]);const E=m.useMemo(()=>{const s=new Map;return n.forEach(i=>{const a=i.tags?.topic;a&&s.set(a.toLowerCase(),{name:a,type:"topic"}),i.gemini_system_tags?.forEach(j=>{s.has(j.toLowerCase())||s.set(j.toLowerCase(),{name:j,type:"ai"})})}),Array.from(s.values()).sort((i,a)=>i.name.localeCompare(a.name))},[n]),t=m.useMemo(()=>{const s={};return n.forEach(i=>{const a=new Set;i.tags?.topic&&a.add(i.tags.topic.toLowerCase()),i.gemini_system_tags?.forEach(p=>a.add(p.toLowerCase()));const j=Array.from(a);j.forEach(p=>{s[p]||(s[p]={}),j.forEach(b=>{p!==b&&(s[p][b]=(s[p][b]||0)+1)})})}),s},[n]),x=m.useMemo(()=>{if(!c.trim())return[];const s=c.toLowerCase(),i=t[s];return i?Object.entries(i).sort((a,j)=>j[1]-a[1]).slice(0,5).map(([a,j])=>{const p=n.filter(k=>[...k.gemini_system_tags||[],k.tags?.topic].filter(Boolean).some(A=>A.toLowerCase()===a)),b=p.reduce((k,M)=>{const A=M.videos?.reduce((N,C)=>N+(C.duration_minutes||0),0)||30;return k+A},0);return{name:a,count:j,courseCount:p.length,estimatedTime:b}}):[]},[c,t,n]),S=m.useMemo(()=>{if(!c.trim()||c.length<2)return[];const s=c.toLowerCase();return E.filter(i=>i.name.toLowerCase().includes(s)).slice(0,8)},[c,E]),z=m.useMemo(()=>{if(!c.trim()||c.length<2)return[];const s=c.toLowerCase(),i=s.split(/\s+/).filter(a=>a.length>2);return n.map(a=>{let j=0;const p=[a.title,a.tags?.topic,a.tags?.level,...a.gemini_system_tags||[],...a.extracted_tags||[],a.gemini_enriched?.one_sentence_summary].filter(Boolean).join(" ").toLowerCase();return i.forEach(b=>{p.includes(b)&&(j+=1)}),p.includes(s)&&(j+=3),a.tags?.topic?.toLowerCase().includes(s)&&(j+=5),{course:a,score:j}}).filter(a=>a.score>0).sort((a,j)=>j.score-a.score).slice(0,30).map(a=>a.course)},[c,n]),h=m.useMemo(()=>{if(z.length===0)return null;const s=new Set(l.map(N=>N.code)),i={Beginner:1,Foundation:1,Intermediate:2,Advanced:3},a=y?parseInt(y):1/0,j=[...z].sort((N,C)=>{const q=i[N.tags?.level]||2,T=i[C.tags?.level]||2;return q-T}),p={prerequisites:[],core:[],advanced:[]};let b=0;j.forEach(N=>{const C=N.tags?.level,q=s.has(N.code),T=N.videos?.reduce((Q,X)=>Q+(X.duration_minutes||0),0)||30;if(b+T>a&&a!==1/0)return;b+=T;const F={...N,isInPath:q,estimatedTime:T};C==="Beginner"||C==="Foundation"?p.prerequisites.push(F):C==="Advanced"?p.advanced.push(F):p.core.push(F)});const k=[...p.prerequisites,...p.core,...p.advanced],M=k.reduce((N,C)=>N+C.estimatedTime,0),A=[];return k.forEach(N=>{N.gemini_enriched?.learning_outcomes?.forEach(C=>{A.includes(C)||A.push(C)})}),{tiers:p,totalCourses:k.length,totalTime:M,allCourses:k,learningOutcomes:A}},[z,l,y]),V=h?h.allCourses.map(s=>s.code).join(","):"";m.useEffect(()=>{if(h&&h.allCourses.length>0){const s=new Set(h.allCourses.filter(i=>!i.isInPath).map(i=>i.code));w(s)}},[V]);const P=m.useCallback(s=>{w(i=>{const a=new Set(i);return a.has(s)?a.delete(s):a.add(s),a})},[]),G=m.useCallback(()=>{if(!h)return;h.allCourses.filter(i=>g.has(i.code)&&!i.isInPath).forEach(i=>d(i)),w(new Set)},[h,g,d]),W=m.useCallback(s=>{o(s),f(!1)},[]),_=s=>{if(s<60)return`${s} min`;const i=Math.floor(s/60),a=s%60;return a>0?`${i}h ${a}m`:`${i}h`};return m.useEffect(()=>{const s=i=>{L.current&&!L.current.contains(i.target)&&f(!1)};return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[]),e.jsxs("div",{className:"skill-curriculum",children:[e.jsxs("div",{className:"sc-header",children:[e.jsx("h3",{children:"ðŸŽ¯ What do you want to teach?"}),e.jsx("p",{children:"Type a skill or phrase, or click a topic below"})]}),e.jsxs("div",{className:"sc-search",ref:L,children:[e.jsx("input",{type:"text",placeholder:"e.g., lighting fundamentals, Niagara VFX, materials...",value:c,onChange:s=>{o(s.target.value),f(!0)},onFocus:()=>f(!0)}),c&&e.jsx("button",{className:"clear-search",onClick:()=>o(""),children:"Ã—"}),v&&S.length>0&&e.jsx("div",{className:"sc-autocomplete",children:S.map(s=>e.jsxs("div",{className:`autocomplete-item ${s.type}`,onClick:()=>W(s.name),children:[e.jsx("span",{className:"suggestion-name",children:s.name}),e.jsx("span",{className:`suggestion-type ${s.type}`,children:s.type==="topic"?"ðŸ“":"ðŸ¤–"})]},s.name))})]}),e.jsxs("div",{className:"sc-time-filter",children:[e.jsx("label",{children:"â±ï¸ Time budget:"}),e.jsxs("select",{value:y,onChange:s=>$(s.target.value),children:[e.jsx("option",{value:"",children:"No limit"}),e.jsx("option",{value:"60",children:"~1 hour"}),e.jsx("option",{value:"120",children:"~2 hours"}),e.jsx("option",{value:"180",children:"~3 hours"}),e.jsx("option",{value:"300",children:"~5 hours"}),e.jsx("option",{value:"600",children:"~10 hours"})]})]}),x.length>0&&e.jsxs("div",{className:"sc-recommendations",children:[e.jsxs("div",{className:"recommendations-header",children:[e.jsx("span",{className:"rec-icon",children:"ðŸ’¡"}),e.jsx("span",{className:"rec-title",children:"You might also need:"})]}),e.jsx("div",{className:"recommendations-list",children:x.map(s=>e.jsxs("button",{className:"rec-skill-chip",onClick:()=>o(i=>i.toLowerCase().includes(s.name.toLowerCase())?i:`${i} ${s.name}`.trim()),title:`${s.courseCount} courses â€¢ ~${_(s.estimatedTime)}`,children:[e.jsx("span",{className:"skill-name",children:s.name}),e.jsx("span",{className:"skill-count",children:s.courseCount}),e.jsxs("span",{className:"skill-time",children:["~",_(s.estimatedTime)]})]},s.name))}),e.jsx("p",{className:"rec-hint",children:"Click to add skills â€¢ Combined curriculum expands coverage"})]}),!c&&e.jsxs("div",{className:"sc-skills",children:[e.jsx("span",{className:"sc-skills-label",children:"Popular topics:"}),E.filter(s=>s.type==="topic").slice(0,12).map(s=>e.jsx("button",{className:"skill-chip",onClick:()=>o(s.name),children:s.name},s.name))]}),c&&z.length===0&&e.jsxs("div",{className:"sc-no-results",children:[e.jsxs("p",{children:['No courses found for "',c,'"']}),e.jsx("p",{className:"hint",children:"Try different keywords or select a topic above"})]}),h&&e.jsxs("div",{className:"sc-curriculum",children:[e.jsxs("div",{className:"sc-curriculum-header",children:[e.jsxs("div",{className:"curriculum-title",children:[e.jsx("h4",{children:"ðŸ“š Recommended Curriculum"}),e.jsxs("span",{className:"search-term",children:['for "',c,'"']})]}),e.jsxs("div",{className:"curriculum-stats",children:[e.jsxs("span",{children:[h.totalCourses," courses"]}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:["~",_(h.totalTime)]}),y&&e.jsx("span",{className:"time-badge",children:"â±ï¸ Fits budget"})]}),e.jsxs("button",{className:"generate-path-btn",onClick:G,disabled:g.size===0,title:`Add ${g.size} selected courses to your learning path`,children:["ðŸš€ Generate Path (",g.size,")"]})]}),h.learningOutcomes.length>0&&e.jsxs("div",{className:"sc-outcomes",children:[e.jsx("h5",{children:"ðŸŽ“ After this curriculum, learners will be able to:"}),e.jsxs("ul",{children:[h.learningOutcomes.slice(0,5).map((s,i)=>e.jsx("li",{children:s},i)),h.learningOutcomes.length>5&&e.jsxs("li",{className:"more",children:["+",h.learningOutcomes.length-5," more outcomes"]})]})]}),e.jsxs("div",{className:"curriculum-tiers",children:[h.tiers.prerequisites.length>0&&e.jsxs("div",{className:"curriculum-tier",children:[e.jsxs("div",{className:"tier-header prerequisites",children:[e.jsx("span",{className:"tier-icon",children:"ðŸŸ¢"}),e.jsx("span",{className:"tier-name",children:"Start Here"}),e.jsx("span",{className:"tier-count",children:h.tiers.prerequisites.length})]}),e.jsx("div",{className:"tier-courses",children:h.tiers.prerequisites.map(s=>e.jsx(R,{course:s,isSelected:g.has(s.code),onToggle:P,formatTime:_},s.code))})]}),h.tiers.core.length>0&&e.jsxs("div",{className:"curriculum-tier",children:[e.jsxs("div",{className:"tier-header core",children:[e.jsx("span",{className:"tier-icon",children:"ðŸ”µ"}),e.jsx("span",{className:"tier-name",children:"Core Learning"}),e.jsx("span",{className:"tier-count",children:h.tiers.core.length})]}),e.jsx("div",{className:"tier-courses",children:h.tiers.core.map(s=>e.jsx(R,{course:s,isSelected:g.has(s.code),onToggle:P,formatTime:_},s.code))})]}),h.tiers.advanced.length>0&&e.jsxs("div",{className:"curriculum-tier",children:[e.jsxs("div",{className:"tier-header advanced",children:[e.jsx("span",{className:"tier-icon",children:"ðŸŸ£"}),e.jsx("span",{className:"tier-name",children:"Advanced"}),e.jsx("span",{className:"tier-count",children:h.tiers.advanced.length})]}),e.jsx("div",{className:"tier-courses",children:h.tiers.advanced.map(s=>e.jsx(R,{course:s,isSelected:g.has(s.code),onToggle:P,formatTime:_},s.code))})]})]}),e.jsx("div",{className:"sc-actions",children:e.jsxs("button",{className:"add-to-path-btn",onClick:G,disabled:g.size===0,children:["âž• Add ",g.size," Courses to Path"]})})]})]})}function R({course:n,isSelected:r,onToggle:u,formatTime:d}){return e.jsxs("div",{className:`curriculum-course ${n.isInPath?"in-path":""} ${r?"selected":""}`,onClick:()=>!n.isInPath&&u(n.code),children:[!n.isInPath&&e.jsx("input",{type:"checkbox",checked:r,onChange:()=>{}}),e.jsxs("div",{className:"course-info",children:[e.jsx("div",{className:"course-title",children:n.title}),e.jsxs("div",{className:"course-meta",children:[e.jsx("span",{className:"course-time",children:d(n.estimatedTime)}),e.jsx("span",{className:"course-level",children:n.tags?.level}),n.isInPath&&e.jsx("span",{className:"already-added",children:"âœ“ Already in path"})]})]})]})}function Ne({courses:n,preSelectedSkill:r,onSkillUsed:u}){const[d,l]=m.useState("skill");return e.jsxs("div",{className:"left-panel",children:[e.jsxs("div",{className:"panel-tabs",children:[e.jsx("button",{className:`panel-tab ${d==="skill"?"active":""}`,onClick:()=>l("skill"),children:"ðŸŽ¯ Build by Skill"}),e.jsx("button",{className:`panel-tab ${d==="browse"?"active":""}`,onClick:()=>l("browse"),children:"ðŸ“š Browse All"})]}),e.jsx("div",{className:"panel-content",children:d==="skill"?e.jsx(oe,{courses:n,preSelectedSkill:r,onSkillUsed:u}):e.jsx(ce,{courses:n})})]})}export{Ne as default};
