import{g as me,a as xe,j as e}from"./index-DxbqtosQ.js";import{a as A}from"./vendor-cytoscape-hdah7_Xt.js";import{p as be}from"./data-courses-VQusrsMX.js";import{s as ke,B as je,A as ee,G as Ne,b as se}from"./segmentSearchService-DfnuYbIX.js";import{n as he,m as ye}from"./vendor-firebase-DNc0QRT5.js";import{d as $,a as te}from"./logger-CDyjTpW_.js";import{c as f}from"./createLucideIcon-YhyuTmrv.js";import{a as _e,S as ae,C as Ce}from"./sparkles-BiYYl4ru.js";import{C as Ae}from"./check-eCXpKYRG.js";import{M as Se}from"./message-square-B9rM_FIo.js";import"./feedbackService-DE8w8YGP.js";import"./x-HbUnH9yy.js";const ze=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Me=f("arrow-left",ze);const Te=[["path",{d:"M17 10c.7-.7 1.69 0 2.5 0a2.5 2.5 0 1 0 0-5 .5.5 0 0 1-.5-.5 2.5 2.5 0 1 0-5 0c0 .81.7 1.8 0 2.5l-7 7c-.7.7-1.69 0-2.5 0a2.5 2.5 0 0 0 0 5c.28 0 .5.22.5.5a2.5 2.5 0 1 0 5 0c0-.81-.7-1.8 0-2.5Z",key:"w610uw"}]],Le=f("bone",Te);const Pe=[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V9",key:"uvy0l4"}],["path",{d:"M19 21V3",key:"11j9sm"}]],qe=f("chart-no-axes-column-increasing",Pe);const Re=[["path",{d:"m18 16 4-4-4-4",key:"1inbqp"}],["path",{d:"m6 8-4 4 4 4",key:"15zrgr"}],["path",{d:"m14.5 4-5 16",key:"e7oirm"}]],Ge=f("code-xml",Re);const Ie=[["path",{d:"M2.7 10.3a2.41 2.41 0 0 0 0 3.41l7.59 7.59a2.41 2.41 0 0 0 3.41 0l7.59-7.59a2.41 2.41 0 0 0 0-3.41l-7.59-7.59a2.41 2.41 0 0 0-3.41 0Z",key:"1f1r0c"}]],$e=f("diamond",Ie);const Ee=[["line",{x1:"6",x2:"10",y1:"11",y2:"11",key:"1gktln"}],["line",{x1:"8",x2:"8",y1:"9",y2:"13",key:"qnk9ow"}],["line",{x1:"15",x2:"15.01",y1:"12",y2:"12",key:"krot7o"}],["line",{x1:"18",x2:"18.01",y1:"10",y2:"10",key:"1lcuu1"}],["path",{d:"M17.32 5H6.68a4 4 0 0 0-3.978 3.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 0 0 3 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 0 1 9.828 16h4.344a2 2 0 0 1 1.414.586L17 18c.5.5 1 1 2 1a3 3 0 0 0 3-3c0-1.545-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0 0 17.32 5z",key:"mfqc10"}]],Oe=f("gamepad-2",Ee);const Ke=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],De=f("loader",Ke);const He=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],We=f("map",He);const Be=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],Fe=f("palette",Be);const Ue=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],Qe=f("play",Ue);const Ve=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],re=f("refresh-cw",Ve);const Ze=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],oe=f("rocket",Ze);const Ye=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Je=f("target",Ye);const Xe=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],fe=f("trophy",Xe);const et=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],tt=f("wand-sparkles",et);const at=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]],it=f("wrench",at);const nt=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],st=f("zap",nt);function rt(p){return be.personas.find(g=>g.id===p)||null}function le(p){return p?Array.isArray(p.onboardingMessaging)&&p.onboardingMessaging.length>0?p.onboardingMessaging:{gamedev_gary:["ðŸŽ® Industry-standard for AAA and indie games","âš¡ Blueprint visual scripting - no C++ required to start","ðŸŒ Deploy to PC, console, and mobile"]}[p.id]||[]:[]}const ot={indie_isaac:{boostKeywords:["blueprint","gameplay","prototype","interaction","UI","UMG","save game","inventory","input","level design","your first","getting started","project","widget","player controller"],penaltyKeywords:["deep C++","networking","multiplayer","dedicated server","mass production","automotive","archviz"],requiredTopics:["viewport","blueprint","lighting","packaging"]},logic_liam:{boostKeywords:["C++","architecture","systems","framework","subsystem","profiling","optimization","GAS","gameplay ability","replication","networking","debugging","performance","memory","API","programming"],penaltyKeywords:["marketing","brand","product viz","archviz","automotive","configurator"],requiredTopics:["blueprint","C++","profiling"]},animator_alex:{boostKeywords:["animation","sequencer","cinematic","character","mocap","keyframe","motion","camera","performance","acting","lighting","storytelling","retarget"],penaltyKeywords:["networking","multiplayer","dedicated server","automotive","archviz","digital twin","manufacturing"],requiredTopics:["animation","sequencer","lighting"]},rigger_regina:{boostKeywords:["control rig","IK","FK","constraint","deformation","skinning","retarget","skeleton","bone","joint","weight","character","rig","animation"],penaltyKeywords:["networking","multiplayer","automotive","archviz","marketing","brand","digital twin"],requiredTopics:["animation","control rig","character"]},designer_cpg:{boostKeywords:["lighting","materials","lookdev","product viz","motion design","camera","presentation","rendering","photorealistic","studio","environment","scene","visualization"],penaltyKeywords:["deep C++","networking","multiplayer","dedicated server","GAS","gameplay ability","digital twin"],requiredTopics:["lighting","materials","camera"]},architect_amy:{boostKeywords:["archviz","architectural","interior","building","walkthrough","visualization","real estate","photorealistic","twinmotion"],penaltyKeywords:["multiplayer","gameplay","automotive","manufacturing"],requiredTopics:["lighting","materials"]},simulation_sam:{boostKeywords:["simulation","digital twin","training","enterprise","industrial","defense","manufacturing","factory"],penaltyKeywords:["archviz","automotive","gameplay","indie"],requiredTopics:["blueprint","simulation"]},vfx_victor:{boostKeywords:["vfx","effects","compositing","particles","niagara","explosion","destruction","smoke","fire","post-process"],penaltyKeywords:["archviz","automotive","manufacturing","digital twin"],requiredTopics:["niagara","effects"]},automotive_andy:{boostKeywords:["automotive","vehicle","car","configurator","showroom","paint","headlight","wheel","dashboard","lighting studio"],penaltyKeywords:["archviz","gameplay","digital twin","multiplayer"],requiredTopics:["materials","lighting"]}};async function ie(p){try{const g=me(),S=he(g);await ye(S,"logTelemetry")({type:"onboarding_rag",...p}),$("[OnboardingTelemetry] Logged:",p.outcome,p)}catch(g){te("[OnboardingTelemetry] Failed to log:",g.message)}}const X="idle",ce="planning",de="searching",ue="assembling",pe="done",ge="error";function lt(){const[p,g]=A.useState(X),[S,c]=A.useState(null),[E,b]=A.useState(null),O=A.useCallback(async K=>{g(ce),c(null),b(null);const k=me(),Q=he(k),x=ye(Q,"queryLearningPath"),D=Date.now();try{$("[OnboardingRAG] Step 1 â€” Calling Planner CF...");const H=(await x({persona:K,mode:"onboarding",onboardingStep:"plan"})).data;if(!H?.success)throw new Error(H?.error||"Planner failed");const{searchQueries:W=[],archetype:B="unknown"}=H;$("[OnboardingRAG] Planner returned:",{searchQueries:W,archetype:B}),g(de),$("[OnboardingRAG] Step 2 â€” Running local segment search...");let j=[];for(const q of W.slice(0,5))try{const V=(await ke(q,null,[],4)).map(h=>({videoTitle:h.videoTitle||h.courseTitle||"Unknown",courseCode:h.courseCode||"unknown",videoId:h.videoKey||h.videoId||"",timestamp:h.timestamp||"0:00",text:h.topSegments?.[0]?.preview||h.text||""}));j.push(...V)}catch(R){te(`[OnboardingRAG] Search failed for "${q}":`,R.message)}const T=new Set;j=j.filter(q=>{const R=`${q.courseCode}::${q.videoId}`;return T.has(R)?!1:(T.add(R),!0)}),$(`[OnboardingRAG] Retrieved ${j.length} unique passages`),g(ue),$("[OnboardingRAG] Step 3 â€” Calling Assembler CF...");const L=(await x({persona:K,mode:"onboarding",onboardingStep:"assemble",archetype:B,passages:j.slice(0,15)})).data;if(!L?.success)throw new Error(L?.error||"Assembler failed");return $("[OnboardingRAG] Curriculum ready:",L.curriculum?.title),ie({outcome:"rag_success",archetype:B,passagesFound:j.length,modulesReturned:(L.curriculum?.modules||[]).length,searchQueries:W.length,pipelineDurationMs:Date.now()-D}),c({...L,passages:j}),g(pe),{...L,passages:j}}catch(l){return te("[OnboardingRAG] Pipeline error:",l.message),ie({outcome:"rag_fallback",errorMessage:l.message||"Unknown error",pipelineDurationMs:Date.now()-D}),b(l.message||"Something went wrong"),g(ge),null}},[]),U=A.useCallback(()=>{g(X),c(null),b(null)},[]);return{generateRAGPath:O,resetRAG:U,ragState:p,ragResult:S,ragError:E,RAG_STATES:{IDLE:X,PLANNING:ce,SEARCHING:de,ASSEMBLING:ue,DONE:pe,ERROR:ge}}}const C=[{id:"startPrompt",question:"What do you want to learn in UE5?",subtitle:"Describe in your own words (optional â€” helps personalize your path)",type:"freetext",placeholder:"e.g. I want to make a small RPG with inventory and combat..."},{id:"role",question:"Which best describes your role?",subtitle:"This determines your learning persona",type:"choice",options:[{value:"indie_isaac",label:"Indie Game Dev",description:"Solo/small-team â€” prototype fast, ship it",icon:Oe},{value:"logic_liam",label:"Games Programmer",description:"Architecture, systems, performance",icon:Ge},{value:"animator_alex",label:"Animator / Film Artist",description:"Cinematics, sequencer, real-time previews",icon:_e},{value:"rigger_regina",label:"Rigger / Character TD",description:"Control Rig, deformation, retargeting",icon:Le},{value:"designer_cpg",label:"Designer (Retail/CPG)",description:"Product viz, lighting, stunning visuals",icon:$e}]},{id:"experience",question:"How many years of 3D / game engine experience do you have?",type:"choice",options:[{value:"beginner",label:"0â€“1 years",description:"Brand new to 3D or engines",icon:ae},{value:"junior",label:"2â€“5 years",description:"Used Maya, Blender, or another engine",icon:Fe},{value:"mid",label:"5â€“10 years",description:"Professional with shipped work",icon:tt},{value:"senior",label:"10+ years",description:"Senior / lead level",icon:it}]},{id:"goal",question:"What do you want to achieve in your first 10 hours?",type:"choice",options:[{value:"explore",label:"Explore and understand UE5",icon:We},{value:"project",label:"Start a specific project",icon:Je},{value:"skill",label:"Learn a specific skill",icon:je},{value:"portfolio",label:"Build a portfolio piece",icon:fe},{value:"transition",label:"Transition from another tool",icon:ee}]}];function bt(){const{courses:p}=xe(),[g,S]=A.useState(0),[c,E]=A.useState({startPrompt:"",role:null,experience:null,goal:null}),[b,O]=A.useState(null),{generateRAGPath:U,resetRAG:K,ragState:k,ragError:Q,RAG_STATES:x}=lt(),D=[x.PLANNING,x.SEARCHING,x.ASSEMBLING].includes(k),l=A.useMemo(()=>c.role?rt(c.role):null,[c.role]),H=()=>{const t=C[1].options.find(v=>v.value===c.role),m=C[2].options.find(v=>v.value===c.experience),d=C[3].options.find(v=>v.value===c.goal);return[c.startPrompt?`Goal: ${c.startPrompt}.`:"",`Role: ${t?.label||c.role}.`,`Experience: ${m?.label||c.experience}.`,`Objective: ${d?.label||c.goal}.`].filter(Boolean).join(" ")},W=async()=>{l&&localStorage.setItem("detected_persona",JSON.stringify(l));const t=H(),m=l?`${l.name} â€” ${l.industry}`:"General",d=await U(t,m);if(d?.curriculum?.modules?.length>0){const N=d.passages||[],v={};N.forEach(i=>{i.videoTitle&&(v[i.videoTitle.toLowerCase()]=i),i.videoId&&(v[i.videoId.toLowerCase()]=i)});const z=i=>{if(!p||!i)return null;const u=i.toLowerCase();return p.find(n=>n.videos?.some(a=>{const r=(a.title||a.name||"").toLowerCase();return r===u||r.includes(u)||u.includes(r)}))},Z=(i,u)=>{const n=new Set(["the","and","for","are","with","from","this","that","your","into","how","can","will","has","was","been","have","what","when","not","unreal","engine","ue5","learn","using","about","getting","started","introduction","overview","course","module","lesson","video"]),a=(i||"").toLowerCase().split(/[\s\-_/()]+/).filter(s=>s.length>2&&!n.has(s)),r=(u||"").toLowerCase().split(/[\s\-_/()]+/).filter(s=>s.length>2&&!n.has(s));if(a.length===0||r.length===0)return 0;let o=0;for(const s of a)for(const w of r){if(s===w){o++;break}if(s.length>4&&w.length>4&&(s.includes(w)||w.includes(s))){o+=.5;break}}return o/Math.max(a.length,r.length)},P=new Set,G=(d.curriculum.modules||[]).map(i=>{let u=null;if(i.videoId&&p&&(u=p.find(a=>!P.has(a.title)&&a.videos?.some(r=>r.drive_id&&(r.title===i.videoId||r.name===i.videoId||r.drive_id===i.videoId)))),!u){const a=(i.videoId||"").toLowerCase(),r=v[a];r?.videoTitle&&(u=z(r.videoTitle),u&&P.has(u.title)&&(u=null))}if(!u&&p){let a=0,r=null;for(const o of N){if(!o.videoTitle)continue;const s=z(o.videoTitle);if(!s||P.has(s.title))continue;const w=Z(i.title+" "+(i.description||""),o.videoTitle);w>a&&w>=.15&&(a=w,r=s)}u=r}if(!u&&p){let a=0,r=null;for(const o of p){if(P.has(o.title)||!o.videos?.length||!o.videos[0]?.drive_id)continue;const s=Z(i.title+" "+(i.description||""),o.title||o.name||"");s>a&&s>=.15&&(a=s,r=o)}u=r}return u&&P.add(u.title),u?{...u,ragTitle:i.title,ragDescription:i.description,enriched:!0}:{title:i.title,name:i.title,description:i.description,code:`rag-${i.title.replace(/\s+/g,"-").toLowerCase().slice(0,30)}`,videos:[],enriched:!1}}),y=G.filter(i=>i.enriched&&i.videos?.length>0&&i.videos[0]?.drive_id);if(ie({outcome:"enrichment",totalModules:G.length,enrichedCount:y.length,enrichmentRate:G.length>0?Math.round(y.length/G.length*100):0}),y.length>0){let i=0;const u=y.slice(0,8).map((n,a)=>{const r=n.duration||45;i+=r;const o=se(n.videos,n.ai_tags);return{...n,order:a+1,cumulativeTime:i,milestone:i>=120&&i<180?"2hr":i>=300&&i<360?"5hr":i>=600?"10hr":null,quickWin:a<2,learningOutcome:o}});O({persona:l,courses:u,totalTime:i,messaging:le(l),source:"rag"});return}}B()},B=()=>{if(!l||!p)return;const t=ot[l.id]||{boostKeywords:l.keywords||[],penaltyKeywords:[],requiredTopics:[]},m=c.experience||"beginner",d={beginner:["beginner","","general"],junior:["beginner","","general","intermediate"],mid:["beginner","","general","intermediate"],senior:["beginner","","general","intermediate","advanced"]},N=d[m]||d.beginner,v=p.filter(n=>{const a=(n.tags?.level||"").toLowerCase();return N.includes(a)}).filter(n=>n.videos?.length>0&&n.videos[0]?.drive_id),z=m==="junior",P=v.map(n=>{let a=0;const r=[...Array.isArray(n.ai_tags)?n.ai_tags:[],...Array.isArray(n.canonical_tags)?n.canonical_tags:[]];n.tags?.topic&&r.push(n.tags.topic),n.tags?.industry&&r.push(n.tags.industry);const o=r.map(_=>typeof _=="string"?_.toLowerCase():""),s=(n.title||n.name||"").toLowerCase(),w=`${s} ${o.join(" ")}`;for(const _ of t.boostKeywords){const I=_.toLowerCase();s.includes(I)&&(a+=5),o.some(J=>J.includes(I))&&(a+=3)}for(const _ of t.penaltyKeywords){const I=_.toLowerCase();w.includes(I)&&(a-=10)}const M=(n.tags?.industry||"general").toLowerCase(),Y={indie_isaac:"games",logic_liam:"games",animator_alex:"animation",rigger_regina:"animation",designer_cpg:"visualization",architect_amy:"architecture",simulation_sam:"simulation",vfx_victor:"vfx",automotive_andy:"automotive"}[l.id]||"general";M!=="general"&&M!==Y&&(a-=50),M===Y&&M!=="general"&&(a+=15);const ve=[{match:["legacy production","virtual production","broadcast","live action","compositing","stage operator","icvfx","ndisplay","cinematography","film production","in-camera","on-set"],allowPersonas:["animation","vfx","film","media"]},{match:["for automotive","automotive","vehicle design","configurator","car paint","vred"],allowPersonas:["automotive"]},{match:["archviz","architectural","twinmotion","for architecture","for design","aeco"],allowPersonas:["architecture","design"]},{match:["digital twin","crowd simulation"],allowPersonas:["simulation","enterprise"]},{match:["manufacturing","factory","assembly line"],allowPersonas:["manufacturing","enterprise"]}];for(const _ of ve)if(_.match.some(J=>s.includes(J))&&!_.allowPersonas.includes(Y)){a-=60;break}if((s.includes("executive")||s.includes("leadership")||s.includes("management overview"))&&(a-=30),m==="beginner"){const _=["multiplayer","networking","dedicated server","optimization","profiling","c++ programming","source control","packaging","deployment"];for(const I of _)w.includes(I)&&(a-=15)}n.code?.startsWith("100")&&(a+=40),s.includes("introduction")&&(a+=50),s.includes("intro")&&!s.includes("introduction")&&(a+=40),(s.includes("quickstart")||s.includes("your first"))&&(a+=35),s.includes("getting started")&&(a+=30),s.includes("fundamental")&&a>=0&&(a+=10);const we=se(n.videos,n.ai_tags);return{...n,relevanceScore:a,learningOutcome:we}}).sort((n,a)=>a.relevanceScore-n.relevanceScore),G=new Set;let y=P.filter(n=>{const a=(n.title||n.name||"").toLowerCase().replace(/\s+for\s+(games|automotive|aec|architecture|simulation|film).*$/i,"").replace(/[^a-z0-9]/g,"").replace(/\d+$/g,"");return G.has(a)?!1:(G.add(a),!0)});if(z){let n=0;const a=3;y=y.filter(r=>{if((r.tags?.level||"").toLowerCase()==="intermediate"){if(n>=a)return!1;n++}return!0})}if(y=y.slice(0,8),t.requiredTopics&&t.requiredTopics.length>0){for(const n of t.requiredTopics){const a=n.toLowerCase();if(!y.some(o=>{const s=(o.title||o.name||"").toLowerCase(),w=[...Array.isArray(o.ai_tags)?o.ai_tags:[],...Array.isArray(o.canonical_tags)?o.canonical_tags:[]].map(M=>typeof M=="string"?M.toLowerCase():"").join(" ");return s.includes(a)||w.includes(a)})){const o=P.find(s=>{if(y.some(F=>F.code===s.code))return!1;const w=(s.title||s.name||"").toLowerCase(),M=[...Array.isArray(s.ai_tags)?s.ai_tags:[],...Array.isArray(s.canonical_tags)?s.canonical_tags:[]].map(F=>typeof F=="string"?F.toLowerCase():"").join(" ");return w.includes(a)||M.includes(a)});o&&y.length>=8?y[y.length-1]=o:o&&y.push(o)}}y.sort((n,a)=>(a.relevanceScore||0)-(n.relevanceScore||0))}let i=0;const u=y.map((n,a)=>{const r=n.duration||45;return i+=r,{...n,order:a+1,cumulativeTime:i,milestone:i>=120&&i<180?"2hr":i>=300&&i<360?"5hr":i>=600?"10hr":null,quickWin:a<2}});O({persona:l,courses:u,totalTime:i,messaging:le(l),source:"local"})},[j,T]=A.useState(null),ne=(t,m)=>{E(d=>({...d,[t]:m})),C[g].type==="choice"&&g<C.length-1&&S(d=>d+1)},L=()=>{g<C.length-1&&S(t=>t+1)},q=()=>{S(0),E({startPrompt:"",role:null,experience:null,goal:null}),O(null),T(null),K(),localStorage.removeItem("detected_persona")},R=()=>{S(1),E(t=>({...t,role:null,experience:null,goal:null})),O(null),T(null),K(),localStorage.removeItem("detected_persona")},V=c.role&&c.experience&&c.goal,h=C[g];return e.jsxs("div",{className:"personas-page",children:[e.jsxs("header",{className:"personas-header",children:[e.jsxs("h1",{children:[e.jsx(oe,{size:24,className:"icon-inline"})," New to UE5? Let's Get You Started"]}),e.jsx("p",{className:"personas-subtitle",children:"Answer a few quick questions and we'll create your personalized first 10-hour learning path"})]}),D?e.jsx("section",{className:"quiz-section rag-loading",children:e.jsxs("div",{className:"rag-loader",children:[e.jsx(De,{size:40,className:"spin-icon"}),e.jsxs("h2",{children:[k===x.PLANNING&&"Analyzing your profile...",k===x.SEARCHING&&"Searching course library...",k===x.ASSEMBLING&&"Building your curriculum..."]}),e.jsxs("p",{className:"rag-loader-sub",children:[k===x.PLANNING&&"Our AI is understanding your learning goals",k===x.SEARCHING&&"Finding the most relevant video segments",k===x.ASSEMBLING&&"Crafting a personalized learning path"]}),e.jsx("div",{className:"rag-progress-bar",children:e.jsx("div",{className:"rag-progress-fill",style:{width:k===x.PLANNING?"33%":k===x.SEARCHING?"66%":"90%"}})})]})}):b?j?e.jsx("div",{className:"guided-player-breakout",children:e.jsx(Ne,{courses:[j],problemSummary:`New to UE5 â€” ${l?.name||"General"}, ${C[2].options.find(t=>t.value===c.experience)?.label||""}, wants to ${C[3].options.find(t=>t.value===c.goal)?.label||"explore"}`,pathSummary:{path_summary:`A personalized learning path for ${b.persona.name}. This path covers foundational UE5 skills tailored to your background, starting with the essentials and building toward hands-on projects.`,topics_covered:b.courses.map(t=>t.title||t.name)},onComplete:()=>T(null),onExit:()=>T(null)})}):e.jsx(e.Fragment,{children:e.jsxs("section",{className:"generated-path",children:[e.jsxs("div",{className:"path-header",children:[e.jsx("span",{className:"path-icon",children:e.jsx(oe,{size:40})}),e.jsxs("div",{children:[e.jsx("h2",{children:"Your Personalized 10-Hour Path"}),e.jsxs("p",{children:["Optimized for ",b.persona.name]})]}),e.jsxs("div",{className:"path-actions",children:[e.jsxs("button",{className:"switch-persona-btn",onClick:R,children:[e.jsx(re,{size:14})," Switch Persona"]}),e.jsxs("button",{className:"reset-btn",onClick:q,children:[e.jsx(re,{size:16})," Start Over"]})]})]}),l&&e.jsx("div",{className:"persona-result-card",children:e.jsxs("div",{className:"persona-result-header",children:[l.emoji&&e.jsx("span",{className:"persona-emoji",children:l.emoji}),e.jsxs("div",{children:[e.jsx("h3",{children:l.name}),e.jsx("p",{children:l.description})]})]})}),e.jsx("div",{className:"motivation-messages",children:b.messaging.map((t,m)=>e.jsx("div",{className:"motivation-card",children:t},m))}),e.jsx("div",{className:"path-courses",children:b.courses.map((t,m)=>e.jsxs("div",{className:`path-course ${t.quickWin?"quick-win":""}`,children:[t.milestone&&e.jsxs("div",{className:"milestone-marker",children:[e.jsx(fe,{size:12,className:"icon-inline-small"})," ",t.milestone," ","Milestone!"]}),e.jsx("div",{className:"course-order",children:t.order}),e.jsxs("div",{className:"course-info",children:[e.jsx("h3",{title:(t.title||t.name||"").replace(/_/g," "),children:(()=>{let d=(t.title||t.name||"").replace(/_/g," ");const N=d.split(/\s+/),v=N[0],z=N.length>2?`${N[0]} ${N[1]}`:"";return z&&d.indexOf(z,z.length)>0?d=d.substring(z.length).trim():N.length>2&&d.toLowerCase().indexOf(v.toLowerCase(),v.length)>0&&(d=d.substring(v.length).trim()),d=d.replace(/^(\w+)\s+\1\b/i,"$1"),d.length>45?`${d.substring(0,45)}...`:d})()}),e.jsxs("div",{className:"course-meta",children:[e.jsxs("span",{children:[e.jsx(Ce,{size:12})," ",t.duration||45," min"]}),e.jsxs("span",{children:[e.jsx(qe,{size:12})," ",Math.round(t.cumulativeTime/60*10)/10,"hr total"]}),t.quickWin&&e.jsxs("span",{className:"quick-win-badge",children:[e.jsx(st,{size:10})," Quick Win"]})]}),t.learningOutcome&&e.jsx("p",{className:"course-why",children:t.learningOutcome}),t.videos?.length>0&&t.videos[0]?.drive_id&&e.jsxs("button",{className:"course-watch-btn",onClick:()=>T(t),children:[e.jsx(Qe,{size:14})," Watch Course"]})]})]},t.code||m))}),e.jsx("div",{className:"path-summary",children:e.jsxs("p",{children:["Total time:"," ",e.jsxs("strong",{children:[Math.round(b.totalTime/60*10)/10," hours"]})]})})]})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"quiz-progress",children:C.map((t,m)=>e.jsx("div",{className:`progress-step ${m<=g?"active":""} ${t.type==="freetext"?c[t.id]||m<g?"completed":"":c[t.id]?"completed":""}`,children:(t.type==="freetext"?m<g:c[t.id])?e.jsx(Ae,{size:16}):m+1},t.id))}),Q&&e.jsx("div",{className:"rag-error-banner",children:"âš ï¸ AI personalization unavailable â€” using local recommendations instead."}),e.jsxs("section",{className:"quiz-section",children:[e.jsx("h2",{children:h.question}),h.subtitle&&e.jsx("p",{className:"quiz-subtitle",children:h.subtitle}),h.type==="freetext"?e.jsxs("div",{className:"freetext-input",children:[e.jsxs("div",{className:"freetext-wrapper",children:[e.jsx(Se,{size:18,className:"freetext-icon"}),e.jsx("textarea",{value:c.startPrompt,onChange:t=>E(m=>({...m,startPrompt:t.target.value})),placeholder:h.placeholder,rows:3,className:"freetext-textarea"})]}),e.jsxs("button",{className:"freetext-next",onClick:L,children:[c.startPrompt?"Next":"Skip"," ",e.jsx(ee,{size:16})]})]}):e.jsx("div",{className:"quiz-options",children:h.options.map(t=>{const m=t.icon||ae;return e.jsxs("button",{className:`quiz-option ${c[h.id]===t.value?"selected":""}`,onClick:()=>ne(h.id,t.value),children:[e.jsx("span",{className:"option-icon-wrapper",children:e.jsx(m,{size:18})}),e.jsxs("span",{className:"option-content",children:[e.jsx("span",{className:"option-label",children:t.label}),t.description&&e.jsx("span",{className:"option-description",children:t.description})]})]},t.value)})}),e.jsxs("div",{className:"quiz-nav",children:[g>0&&e.jsxs("button",{className:"quiz-back",onClick:()=>S(t=>t-1),children:[e.jsx(Me,{size:16})," Back"]}),V&&e.jsxs("button",{className:"quiz-generate",onClick:W,disabled:D,children:["Generate My Path ",e.jsx(ee,{size:16})]})]})]}),l&&e.jsxs("div",{className:"persona-preview",children:[e.jsx("span",{className:"preview-icon",children:l.emoji?e.jsx("span",{style:{fontSize:"32px"},children:l.emoji}):e.jsx(ae,{size:32})}),e.jsxs("div",{className:"preview-text",children:[e.jsx("strong",{children:l.name}),e.jsx("p",{children:l.description})]})]})]})]})}export{bt as default};
