WEBVTT

1
00:00:00.000 --> 00:00:06.000
So let's jump into the engine and see what it takes to get a character set up with a

2
00:00:06.000 --> 00:00:09.759
full body AK system within Control Rig.

3
00:00:09.759 --> 00:00:14.880
What we're going to need is to make sure that we have the full body AK plugin activated.

4
00:00:14.880 --> 00:00:21.760
We'll need a skeletal mesh for our character, a control rig asset and a handful of controls.

5
00:00:21.760 --> 00:00:26.120
The first thing we need to do is check that we have the plugin activated.

6
00:00:26.120 --> 00:00:30.920
So if we come up to edit in the top left here, down to the plugins window and search

7
00:00:30.920 --> 00:00:35.120
for full body, that should get us there.

8
00:00:35.120 --> 00:00:39.480
So we can see that we have the plugin activated already, but if you don't in your project,

9
00:00:39.480 --> 00:00:43.640
just tick this box here and then I think you get a restart option down at the bottom, that

10
00:00:43.640 --> 00:00:48.400
will just restart your project and then have the plugin loaded.

11
00:00:48.400 --> 00:00:53.040
Now that we know the plugin is running, let's create a new control rig for our character.

12
00:00:53.039 --> 00:00:58.839
So if you find your character skeletal mesh, right click, come up to create at the top here

13
00:00:58.839 --> 00:01:01.759
and then down to control rig.

14
00:01:01.759 --> 00:01:05.200
And that'll create you a new control rig and if we double click that to open, you'll

15
00:01:05.200 --> 00:01:09.519
see it's already referencing in your character that you created it from.

16
00:01:09.519 --> 00:01:21.159
I'm just going to rename this to be our FBIK control rig.

17
00:01:21.159 --> 00:01:25.759
And if I double click to open, I'll just dock it in the top here.

18
00:01:25.759 --> 00:01:30.239
The first thing we need to do is create some controls.

19
00:01:30.239 --> 00:01:35.560
Now these will be our effectors for the FBIK solver and the goals for our IK chains to

20
00:01:35.560 --> 00:01:37.959
reach towards essentially.

21
00:01:37.959 --> 00:01:43.719
So we'll want one for the head, one for each hand and one for the ball of each foot.

22
00:01:43.719 --> 00:01:47.679
So I'm going to select all of these bones and create controls from them.

23
00:01:47.680 --> 00:01:55.920
So our head, our hand left, our hand right and further down here we'll have our ball

24
00:01:55.920 --> 00:01:58.800
R and our ball L.

25
00:01:58.800 --> 00:02:03.560
I'll right click these, come to new and add controls for selected.

26
00:02:03.560 --> 00:02:08.760
And if we scroll to the bottom, we've got all of our new controls here that are at the

27
00:02:08.760 --> 00:02:13.920
locations of the bones that we had selected.

28
00:02:13.920 --> 00:02:17.159
Now I'm just going to customize the look of these a bit so we can see at a glance which

29
00:02:17.159 --> 00:02:19.000
control is which.

30
00:02:19.000 --> 00:02:25.079
So for the hands, I'll just change them to box thick.

31
00:02:25.079 --> 00:02:30.759
And for the left side, if I select both of the left hand controls here, I'm just going

32
00:02:30.759 --> 00:02:34.319
to turn them to a blue color.

33
00:02:34.319 --> 00:02:37.960
And with the head control, it's actually inside the head at the moment.

34
00:02:37.960 --> 00:02:43.599
So I'm just going to change it to a circle and I'm going to adjust the rotation of the

35
00:02:43.599 --> 00:02:52.000
shape transform and scale it up probably to let's say three.

36
00:02:52.000 --> 00:02:55.599
And I'll change the color of that as well.

37
00:02:55.599 --> 00:02:58.680
So they're all quite distinct now.

38
00:02:58.680 --> 00:03:03.120
I think something I might do is just adjust the scale of this in the Z axis alone.

39
00:03:03.120 --> 00:03:08.120
Let's go something like eight, just so it's a little easier to select and you can see

40
00:03:08.120 --> 00:03:11.359
it a bit better in the viewport.

41
00:03:11.360 --> 00:03:16.040
Now as I said, these controls are going to be our effectors for the FBI case over.

42
00:03:16.040 --> 00:03:20.040
And this means we're going to need to get their locations to feed that into the FBI

43
00:03:20.040 --> 00:03:21.760
case node.

44
00:03:21.760 --> 00:03:26.320
So if I highlight all of our controls here and I left click and drag them all into our

45
00:03:26.320 --> 00:03:29.800
control regraph and choose get control.

46
00:03:29.800 --> 00:03:33.040
This is going to get the transforms of all of these controls.

47
00:03:33.840 --> 00:03:41.840
If I just space them out a little bit so that we can read them a bit better.

48
00:03:41.840 --> 00:03:48.280
You can see that we have an individual get transform node for all of those controls.

49
00:03:48.280 --> 00:03:52.159
And now we need to set up the logic to tell the system how these controls will be driving

50
00:03:52.159 --> 00:03:54.079
our bones.

51
00:03:54.079 --> 00:03:58.599
So let's first get the brains of the operation and search for an FBI case node.

52
00:03:58.599 --> 00:04:03.960
So if I right click in the rig graph and search for FBI case, it's the full body IK that

53
00:04:03.960 --> 00:04:06.840
we're looking for.

54
00:04:06.840 --> 00:04:10.639
The first thing we need to do is actually set the root of the solver.

55
00:04:10.639 --> 00:04:14.039
And for this, we're going to use the pelvis or the hips of our character.

56
00:04:14.039 --> 00:04:18.040
And the reason we do this is to ensure that the solver actually starts from the true base

57
00:04:18.040 --> 00:04:22.079
of where the motion occurs rather than the root of our skeletal mesh.

58
00:04:22.079 --> 00:04:26.639
You can set this to be any bone on your skeletal mesh depending on your setup, but to get the

59
00:04:26.680 --> 00:04:30.879
best results from something like a biped or quadruped that's reaching towards something

60
00:04:30.879 --> 00:04:36.120
or adjusting its pose to keep aligned with the ground plane, you'll want to set this

61
00:04:36.120 --> 00:04:42.479
more often than not as the pelvis or hips of your character.

62
00:04:42.479 --> 00:04:44.719
So we'll just set that there.

63
00:04:44.719 --> 00:04:46.639
Now we're going to set up the effectors.

64
00:04:46.639 --> 00:04:50.680
And this is where we tell the node which bones we want to use essentially as the end of our

65
00:04:50.680 --> 00:04:56.039
IK chains and which controls will be the goals for those bones.

66
00:04:56.439 --> 00:05:01.160
What we're going to do under the effectors heading here, we'll add an array element with

67
00:05:01.160 --> 00:05:02.920
the little plus.

68
00:05:02.920 --> 00:05:08.600
This will give us just a host of options under our first item in the array.

69
00:05:08.600 --> 00:05:12.160
And the first item we're going to set up for the bone is going to be our head.

70
00:05:12.160 --> 00:05:15.320
And we'll just work down the effectors that we have here or the controls that we have

71
00:05:15.320 --> 00:05:16.640
here.

72
00:05:16.640 --> 00:05:23.160
So if we search for our head bone here and then connect the transform of our head control

73
00:05:23.280 --> 00:05:28.000
to the transform of our first effector here, that means that the head control is going

74
00:05:28.000 --> 00:05:32.920
to drive the head bone.

75
00:05:32.920 --> 00:05:39.040
So if we were to connect this up straight away and just hit compile, when we grab our

76
00:05:39.040 --> 00:05:43.200
head control here, you can see that we're moving the entire character.

77
00:05:43.200 --> 00:05:46.040
And that's just because we haven't pinned anything in place here or we don't have any

78
00:05:46.040 --> 00:05:48.360
other effectors set up.

79
00:05:48.360 --> 00:05:52.400
But you can see that already we've got some movement there and we've got something working.

80
00:05:52.399 --> 00:05:56.279
So let's just do that for the rest of our controls here.

81
00:05:56.279 --> 00:06:02.919
So if we add in your effector, this will be the hand L and we connect those transforms

82
00:06:02.919 --> 00:06:19.919
up, add another one, hand R, connect those transforms up, add one more, all R and the

83
00:06:19.919 --> 00:06:20.919
last one.

84
00:06:21.600 --> 00:06:24.560
Oh, if I hit that properly, there we go.

85
00:06:26.480 --> 00:06:28.400
This will be ball L.

86
00:06:31.439 --> 00:06:37.360
Now, if I compile that, you'll see that when we grab any of these effectors now, all of

87
00:06:37.360 --> 00:06:42.680
the other IK chains or the, all of the other effectors essentially are pinning themselves

88
00:06:42.680 --> 00:06:43.680
in place.

89
00:06:43.680 --> 00:06:47.400
So you can actually pull these around and manipulate your character.

90
00:06:51.319 --> 00:06:56.199
And you can see that really it's kind of that quick to get something, something that's

91
00:06:56.199 --> 00:07:00.680
able to adjust the pose of your character's whole body with just a few controls and the

92
00:07:00.680 --> 00:07:02.680
FBIK node.

93
00:07:02.680 --> 00:07:06.600
Now we have a couple of settings we can look at for each of the effectors first.

94
00:07:06.600 --> 00:07:12.080
And that is the position, I just zoom in here, position, rotation and strength alphas.

95
00:07:13.360 --> 00:07:16.879
And the position and rotation alphas work in the same way.

96
00:07:16.879 --> 00:07:20.160
One is just for translation and one is for rotation.

97
00:07:20.200 --> 00:07:27.080
And they both blend between the bones current position or rotation and the effectors current

98
00:07:27.080 --> 00:07:28.800
position or rotation.

99
00:07:28.800 --> 00:07:34.360
So if we were to set this on the left hand to zero, for example, you'll see that as we

100
00:07:34.360 --> 00:07:38.879
move it around, it's no longer affecting the position of our hand bone.

101
00:07:38.879 --> 00:07:44.080
But as we rotate it, it will affect the rotation because that's still set to one.

102
00:07:44.080 --> 00:07:48.760
So you can kind of customize these and update them and change them to fit your character.

103
00:07:50.800 --> 00:07:56.040
And the strength alpha determines how much the bone will pull towards the effector or

104
00:07:56.040 --> 00:07:57.520
the control.

105
00:07:57.520 --> 00:08:03.160
So if this is set to zero, the bone is not going to pull towards the effector.

106
00:08:03.160 --> 00:08:08.400
But the rest of the chain from the root to the effector is going to slightly resist the

107
00:08:08.400 --> 00:08:13.680
motion of other effectors, meaning that it can act a bit like a stabilizer of sorts for

108
00:08:13.680 --> 00:08:17.640
part of the body that you don't want to behave in a purely FK fashion.

109
00:08:17.680 --> 00:08:24.719
So if I was to set this on the hand to zero and then try and pull it around, you'll see

110
00:08:24.719 --> 00:08:29.919
that it doesn't drive the hand directly, but it still has an effect on the root and the

111
00:08:29.919 --> 00:08:36.720
whole chain going from the root to the end bone, which in this case is our left hand.

112
00:08:36.720 --> 00:08:41.960
So if I was to grab a different effector, you can see that we get a little bit of resistance.

113
00:08:41.960 --> 00:08:45.639
And if someone was leaning to the left, their arm would kind of go out a little bit to kind

114
00:08:45.639 --> 00:08:47.240
of stabilize.

115
00:08:47.279 --> 00:08:49.519
And it's helpful for things like that, essentially.

116
00:08:49.519 --> 00:08:52.120
I just send that back to default.

117
00:08:54.120 --> 00:08:59.039
So with our current settings, if I just make the window a bit bigger here, because we won't

118
00:08:59.039 --> 00:09:04.639
be needing the rig hierarchy, with our current settings, you can see that everything is reacting

119
00:09:04.639 --> 00:09:07.039
to the effectors being pulled around.

120
00:09:07.039 --> 00:09:10.159
But things I think could look a little better.

121
00:09:10.159 --> 00:09:14.639
Like we've got the hips moving quite a lot here, so they're rotating quite a bit.

122
00:09:14.639 --> 00:09:17.559
And the legs, both of them, they're very, very stiff.

123
00:09:17.559 --> 00:09:22.039
So we expect them to sort of be bending at the knee here.

124
00:09:22.039 --> 00:09:26.879
And I think the ankle is probably rotating too far when we lift the leg and drop it down.

125
00:09:26.879 --> 00:09:31.000
You can see both of them are rotating quite a bit there.

126
00:09:31.000 --> 00:09:36.279
So we're going to try and fix these by adjusting the bone settings for the affected bones in

127
00:09:36.279 --> 00:09:37.279
the chains.

128
00:09:37.279 --> 00:09:41.759
So that's going to be things like the pelvis, our leg bones, and our feet bones.

129
00:09:41.759 --> 00:09:46.080
And we do that by adding the affected bones to our bone settings array.

130
00:09:46.080 --> 00:09:49.960
So I'm just going to minimize the effectors here just to clear up sort of the visuals

131
00:09:49.960 --> 00:09:51.360
of the node.

132
00:09:51.360 --> 00:09:56.159
And under the bone settings, I'm going to add a new element to the array.

133
00:09:56.159 --> 00:09:59.960
And all the settings that come up here are going to allow you to essentially control

134
00:09:59.960 --> 00:10:05.600
the stiffness and limit the rotation of the bones that you specify.

135
00:10:05.600 --> 00:10:09.840
So first of all, we're going to try and fix the rotation of the hips that they're going

136
00:10:09.840 --> 00:10:11.120
a bit too far.

137
00:10:11.120 --> 00:10:17.480
So the bone we want to update or we want to add some settings to will be the pelvis.

138
00:10:17.480 --> 00:10:21.440
And we're going to increase the rotation stiffness essentially.

139
00:10:21.440 --> 00:10:27.679
So if we put that to something like 0.8, now when we lift the foot, you'll see that we

140
00:10:27.679 --> 00:10:32.600
get a lot less rotation in the hips there.

141
00:10:32.600 --> 00:10:36.680
And it makes things look just a bit more natural for our character.

142
00:10:36.679 --> 00:10:45.120
And if we were to increase the position stiffness, say 0.5 for example, you'll see that that

143
00:10:45.120 --> 00:10:46.759
doesn't move quite as much.

144
00:10:46.759 --> 00:10:48.799
I can put this also up to one.

145
00:10:48.799 --> 00:10:54.399
And it's just essentially a lot harder for the hips to move up and down.

146
00:10:54.399 --> 00:10:58.719
The controls or the effectors that you're moving need to work a lot harder to pull the

147
00:10:58.719 --> 00:11:01.199
hips around.

148
00:11:01.199 --> 00:11:05.039
But we're going to leave that at zero for now because I think that's what works best

149
00:11:05.039 --> 00:11:10.159
for our character here.

150
00:11:10.159 --> 00:11:13.679
Something you can also do is set preferred angles.

151
00:11:13.679 --> 00:11:18.079
Now this is essentially controlling which way the bone bends when the limb is compressed

152
00:11:18.079 --> 00:11:19.079
by the effector.

153
00:11:19.079 --> 00:11:22.519
And it's great for things like your knees or your elbows.

154
00:11:22.519 --> 00:11:26.439
And we're going to use this to resolve the stiffness in the legs by adjusting the settings

155
00:11:26.439 --> 00:11:31.000
for both the thigh and the calf.

156
00:11:31.000 --> 00:11:33.759
Coming back to our bone settings, we'll add another array element.

157
00:11:33.799 --> 00:11:37.600
Let me just minimize this so we can see a little better when we add it.

158
00:11:37.600 --> 00:11:41.080
And let's first search for the thigh.

159
00:11:41.080 --> 00:11:44.759
So let's work on the left hand side first.

160
00:11:44.759 --> 00:11:52.200
Now under the preferred angles, this is where we can specify which rotation axis we would

161
00:11:52.200 --> 00:11:54.279
prefer to rotate around.

162
00:11:54.279 --> 00:11:57.879
So we prefer the knee to bend around.

163
00:11:57.879 --> 00:12:01.840
And for that, it would be best to check the local rotation axis of our knee joint or our

164
00:12:01.840 --> 00:12:03.279
thigh joint.

165
00:12:03.279 --> 00:12:08.039
And to do that, if we come up to our options, our view options in the top left and turn

166
00:12:08.039 --> 00:12:11.480
on display axis on selection.

167
00:12:11.480 --> 00:12:19.679
And then if we search for our thigh L, we can see that if I zoom in here, we'll be bending

168
00:12:19.679 --> 00:12:22.600
or rotating around the Z axis.

169
00:12:22.600 --> 00:12:25.879
So that'll be going forwards and backwards with our leg.

170
00:12:25.879 --> 00:12:32.639
So inside the preferred angles here, if we set our Z axis to minus 45, just because this

171
00:12:32.679 --> 00:12:41.519
is something we checked previously, and give our leg a bend, we can see that they almost

172
00:12:41.519 --> 00:12:42.519
worked.

173
00:12:42.519 --> 00:12:45.319
However, we need to check on something called use preferred angles.

174
00:12:45.319 --> 00:12:49.960
So without that, it won't be taking any of these values into account.

175
00:12:49.960 --> 00:12:56.039
So if I check that on, you can see immediately we're looking a whole lot better already.

176
00:12:56.039 --> 00:12:59.679
So comparing that to the right hand side, where we don't have any preferred angle set

177
00:12:59.679 --> 00:13:01.019
up.

178
00:13:01.019 --> 00:13:05.539
You can see that as we pull that up and down, it's remaining quite stiff, but the left side

179
00:13:05.539 --> 00:13:09.539
is reacting a lot more how you would expect.

180
00:13:09.539 --> 00:13:12.460
Now let's do the same thing for the calf.

181
00:13:12.460 --> 00:13:18.659
So I'm going to add another bone setting, find our calf L.

182
00:13:18.659 --> 00:13:24.019
And under the preferred angles, let's check the preferred angle of our calf again, or

183
00:13:24.019 --> 00:13:30.100
the local rotation axis.

184
00:13:30.100 --> 00:13:33.420
So it looks to be along the Z axis again.

185
00:13:33.420 --> 00:13:37.460
But this time we wanted to rotate backwards, so rotate the other way.

186
00:13:37.460 --> 00:13:43.259
So inside Z, I'm going to put a value of 90.

187
00:13:43.259 --> 00:13:50.420
And again, check on use preferred angles so that it actually takes those values into account.

188
00:13:50.420 --> 00:13:57.420
And now when we raise the foot up, you can see that we've got a great bend in the knee.

189
00:13:57.419 --> 00:14:03.259
And it's just acting a lot more natural and looking a lot better for our character here

190
00:14:03.259 --> 00:14:06.659
with the pose that they're in.

191
00:14:06.659 --> 00:14:11.379
And these are some things that you can play with and update for your character to get

192
00:14:11.379 --> 00:14:14.139
it looking how you want.

193
00:14:14.139 --> 00:14:18.659
And it's great these preferred angles to set things like any sort of bone you want to rotate

194
00:14:18.659 --> 00:14:19.659
in a specific direction.

195
00:14:19.659 --> 00:14:21.379
It doesn't have to be like arms and legs.

196
00:14:21.379 --> 00:14:25.459
It can be anything that your character needs.

197
00:14:25.460 --> 00:14:29.259
You can update those angles here and just have a bit more control over how the character

198
00:14:29.259 --> 00:14:33.820
is going to react when these effectors are being pulled around.

199
00:14:33.820 --> 00:14:39.900
So let's just do the same for the right side so that we have a symmetrical character essentially

200
00:14:39.900 --> 00:14:41.900
that's working properly.

201
00:14:41.900 --> 00:14:50.340
So we add in your bone array, search for our IR.

202
00:14:50.340 --> 00:14:58.980
Click on Use Preferred Angles and just test that out.

203
00:14:58.980 --> 00:15:04.300
And you can see that whatever value you put in here, it does adhere to.

204
00:15:04.300 --> 00:15:10.980
So set that to negative.

205
00:15:10.980 --> 00:15:13.620
And add one for the right hand calf.

206
00:15:13.620 --> 00:15:16.620
So calf R.

207
00:15:16.620 --> 00:15:21.139
These preferred angles, 90 degrees.

208
00:15:21.139 --> 00:15:25.779
There we go, things are looking a lot nicer now.

209
00:15:25.779 --> 00:15:31.220
And both of our legs are acting much more naturally and much more how you would expect

210
00:15:31.220 --> 00:15:32.899
if one was being pulled around.

211
00:15:32.899 --> 00:15:39.419
And you can see as I go side to side, it's always bending in that Z axis so it's not

212
00:15:39.419 --> 00:15:42.100
accidentally sort of breaking the knee at all.

213
00:15:43.100 --> 00:15:47.580
Now the last thing we're going to take a look at within the bone settings are the limits.

214
00:15:47.580 --> 00:15:50.820
And that's these three options here one per axis.

215
00:15:50.820 --> 00:15:54.300
Now this isn't super necessary here because we're already getting quite good results.

216
00:15:54.300 --> 00:15:58.980
But just for the demo, we'll take a look at how the limit settings work essentially.

217
00:15:58.980 --> 00:16:04.860
Now limits, they allow us to clamp or limit the range of motion of a bone on an individual

218
00:16:04.860 --> 00:16:06.139
axis.

219
00:16:06.139 --> 00:16:08.740
And there are three different settings for it.

220
00:16:08.740 --> 00:16:10.340
So we've got free.

221
00:16:10.340 --> 00:16:14.660
Now that allows the bone to just move freely.

222
00:16:14.660 --> 00:16:16.820
There is limited.

223
00:16:16.820 --> 00:16:21.500
Now this allows the movement only within a specific range of the min and max values that

224
00:16:21.500 --> 00:16:23.220
we set here.

225
00:16:23.220 --> 00:16:26.500
And this is up to or minus 180 degrees.

226
00:16:26.500 --> 00:16:30.460
And the values are relative to your reference pose rather than the pose that your character

227
00:16:30.460 --> 00:16:32.580
is currently in.

228
00:16:32.580 --> 00:16:34.940
And the third option we have is locked.

229
00:16:34.940 --> 00:16:41.260
Now this completely disables the movement along the axis that you lock.

230
00:16:41.260 --> 00:16:46.380
So what we're going to do is tweak the ankle slightly here and limit its range of motion

231
00:16:46.380 --> 00:16:52.220
so that if we were to push this foot up really high, the foot wouldn't penetrate through

232
00:16:52.220 --> 00:16:59.620
the shin there, through the lower leg.

233
00:16:59.620 --> 00:17:03.740
So we'll go through the same process, add a new bone setting.

234
00:17:03.740 --> 00:17:07.660
This is going to be our foot bone.

235
00:17:07.660 --> 00:17:10.099
So foot L will do here.

236
00:17:10.099 --> 00:17:13.779
And we'll just double check the rotation axis that we want to edit.

237
00:17:13.779 --> 00:17:16.859
And it is along the Z axis again.

238
00:17:16.859 --> 00:17:22.579
So here we've already tested these settings and I'm going to set the Z axis to limited

239
00:17:22.579 --> 00:17:31.759
and set the minimum to minus 60 and the maximum to 60.

240
00:17:31.759 --> 00:17:38.140
So if I push this foot right the way up now, you'll see that when we reach a certain point,

241
00:17:38.140 --> 00:17:46.319
which is just around here, the ankle no longer keeps rotating so it doesn't penetrate through

242
00:17:46.319 --> 00:17:49.119
the lower leg.

243
00:17:49.119 --> 00:17:55.279
I'll just revert these back to zero.

244
00:17:55.279 --> 00:17:56.680
You can see the difference there.

245
00:17:56.799 --> 00:18:04.160
As we keep raising it up, that ankle just keeps bending.

246
00:18:04.160 --> 00:18:08.759
So if you have any instances with your character where you need to fix that or limit the bone,

247
00:18:08.759 --> 00:18:11.560
that's how you would do it.

248
00:18:11.560 --> 00:18:15.360
And I'll just duplicate that for the right hand side.

249
00:18:15.359 --> 00:18:28.159
So find our foot R, come down to the Z axis, limit that at minus 60 and 60.

250
00:18:28.159 --> 00:18:38.359
So now both feet are working in the same way.

251
00:18:38.359 --> 00:18:42.399
So with tweaking those various bone settings, we actually fixed our character and got them

252
00:18:42.399 --> 00:18:45.240
looking more natural.

253
00:18:45.240 --> 00:18:51.599
So with less hip bend there and the knees are bending in the correct direction and the

254
00:18:51.599 --> 00:18:55.640
ankles aren't bending too far, so we have something a little more realistic for our

255
00:18:55.640 --> 00:18:58.240
character.

256
00:18:58.240 --> 00:19:03.240
Now depending on the needs of your rig, there may be cases where you want to exclude bones

257
00:19:03.240 --> 00:19:05.559
from the FBIK solve.

258
00:19:05.559 --> 00:19:10.039
And this can be useful when correcting unnatural looking poses or if you just want to simplify

259
00:19:10.039 --> 00:19:12.599
the FBIK behavior.

260
00:19:12.599 --> 00:19:18.039
So excluding bones is highly recommended versus using bone settings and adding lots

261
00:19:18.039 --> 00:19:23.679
of bones that are sort of fully stiff or locked because this reduces the calculations that

262
00:19:23.679 --> 00:19:28.839
the solver has to do and essentially reduces the impact on performance because there are

263
00:19:28.839 --> 00:19:33.799
fewer things that the solver has to calculate for if you're excluding them.

264
00:19:33.799 --> 00:19:38.199
So if we take a look at an example here, what we can do is move the head into an awkward

265
00:19:38.199 --> 00:19:40.959
sort of position.

266
00:19:40.960 --> 00:19:45.200
And you can see that if the head's being pulled around, the body's not really reacting how

267
00:19:45.200 --> 00:19:46.759
you would expect.

268
00:19:46.759 --> 00:19:50.880
So I'm going to exclude the neck and the spine here to try and get a bit more of a comfortable

269
00:19:50.880 --> 00:19:52.579
pose.

270
00:19:52.579 --> 00:20:00.240
So I'm going to add six bones here and I'm just going to start at the top of the chain

271
00:20:00.240 --> 00:20:02.319
and work my way down.

272
00:20:02.319 --> 00:20:09.039
So neck two, neck one, you can see they've already gained something a bit more natural,

273
00:20:09.399 --> 00:20:14.559
arguably that is still a little strange, but the whole body has come down to meet the head

274
00:20:14.559 --> 00:20:16.839
now.

275
00:20:16.839 --> 00:20:28.359
If I exclude some more of these spine bones, we should get something as little more as

276
00:20:28.359 --> 00:20:30.319
you expect.

277
00:20:30.319 --> 00:20:34.519
So as this head is being pulled around, the spine is still bending at the first spine

278
00:20:34.519 --> 00:20:38.559
joint because they're not excluded that as well as the pelvis.

279
00:20:38.559 --> 00:20:46.799
And it's keeping it a little straighter to try and meet the head effector.

280
00:20:46.799 --> 00:20:52.160
So if you have certain scenarios where that's something you need to do and stop sort of

281
00:20:52.160 --> 00:20:59.240
a strange pose that you have on your character or improve the pose of your character to reach

282
00:20:59.240 --> 00:21:03.839
the effector or the IK goal, then excluding bones is a great way to do that.

283
00:21:03.839 --> 00:21:07.799
And again, this removes bones from the solvers calculations.

284
00:21:07.799 --> 00:21:13.439
So it makes things a little bit more performant versus adding lots of bones to the bone settings

285
00:21:13.439 --> 00:21:20.519
and then setting them as locked or the stiffness to 100%.

286
00:21:20.519 --> 00:21:24.579
The last thing to take a look at with the FBIK node here are just some of the settings

287
00:21:24.579 --> 00:21:28.199
that are available to tweak things on a more global scale.

288
00:21:28.199 --> 00:21:33.559
So if I close that and open settings here, we have the iterations here.

289
00:21:34.279 --> 00:21:39.599
Basically, the number of times that the solver will loop through and calculate all the positions

290
00:21:39.599 --> 00:21:41.279
of the bones.

291
00:21:41.279 --> 00:21:47.039
This helps with convergence, which is essentially trying to make the bones reach the effectors.

292
00:21:47.039 --> 00:21:51.399
Increasing this value will increase the CPU cost of the node, but it can be necessary

293
00:21:51.399 --> 00:21:55.839
when you have a lot of bones in your character.

294
00:21:55.839 --> 00:21:58.319
Next we have the mass multiplier.

295
00:21:58.319 --> 00:22:03.399
And this acts as a sort of global stiffness, similar to the position and rotation stiffness

296
00:22:03.400 --> 00:22:08.280
that we saw under the bone settings, but it applies to all of the bones at once.

297
00:22:08.280 --> 00:22:12.360
And typically you'd work within a range of 0 to 10 for this.

298
00:22:12.360 --> 00:22:18.320
So if the IK solve seems to be acting quite erratically, increasing the minimum mass multiplier

299
00:22:18.320 --> 00:22:19.960
might just fix that.

300
00:22:19.960 --> 00:22:24.680
So for example, this can sometimes happen with very large scale characters.

301
00:22:24.680 --> 00:22:30.700
So internally, the body is segmented by the node and held together with constraints.

302
00:22:30.700 --> 00:22:34.259
So this is from the effectors to the bones.

303
00:22:34.259 --> 00:22:38.740
That's just sort of the behind the scenes working of the IK node.

304
00:22:38.740 --> 00:22:43.720
And the mass multiplier is proportional to the length of the body.

305
00:22:43.720 --> 00:22:49.380
So that means that longer bones will rotate less than smaller bones.

306
00:22:49.380 --> 00:22:53.180
And that means that they'll rotate less per iteration, which means you might just need

307
00:22:53.180 --> 00:22:56.980
to play with these values together to get the sort of results that you want.

308
00:22:57.259 --> 00:23:00.500
You might need to increase the iterations a little bit, as well as increasing the mass

309
00:23:00.500 --> 00:23:02.259
multiplier a little bit.

310
00:23:02.259 --> 00:23:06.539
But that tends to apply to, again, just very large characters with either long bones or

311
00:23:06.539 --> 00:23:10.660
a lot of bones in their skeleton.

312
00:23:10.660 --> 00:23:12.420
Allow stretch does what you think.

313
00:23:12.420 --> 00:23:18.019
So it will allow your bones to stretch towards the effector.

314
00:23:18.019 --> 00:23:23.940
So with that turned on and off, you can see that actually the length of the bones increases,

315
00:23:23.940 --> 00:23:27.820
stretching towards the effector to reach the end goal.

316
00:23:27.820 --> 00:23:31.420
Updating the root behavior will determine how the root acts.

317
00:23:31.420 --> 00:23:35.980
So you can see here that pre-pull is default, and by default, it will translate and rotate

318
00:23:35.980 --> 00:23:41.080
the root and all the children when you're pulling the effectors around.

319
00:23:41.080 --> 00:23:46.820
If you pin to input, this locks the root to the current pose that the root is in.

320
00:23:46.820 --> 00:23:50.380
So the current animation pose that is playing.

321
00:23:50.380 --> 00:23:53.580
If you set it to free, it treats the root bone like any other and allows it to freely

322
00:23:53.579 --> 00:23:58.500
move according to whatever bone settings you have applied to it.

323
00:23:58.500 --> 00:24:02.740
And these bone settings, if we drop down the box here, will allow you to update the rotation

324
00:24:02.740 --> 00:24:09.939
and position along each individual axis to sort of tweak to your heart's content.

325
00:24:09.939 --> 00:24:14.899
The global pull chain alpha can be used to rotate the entire limb controlled by an effector

326
00:24:14.899 --> 00:24:18.339
to point at it before the solver runs.

327
00:24:18.339 --> 00:24:23.019
So if you use this in conjunction with preferred angles, it can really help to pull the skeleton

328
00:24:23.019 --> 00:24:27.339
into a desired shape before the constraints are solved.

329
00:24:27.339 --> 00:24:32.259
Now it's on by default, set to one, though it's sometimes desirable to turn it off because

330
00:24:32.259 --> 00:24:35.980
it can make limbs a little overreactive or even reduce it.

331
00:24:35.980 --> 00:24:41.220
And by that, if I just drag this down here, for example, to show you, if I slowly increase

332
00:24:41.220 --> 00:24:48.019
this number, you'll see that the sort of rotation on all the limbs gets multiplied.

333
00:24:49.019 --> 00:24:53.779
And you can end up with some funky results, and that's what we mean by overreactive,

334
00:24:53.779 --> 00:25:00.859
like they're bending a bit too much.

335
00:25:00.859 --> 00:25:08.940
The maximum angle will just determine how much a bone can rotate per iteration.

336
00:25:08.940 --> 00:25:13.940
And over relaxation here will essentially push the constraints beyond their normal amount

337
00:25:13.940 --> 00:25:17.259
in an attempt to speed up convergence.

338
00:25:17.259 --> 00:25:21.740
Now this can help with some of your posing, but it can come at the cost of stability.

339
00:25:21.740 --> 00:25:26.500
So the range to work within here is just between one and two.

340
00:25:26.500 --> 00:25:30.539
So as you can see, there are a lot of different settings that we just went over and a lot

341
00:25:30.539 --> 00:25:36.299
of different options available to tweak and sort of change the posing of your character.

342
00:25:36.299 --> 00:25:39.059
Now I would say try not to get too bogged down with them.

343
00:25:39.059 --> 00:25:44.660
My advice would be focus mainly on your bone settings and your excluded bones, as they're

344
00:25:44.660 --> 00:25:49.779
going to be the thing that help you out the most when fixing your posing in most common scenarios.

