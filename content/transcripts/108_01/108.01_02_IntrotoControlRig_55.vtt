WEBVTT

1
00:00:00.000 --> 00:00:07.839
Now, typically with FK setups, as I was saying, you want the control's initial start point

2
00:00:07.839 --> 00:00:12.679
to be in the same place as the bone that you're trying to control.

3
00:00:12.679 --> 00:00:17.240
So what we can do here is we could select the other elbow, for example.

4
00:00:17.240 --> 00:00:21.920
We can right-click that bone, come up to New, and create a new control in the same way that

5
00:00:21.920 --> 00:00:28.760
we did before, except this time, that will automatically position and orient the control

6
00:00:28.880 --> 00:00:32.719
to match that of the bone that you had selected.

7
00:00:32.719 --> 00:00:39.760
Something that it also does is names the control the same as your bone and adds underscore CTRL

8
00:00:39.760 --> 00:00:42.000
at the end.

9
00:00:42.000 --> 00:00:46.200
And this is just a great way of keeping your controls and your bone names separate so that

10
00:00:46.200 --> 00:00:50.760
when you're using your rigging logic, things are a bit more straightforward.

11
00:00:50.760 --> 00:00:54.600
In previous versions of the engine, this control would have been created as a child of the

12
00:00:54.600 --> 00:00:59.160
bone that we had selected, and we'd recommend that you select the control and press Shift

13
00:00:59.160 --> 00:01:03.280
P to remove it from the hierarchy, because it's best practice for the rig controls to

14
00:01:03.280 --> 00:01:08.640
be in their own hierarchy rather than a skeleton's hierarchy.

15
00:01:08.640 --> 00:01:10.599
And we can do the same thing with this.

16
00:01:10.599 --> 00:01:15.640
We could change the shape, so we could go for another circle, and we could reposition the

17
00:01:15.640 --> 00:01:18.000
shapes transformed the same way again.

18
00:01:18.000 --> 00:01:25.599
So if we went 90 degrees on the Y axis, and increase the scale to 2, just so it's a little

19
00:01:25.599 --> 00:01:28.840
easier to select.

20
00:01:28.840 --> 00:01:32.920
So it's really as easy as that to start creating your controls.

21
00:01:32.920 --> 00:01:37.319
Now what we'll start to do is build the logic for our FK controls.

22
00:01:37.319 --> 00:01:41.799
So we'll create a root control that will be at the head of the hierarchy, and then we'll

23
00:01:41.799 --> 00:01:46.960
create a control for the spine and set up a simple hierarchy for our rig.

24
00:01:46.959 --> 00:01:52.519
So if I delete these two controls here, what I'll do is come up to the top, select our

25
00:01:52.519 --> 00:01:59.519
root and our spine, and if I right click the two of these together, come up to New Control,

26
00:01:59.519 --> 00:02:03.919
what that will do is create the two controls for us and put them down out of the hierarchy

27
00:02:03.919 --> 00:02:06.119
down here.

28
00:02:06.119 --> 00:02:10.599
Now to child the spine underneath the root control so that when we move the root control,

29
00:02:10.599 --> 00:02:15.879
the spine comes with it, what we'll do is drag the spine control on top of the root

30
00:02:15.879 --> 00:02:20.639
control, and you can see this child's under the root control, and you can see that based

31
00:02:20.639 --> 00:02:25.799
on the small arrow that we have here, and the line connected to it.

32
00:02:25.799 --> 00:02:31.599
Now if we change the look of our controls like we did before, with the root control,

33
00:02:31.599 --> 00:02:38.359
we can create something like an octagon, and maybe it'll be yellow, and we'll scale it

34
00:02:38.359 --> 00:02:42.359
up to something like 10.

35
00:02:42.359 --> 00:02:45.599
Oh, we didn't keep that, so let's try that again.

36
00:02:45.599 --> 00:02:49.639
There we go.

37
00:02:49.639 --> 00:02:54.759
And with our spine control, this is stuck inside of our mesh at the moment, so what

38
00:02:54.759 --> 00:03:01.359
I'm going to do first is just scale it up until we can see it a little better, something

39
00:03:01.359 --> 00:03:11.479
like 3.5, and then we'll change the shape again to be a circle, and we can see again

40
00:03:11.479 --> 00:03:15.679
that it's slightly misoriented for how we'd like to use it.

41
00:03:15.679 --> 00:03:23.039
So using the shape transform, what I'm going to do is rotate 90 degrees on Y again, and

42
00:03:23.039 --> 00:03:28.599
I'll even scale it up a little more, maybe 4 will be better.

43
00:03:28.599 --> 00:03:34.199
So as you can see, we have our two controls here now, and as I move the root control around,

44
00:03:34.199 --> 00:03:38.439
our spine control follows.

45
00:03:38.439 --> 00:03:42.800
Now let's set up the logic to connect our controls and our bones together.

46
00:03:42.800 --> 00:03:47.919
So what we'll do first is we will grab our control here, click and hold and drag it into

47
00:03:47.919 --> 00:03:51.800
the rig graph, and we'll choose get control.

48
00:03:51.800 --> 00:03:56.800
So this is going to get the transforming information about this control, and because we want the

49
00:03:56.800 --> 00:04:02.599
root control to control our root bone, I'll also grab the root bone and drag that in,

50
00:04:02.599 --> 00:04:08.199
and I'll choose set root bone, because we want to use the transforms of the control to set

51
00:04:08.199 --> 00:04:10.839
the transforms of the bone.

52
00:04:10.839 --> 00:04:15.000
And to connect these two together, we grab the transform output pin and plug that into

53
00:04:15.000 --> 00:04:21.920
the value input pin of the set transform bone node, and then we just connect the logic up.

54
00:04:21.920 --> 00:04:24.599
I compile that and select our control.

55
00:04:24.599 --> 00:04:30.079
What we'll see is our control is now controlling our skeleton.

56
00:04:30.079 --> 00:04:35.360
Now if we set the same thing up with the spine control, currently that's doing nothing, that's

57
00:04:35.360 --> 00:04:40.960
not affecting skeleton in any way, but if we drag that into the rig graph and choose

58
00:04:40.960 --> 00:04:52.400
get control, and then we drag in our spine 01 bone and choose set bone, connect the transform

59
00:04:52.400 --> 00:04:59.600
to the value pin, connect up the execute logic, and when we hit compile, we'll see that this

60
00:04:59.600 --> 00:05:05.080
control is now controlling our spine.

61
00:05:05.079 --> 00:05:09.000
It really is that straightforward to get your controls driving your bones and moving

62
00:05:09.000 --> 00:05:13.279
your character, and now you could do this for all of the bones on your character, and

63
00:05:13.279 --> 00:05:17.800
pretty quickly you'd have an FK rig that you could use to animate with.

64
00:05:17.800 --> 00:05:19.800
But what if you wanted to get a bit more complex?

65
00:05:19.800 --> 00:05:24.919
Now it's very common for characters with arms and feet to have an IK setup, which is a super

66
00:05:24.919 --> 00:05:29.199
useful way of having the hands and feet drive the movement of the arms and legs, or even

67
00:05:29.199 --> 00:05:31.599
pinning the hands and feet in place.

68
00:05:31.599 --> 00:05:33.159
So let's do that next.

69
00:05:33.160 --> 00:05:37.120
Let's create an IK setup for the arm.

70
00:05:37.120 --> 00:05:42.400
So for this simple IK setup, we're going to use the basic IK node, and for this to work,

71
00:05:42.400 --> 00:05:45.400
it needs a few different bits of information.

72
00:05:45.400 --> 00:05:51.840
So if I right click inside our rig graph here, and search for basic IK, I can spell it right,

73
00:05:51.840 --> 00:05:56.879
basic IK, this is the node that we're going to use.

74
00:05:56.879 --> 00:06:00.600
Now we need to tell this which bones we want to affect, so we're going to set this up on

75
00:06:00.600 --> 00:06:02.640
one of the arms.

76
00:06:02.640 --> 00:06:07.120
We need to give it the effect information, which is essentially the wrist control or the

77
00:06:07.120 --> 00:06:11.600
hand control that we're going to use to control the entire IK system.

78
00:06:11.600 --> 00:06:16.000
And then we need to give it a pole vector, and this just allows us to control where the

79
00:06:16.000 --> 00:06:19.560
elbow is going to point.

80
00:06:19.560 --> 00:06:24.160
So first of all, let's create all the pieces that we're going to need to make this work.

81
00:06:24.160 --> 00:06:28.080
So let's create our wrist control or hand control first.

82
00:06:28.079 --> 00:06:32.719
So inside the rig hierarchy here, I'm just going to search for hand, and we'll set it

83
00:06:32.719 --> 00:06:35.120
up on the right hand side.

84
00:06:35.120 --> 00:06:43.399
So with hand are selected, I'm going to right click and create new control like we did before.

85
00:06:43.399 --> 00:06:48.799
And I'm going to drag that inside our root control, so that wherever we move the root

86
00:06:48.799 --> 00:06:55.759
control, all of the rest of the controls for the body will follow.

87
00:06:55.759 --> 00:07:04.000
I'm also going to change the look of our wrist control or our hand control.

88
00:07:04.000 --> 00:07:08.759
Let's come down here, make it a circle again.

89
00:07:08.759 --> 00:07:18.839
If I just press F to zoom in, we can see that we need to rotate along the Y axis again.

90
00:07:18.839 --> 00:07:21.199
And I'll do the same thing where I scale this up slightly.

91
00:07:21.199 --> 00:07:24.800
Let's go to 1.5 maybe.

92
00:07:24.800 --> 00:07:30.800
So compiling that, we now have our new control in the correct position where the hand is.

93
00:07:30.800 --> 00:07:34.960
Our next control we need to make is a pole vector.

94
00:07:34.960 --> 00:07:37.800
Now we need to make this at the position of the elbow because the elbow is what we're

95
00:07:37.800 --> 00:07:40.040
going to be wanting to control.

96
00:07:40.040 --> 00:07:45.639
So for us, that's our lower arm.

97
00:07:45.639 --> 00:07:48.319
And make sure that we're choosing the right one here.

98
00:07:48.319 --> 00:07:55.279
If I press control N, that's the shortcut to create a new control.

99
00:07:55.279 --> 00:08:00.319
And then I'll do the same thing and bring that inside our root control.

100
00:08:00.319 --> 00:08:05.519
And we can see that we are aligned with the elbow.

101
00:08:05.519 --> 00:08:07.959
But I want to bring this out a little bit.

102
00:08:07.959 --> 00:08:12.199
And I'm going to move this along the Y axis only because that's the axis of the bone that

103
00:08:12.199 --> 00:08:16.519
we want to point towards the pole vector control, meaning we're maintaining the plane that the

104
00:08:16.519 --> 00:08:17.519
bone is on.

105
00:08:17.519 --> 00:08:22.399
So if I just bring it out to here somewhere that's nice and accessible, I'll then right

106
00:08:22.399 --> 00:08:27.719
click and set our offset transform from current.

107
00:08:27.719 --> 00:08:31.879
If I wasn't to do that and I was to compile our control rig, you see it snaps back to

108
00:08:31.879 --> 00:08:34.539
where it originally spawned.

109
00:08:34.539 --> 00:08:40.720
So if I pull that out again, right click, set offset transform from current.

110
00:08:40.720 --> 00:08:47.019
Now when I compile, you see that that's this control's new initial location.

111
00:08:47.019 --> 00:08:49.019
Now we have all the controls that we need.

112
00:08:49.019 --> 00:08:52.440
Let's start setting up the basic IK.

113
00:08:52.440 --> 00:08:56.680
So let's tell our basic IK node what bones we want to control.

114
00:08:56.680 --> 00:09:02.720
Now this is going to be our upper arm bone, our lower arm bone, and our hand bone.

115
00:09:02.720 --> 00:09:07.200
So in item A here, which will be the start of our chain, we want to put our upper arm

116
00:09:07.200 --> 00:09:08.840
bone.

117
00:09:08.840 --> 00:09:12.840
And we can just put that in by searching for the name of the bone.

118
00:09:12.840 --> 00:09:17.560
Or what we could actually do is select the bone in the outliner here and the rikai raki

119
00:09:17.560 --> 00:09:21.800
and use this arrow to use the name of what we have selected.

120
00:09:21.800 --> 00:09:29.879
So if we choose our lower arm, if I search for it, lower arm R, I could just hit the

121
00:09:29.879 --> 00:09:42.080
arrow there and then our hand R is going to be our effector or the end of our chain.

122
00:09:42.080 --> 00:09:46.799
Now that we know what bones we're affecting, let's tell the system what controls we're

123
00:09:46.799 --> 00:09:48.080
using.

124
00:09:48.080 --> 00:09:52.000
So if I clear out our search there, come down to the bottom.

125
00:09:52.000 --> 00:09:54.720
We have our hand control and our lower arm control.

126
00:09:55.360 --> 00:10:04.320
I'm just going to right click and rename this to be our pole vector control.

127
00:10:04.320 --> 00:10:07.680
So I'll put PVR control.

128
00:10:07.680 --> 00:10:12.639
Now with both of these, I'll drag the two in and I'll choose get control so that we

129
00:10:12.639 --> 00:10:17.920
can get the transforms and the information of these two controls.

130
00:10:17.920 --> 00:10:21.600
Now we can see the hand control that I have here.

131
00:10:21.600 --> 00:10:25.920
We're going to be using that as our effector control, which means it'll be directly driving

132
00:10:25.920 --> 00:10:32.279
the effector at the end of the IK chain or our hand bone.

133
00:10:32.279 --> 00:10:37.960
So if we connect the transforms directly up to the effector there, the last thing we

134
00:10:37.960 --> 00:10:41.759
need to connect up is the pole vector control.

135
00:10:41.759 --> 00:10:47.000
Now the pole vector is based on translation or position data only.

136
00:10:47.000 --> 00:10:51.480
So if we open the transform tab here, grab our translation information from the pole

137
00:10:51.480 --> 00:10:56.080
vector control and plug that into the pole vector pin here.

138
00:10:56.080 --> 00:10:59.200
That's all we need to connect up to get the IK working.

139
00:10:59.200 --> 00:11:08.039
So let's plug it into our execute chain here, connect the logic up.

140
00:11:08.039 --> 00:11:14.600
And we can see that something's definitely changed, but it does look a little bit broken.

141
00:11:14.600 --> 00:11:16.360
So it's sort of half working.

142
00:11:16.360 --> 00:11:21.480
We've got an IK chain where we can move the hand around and the upper arm and the lower

143
00:11:21.480 --> 00:11:24.960
arm respond to how that hand's moving.

144
00:11:24.960 --> 00:11:31.080
It just seems to be that perhaps the rotation of the elbow here isn't quite right in relation

145
00:11:31.080 --> 00:11:33.040
to the pole vector.

146
00:11:33.040 --> 00:11:36.480
Now that's for two potential reasons.

147
00:11:36.480 --> 00:11:42.480
It could be that our primary or secondary axis are slightly incorrect essentially.

148
00:11:42.480 --> 00:11:46.480
I'm going to just disconnect this to get us back to our default pose.

149
00:11:46.480 --> 00:11:57.120
And if I select our lower arm for our primary axis data, this is the axis that points along

150
00:11:57.120 --> 00:11:59.120
the bone.

151
00:11:59.120 --> 00:12:05.320
So if I zoom in here, you'll see that we have our local orientation axis that we can see

152
00:12:05.320 --> 00:12:07.240
here of each bone.

153
00:12:07.240 --> 00:12:13.720
Now if I just orient myself around here, you can see that this red line here indicates

154
00:12:13.720 --> 00:12:19.480
that the x-axis is pointing down the bone or in the direction of the bone.

155
00:12:19.480 --> 00:12:23.200
And it's actually the negative x-axis that is pointing down the direction of the bone

156
00:12:23.200 --> 00:12:26.279
from the elbow to the wrist.

157
00:12:26.279 --> 00:12:32.120
So under the primary axis here, although we are on the x-axis, we're currently set to

158
00:12:32.120 --> 00:12:33.120
positive.

159
00:12:33.120 --> 00:12:34.680
So I'm just going to flip that round to negative.

160
00:12:35.319 --> 00:12:40.839
And if I correct our logic up or connect our logic up, we can see that this looks different

161
00:12:40.839 --> 00:12:43.359
but we're still not quite correct.

162
00:12:43.359 --> 00:12:51.000
So under our secondary axis here, if I disconnect the logic again and select the upper arm again

163
00:12:51.000 --> 00:12:58.479
or the lower arm, sorry, we can see that this green line here indicates that the positive

164
00:12:58.479 --> 00:13:03.399
y-axis is pointing towards our pole vector control.

165
00:13:03.399 --> 00:13:09.720
So if I was to flip that to the positive one instead of negative one and connect to our

166
00:13:09.720 --> 00:13:19.799
logic, we'll see that we now have a correctly working pole vector.

167
00:13:19.799 --> 00:13:24.639
So it's quite important to make sure you orient your joints in the correct way so that you

168
00:13:24.639 --> 00:13:29.600
know which axis is pointing down the bone and which axis will be your secondary axis

169
00:13:29.600 --> 00:13:32.519
pointing towards things like your pole vector.

170
00:13:33.519 --> 00:13:41.279
But now if we see if I just hide the bones, come up to character, bones, and just choose

171
00:13:41.279 --> 00:13:46.519
selected only, which means any bone that we select would now be visible.

172
00:13:46.519 --> 00:13:52.919
And if I select the wrist control here, we can see that it's now controlling our whole

173
00:13:52.919 --> 00:13:59.519
arm and our pole vector control is controlling which direction the elbow is pointing.

