WEBVTT

1
00:00:00.000 --> 00:00:07.839
In this section, we will be making minor changes to the metahuman neutral pose by adjusting

2
00:00:07.839 --> 00:00:13.400
vertex positions using the Propagate changes from Scene to DNA script.

3
00:00:13.400 --> 00:00:18.559
We will first assemble the scene for this specific scenario using the DNA viewer run

4
00:00:18.559 --> 00:00:20.359
in Maya script.

5
00:00:20.359 --> 00:00:27.280
Then we will save the current vertex and joint positions, adjust the mesh vertex positions,

6
00:00:27.280 --> 00:00:31.160
and then save those changes to the DNA file.

7
00:00:31.160 --> 00:00:35.439
Let's return to Maya and go through this workflow.

8
00:00:35.439 --> 00:00:41.039
Back inside of Maya, in a new python window, I have added the Propagate changes script

9
00:00:41.039 --> 00:00:44.920
with the correct input for the files and paths.

10
00:00:44.920 --> 00:00:50.840
To use this script to edit the neutral pose, first we will need to assemble the scene using

11
00:00:50.840 --> 00:00:54.159
the DNA viewer run in Maya script.

12
00:00:54.159 --> 00:00:59.319
I have the DNA viewer run in Maya script over here in this window.

13
00:00:59.319 --> 00:01:07.159
I'm going to select all of this and then right click and select execute.

14
00:01:07.159 --> 00:01:13.479
In the DNA viewer window, I'm going to select the path of the DNA file.

15
00:01:13.479 --> 00:01:21.199
I will go to the DNA calibration folder and then open up the data folder and then open

16
00:01:21.200 --> 00:01:24.219
up the DNA files folder.

17
00:01:24.219 --> 00:01:30.439
I will select the DNA file named lina and then select open.

18
00:01:30.439 --> 00:01:33.079
Now I will select load DNA.

19
00:01:33.079 --> 00:01:40.240
Next, I want to assemble all of the LODs and their contents, so I will choose select all

20
00:01:40.240 --> 00:01:42.359
meshes.

21
00:01:42.359 --> 00:01:49.640
For the build options, we will only need to load the joints for this scenario.

22
00:01:49.640 --> 00:02:00.000
Now we can select process and I will select discard any changes for this scene.

23
00:02:00.000 --> 00:02:07.560
Now that this is assembled, I can minimize this window and go to the top view.

24
00:02:07.560 --> 00:02:13.960
We can see that everything we chose to be assembled has been loaded into this Maya scene.

25
00:02:13.960 --> 00:02:19.479
Down here in the bottom right in the display panel, since I do not need all of the lower

26
00:02:19.479 --> 00:02:25.039
LODs visible, I will hide everything except for LOD 0.

27
00:02:25.039 --> 00:02:30.120
Now the first step of this script is to save the current affairs.

28
00:02:30.120 --> 00:02:36.079
To do this, in the script editor, I will switch over to the Python window with the

29
00:02:36.079 --> 00:02:39.120
Propagate Changes script.

30
00:02:39.120 --> 00:02:43.560
In the Outliner, I will select the head group.

31
00:02:43.560 --> 00:02:49.439
Then in the script editor, I will scroll past all of this code.

32
00:02:49.439 --> 00:02:53.479
We have already changed the input for these paths.

33
00:02:53.479 --> 00:03:01.560
I am going to go all the way down to the end of sub-step 3 where it says loaded data end

34
00:03:01.560 --> 00:03:03.599
of third step.

35
00:03:03.599 --> 00:03:13.159
I am going to select all of this and go all the way to the top and now I will right click

36
00:03:13.159 --> 00:03:16.280
and select execute.

37
00:03:16.280 --> 00:03:25.000
Once this process is complete, as a best practice, I am going to save this Maya scene by going

38
00:03:25.000 --> 00:03:33.159
to File, Save Scene As and since I have already gone through this process, I will select the

39
00:03:33.159 --> 00:03:38.920
Save Current Affairs scene and overwrite it.

40
00:03:38.920 --> 00:03:45.479
Now before we move on, let's do a quick review of the steps we just went through.

41
00:03:45.479 --> 00:03:51.159
We begin this workflow by first assembling the scene using the DNA viewer run in Maya

42
00:03:51.159 --> 00:03:52.159
script.

43
00:03:52.159 --> 00:03:57.839
First, we will load the DNA file located in the DNA files folder.

44
00:03:57.839 --> 00:04:05.039
Next, we want all of the LODs and their contents so we will click on Select All Meshes.

45
00:04:05.039 --> 00:04:11.120
And in the build options, we only need to load the joints and then select process.

46
00:04:11.120 --> 00:04:13.560
This will assemble a new Maya scene.

47
00:04:14.280 --> 00:04:18.319
Next we will want to save the current affairs.

48
00:04:18.319 --> 00:04:23.800
For this step, we want to save the current vertex and joint positions of Meshes.

49
00:04:23.800 --> 00:04:29.959
To do this, in the script editor, with the Python window that has the entire script pasted

50
00:04:29.959 --> 00:04:37.199
in there and configured with the name of the DNA file and the paths to the root directory

51
00:04:37.199 --> 00:04:43.360
and updated GUI and assembly script, we will select the head group in the outliner and

52
00:04:43.360 --> 00:04:49.120
then run the entire script up to the end of step 3 which reads loaded data, end of

53
00:04:49.120 --> 00:04:50.960
third step.

54
00:04:50.960 --> 00:04:54.840
As a best practice, we want to save this Maya scene.

55
00:04:54.840 --> 00:05:02.439
Now let's return to Maya and continue by making some adjustments to the vertex positions.

56
00:05:02.439 --> 00:05:11.240
Back inside of Maya, over here in the show panel, I'm going to uncheck joints.

57
00:05:11.240 --> 00:05:17.079
Now before I start moving vertex positions, let's say I want the changes that I make to

58
00:05:17.079 --> 00:05:20.519
also be on LOD 1, 2 and 3.

59
00:05:20.519 --> 00:05:26.439
In this case, it would be easier if I wrap those other LODs to LOD 0 first so that the

60
00:05:26.439 --> 00:05:32.360
changes I make to LOD 0 will be transferred to those other LODs.

61
00:05:32.360 --> 00:05:38.759
To do this, in the outliner, I'm going to collapse the geometry group.

62
00:05:38.759 --> 00:05:46.199
Since I'm going to be making changes to LOD 0, 1, 2 and 3, I'm going to go here and collapse

63
00:05:46.199 --> 00:05:57.399
the head LOD 0 group, the head LOD 1 group, the head LOD 2 group, and the head LOD 3 group.

64
00:05:57.399 --> 00:06:06.719
To wrap these LODs to LOD 0, select the head LOD 1 mesh and then select the head LOD 0

65
00:06:06.719 --> 00:06:08.439
mesh.

66
00:06:08.439 --> 00:06:16.279
Go to deform and open up the wrap options to make sure everything looks okay.

67
00:06:16.279 --> 00:06:19.560
And now select apply.

68
00:06:19.560 --> 00:06:22.839
Repeat this for LOD 2.

69
00:06:22.839 --> 00:06:27.959
Select it and then select LOD 0.

70
00:06:27.959 --> 00:06:35.879
In the wrap options, select apply and repeat this one more time for LOD 3.

71
00:06:36.839 --> 00:06:42.279
And then select LOD 0 and select apply.

72
00:06:42.279 --> 00:06:49.000
As a best practice, I'm going to save this Maya scene by going to file, save scene as,

73
00:06:50.120 --> 00:06:56.920
and overwrite the file named modify mesh since I've already gone through this workflow a few times.

74
00:06:59.159 --> 00:07:03.000
Now with everything wrapped to LOD 0, we can edit the mesh.

75
00:07:03.959 --> 00:07:08.759
I will select the head LOD 0 and adjust the position of the head.

76
00:07:10.360 --> 00:07:13.319
I will switch from object mode to vertex.

77
00:07:15.399 --> 00:07:21.560
I'm just going to select this random section of the nose region, switch over to translate,

78
00:07:26.040 --> 00:07:28.120
and then simply move these vertices.

79
00:07:29.079 --> 00:07:34.680
The purpose here is to show how this script can be used when we change vertex positions.

80
00:07:37.959 --> 00:07:39.879
I will switch back to object mode.

81
00:07:41.480 --> 00:07:45.079
Now we can see this minor adjustment to the nose area.

82
00:07:47.879 --> 00:07:54.920
If I go down here to the display panel and turn off LOD 0 and turn on LOD 1,

83
00:07:55.160 --> 00:07:57.160
we can see that this adjustment is there.

84
00:07:58.360 --> 00:08:03.160
And it is also there for LOD 2 and LOD 3.

85
00:08:05.319 --> 00:08:11.160
Since we did not wrap the other LODs, those adjustments will not be transferred to them.

86
00:08:13.720 --> 00:08:17.720
I'm going to save the scene again by going to file, save scene.

87
00:08:19.720 --> 00:08:22.840
Now before we move on, let's review these steps.

88
00:08:23.799 --> 00:08:29.879
When making adjustments to the neutral pose by moving vertices, wrap the LODs you wish to

89
00:08:29.879 --> 00:08:35.240
change to LOD 0 first so that they can all be adjusted at the same time.

90
00:08:36.279 --> 00:08:42.600
To do this, select the head LOD 1 mesh and then select the head LOD 0 mesh,

91
00:08:42.600 --> 00:08:45.000
go to deform and select wrap.

92
00:08:45.799 --> 00:08:49.720
Repeat this for all of the head LODs you wish to make changes to.

93
00:08:50.600 --> 00:08:56.920
Then edit the vertex positions of the head LOD 0 mesh and check that those changes are

94
00:08:56.920 --> 00:08:59.480
visible across the LODs that were wrapped.

95
00:09:00.600 --> 00:09:02.920
Now let's return to Maya and continue.

96
00:09:04.120 --> 00:09:09.720
Back inside of Maya, before we run the rest of the script to save these changes to the

97
00:09:09.720 --> 00:09:13.080
DNA file, we will want to delete the wrap nodes.

98
00:09:14.120 --> 00:09:18.600
I will first demonstrate this by selecting the head LOD 0 mesh.

99
00:09:20.519 --> 00:09:25.080
And then we'll select the first head LOD base mesh wrap node.

100
00:09:25.960 --> 00:09:32.840
Then I will go to edit, select delete all by type and select history.

101
00:09:33.960 --> 00:09:39.560
Now that I have demonstrated this step, I'm going to select the head LOD 0 mesh

102
00:09:40.120 --> 00:09:44.120
and then select the rest of the wrap nodes and repeat this step.

103
00:09:44.759 --> 00:09:49.240
I will go to edit, delete all by type and select history.

104
00:09:50.200 --> 00:09:52.040
We can now delete the wrap nodes.

105
00:09:52.680 --> 00:09:58.840
I will go here in the display panel and I will make LOD 1 visible just to make sure that when

106
00:09:58.840 --> 00:10:02.200
I delete the wrap node, the changes I made are still there.

107
00:10:02.840 --> 00:10:06.440
So with the LOD 1 wrap node selected, I will delete it.

108
00:10:07.160 --> 00:10:09.720
We can see the change I made is still there.

109
00:10:10.840 --> 00:10:12.680
Repeat this step for LOD 2.

110
00:10:13.960 --> 00:10:18.840
Making it visible down here and then deleting the wrap node over here.

111
00:10:20.360 --> 00:10:22.920
And finally repeat this for LOD 3.

112
00:10:24.040 --> 00:10:29.480
Make it visible down here and then delete the wrap node over here.

113
00:10:32.440 --> 00:10:33.960
I will save the scene again.

114
00:10:36.360 --> 00:10:38.840
Before we move on, let's review these steps.

115
00:10:40.759 --> 00:10:47.080
Before saving the changes to the DNA file, delete the wrap nodes and check that the changes

116
00:10:47.080 --> 00:10:49.320
are still visible on the other LODs.

117
00:10:50.360 --> 00:10:57.240
To do this, select the head LOD 0 mesh and then select all the base mesh wrap nodes.

118
00:10:58.200 --> 00:11:03.560
Go to edit, delete all by type and select delete history.

119
00:11:04.600 --> 00:11:10.120
Then delete each wrap node while making sure those changes are still visible

120
00:11:10.120 --> 00:11:13.240
by toggling through the LODs in the display panel.

121
00:11:13.480 --> 00:11:18.360
Now let's return to Maya and continue with the rest of this workflow.

122
00:11:19.799 --> 00:11:25.080
Back inside of Maya, we can now save the changes that have been made to the DNA file.

123
00:11:26.200 --> 00:11:33.159
I will select the head group and I will go back here to show and make the joints visible again.

124
00:11:35.000 --> 00:11:38.600
With the head group selected, we will go to the script editor

125
00:11:39.080 --> 00:11:43.879
and scroll all the way down here below sub-step 3.

126
00:11:46.200 --> 00:11:49.159
We have completed step 4 which is to modify the rig

127
00:11:50.440 --> 00:11:55.399
and now we can execute step 5 where we see propagate changes to DNA.

128
00:11:57.000 --> 00:12:00.840
This portion will update the vertex and joints to their new positions

129
00:12:01.560 --> 00:12:03.960
and it will save the changes to the DNA file.

130
00:12:04.280 --> 00:12:08.200
This portion will assemble a new Maya scene with the updated DNA.

131
00:12:09.320 --> 00:12:11.320
Select everything and execute it.

132
00:12:13.240 --> 00:12:18.840
This script will create an output folder and will add the modified DNA file in there.

133
00:12:22.840 --> 00:12:29.960
Once the new Maya scene has loaded, we can see our modified DNA and the changes we made.

134
00:12:29.960 --> 00:12:38.920
We can go here and toggle through the LODs to make sure that the changes have been saved to the other LODs.

135
00:12:39.879 --> 00:12:44.840
It is worth mentioning something about this workflow where we move the vertex positions.

136
00:12:45.879 --> 00:12:51.560
I will reposition the head and I will make the joints visible over here.

137
00:12:53.160 --> 00:12:56.200
The surface joints are positioned by vertices.

138
00:12:56.440 --> 00:13:00.440
When pronounced changes to the vertex positions are made,

139
00:13:00.759 --> 00:13:04.200
the surface joints may need to be manually repositioned.

140
00:13:05.160 --> 00:13:09.320
This is because surface joints preserve the volume for lower LODs.

141
00:13:10.440 --> 00:13:16.200
You can either manually reposition them or use a script to automate this process.

142
00:13:17.160 --> 00:13:19.640
Now this script does not have that command.

143
00:13:20.440 --> 00:13:22.440
There is a script that does.

144
00:13:23.000 --> 00:13:26.200
I will search for it in the Python windows I have open.

145
00:13:27.240 --> 00:13:31.240
It is this one which is the UnrealFest calibration script.

146
00:13:32.040 --> 00:13:37.000
This contains commands that save the current surface joint positions as a JSON file.

147
00:13:37.800 --> 00:13:41.800
All of these here are the surface joints that it loads into memory.

148
00:13:43.000 --> 00:13:49.000
Once the vertex positions are moved, the surface joints will snap to the new vertex positions.

149
00:13:49.480 --> 00:13:54.600
This demonstrates how you can use code from other scripts such as this one

150
00:13:54.600 --> 00:13:57.480
so that you do not have to manually reposition these.

151
00:13:58.600 --> 00:14:01.159
Now let's do a quick review of what we just covered.

152
00:14:01.879 --> 00:14:06.600
Once you are finished making changes to the vertex positions of the neutral pose,

153
00:14:07.159 --> 00:14:11.720
to save the new vertex and joint positions and update the DNA,

154
00:14:12.759 --> 00:14:16.759
select the head group, and then run the rest of the lines.

155
00:14:17.720 --> 00:14:23.480
And then run the rest of the script from step 5 that reads propagate changes to DNA.

156
00:14:24.439 --> 00:14:28.039
This will update the joints and vertex to their new positions.

157
00:14:28.759 --> 00:14:35.480
And these changes will be saved in a new DNA file in the output folder the script creates.

158
00:14:36.439 --> 00:14:42.039
This will also assemble a new Maya scene so that you can inspect the updated DNA.

159
00:14:42.519 --> 00:14:45.319
If changes to the vertex positions are pronounced,

160
00:14:46.039 --> 00:14:48.919
the surface joints may need to be manually repositioned.

161
00:14:50.039 --> 00:14:53.079
Surface joints preserve the volume for lower LODs.

162
00:14:54.039 --> 00:15:00.519
The UnrealFest calibration script contains commands that save the current surface joint positions

163
00:15:00.519 --> 00:15:01.959
as a JSON file.

164
00:15:02.839 --> 00:15:05.959
And once changes to the vertex positions have been made,

165
00:15:06.759 --> 00:15:10.679
it will snap the surface joints to the new vertex positions.

166
00:15:12.519 --> 00:15:16.279
Saving you time and having to manually move them by hand.

167
00:15:17.159 --> 00:15:20.679
This is a great example of how you can use code from other scripts.

168
00:15:21.959 --> 00:15:27.959
Now let's move on to the next section where we go over another simple use case scenario

169
00:15:27.959 --> 00:15:31.319
that uses the propagate changes from scene to DNA script

170
00:15:31.879 --> 00:15:36.279
to make minor modeling changes using the joints and skin clusters.

