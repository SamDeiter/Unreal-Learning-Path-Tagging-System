WEBVTT

1
00:00:00.000 --> 00:00:05.839
In the previous section, we did an overview of the script and the assets that we will

2
00:00:05.839 --> 00:00:07.040
be using.

3
00:00:07.040 --> 00:00:10.200
In this section, we will be executing the script.

4
00:00:10.200 --> 00:00:14.599
As we complete portions of this workflow, I will review the completed steps.

5
00:00:14.599 --> 00:00:18.400
So let's return to Maya and begin using the script.

6
00:00:18.400 --> 00:00:22.320
Back inside of Maya, we are now ready to execute the script.

7
00:00:22.320 --> 00:00:26.320
As mentioned earlier, you can technically run this entire script, but we're going to

8
00:00:26.320 --> 00:00:31.160
go through this one step at a time and see what each command does.

9
00:00:31.160 --> 00:00:35.000
The first thing we will do is initialize the script.

10
00:00:35.000 --> 00:00:41.159
Select everything from line 731 all the way to line 1 and execute it.

11
00:00:41.159 --> 00:00:44.280
This will bring everything into memory.

12
00:00:44.280 --> 00:00:50.840
Now let's go back down to line 733 and begin the initial work.

13
00:00:50.840 --> 00:00:56.640
Select line 734 to 741 and execute it.

14
00:00:56.640 --> 00:01:02.840
This will load the plugin and create an output and temp folder if they do not exist.

15
00:01:02.840 --> 00:01:05.960
Now we can start to execute each of the steps.

16
00:01:05.960 --> 00:01:09.760
Scroll down to 743 where it says steps.

17
00:01:09.760 --> 00:01:15.200
From step 1 to 3, this portion of the script will move and transform the rig.

18
00:01:15.200 --> 00:01:19.960
We will not see anything happen in the viewport for these three steps, however, after each

19
00:01:19.959 --> 00:01:26.399
step, a new DNA file will be generated and added to the DNA folder.

20
00:01:26.399 --> 00:01:30.599
Select the entire section for step 1 and execute it.

21
00:01:30.599 --> 00:01:35.919
What this command does is it takes the scale values and applies them to the DNA and then

22
00:01:35.919 --> 00:01:40.759
saves this to a DNA file named scaled.

23
00:01:40.759 --> 00:01:48.819
Once this process is complete, select the entire section for step 2 and execute it.

24
00:01:48.819 --> 00:01:54.779
This takes the translation and rotation values that we have over here and it will apply them

25
00:01:54.779 --> 00:01:56.439
to the DNA.

26
00:01:56.439 --> 00:02:00.319
The DNA file will be named translated DNA.

27
00:02:00.319 --> 00:02:07.359
Once this process is complete, select the entire section for step 3 and execute it.

28
00:02:07.359 --> 00:02:14.419
This changes the up access if needed by rotating the rig 90 degrees and applies this to a DNA

29
00:02:14.419 --> 00:02:18.079
named up access change.

30
00:02:18.080 --> 00:02:22.620
The first step is to initialize the script and create folders.

31
00:02:22.620 --> 00:02:29.140
Select the script from line 1 to 731 and run that part to load everything into memory.

32
00:02:29.140 --> 00:02:36.900
Next, select the script from line 734 to 741 to load the plugin and create the output and

33
00:02:36.900 --> 00:02:40.020
temp folder if they have not been created.

34
00:02:40.020 --> 00:02:43.700
Then we can move on by running step 1 through step 3.

35
00:02:43.699 --> 00:02:48.439
For these steps we will not see anything in the viewport, however the DNA folder will

36
00:02:48.439 --> 00:02:51.959
be populated with new DNA files.

37
00:02:51.959 --> 00:02:54.199
Step 1 will scale the rig.

38
00:02:54.199 --> 00:02:57.139
Select the entire section of this step and run it.

39
00:02:57.139 --> 00:03:00.719
This will scale the DNA based on the values we provided.

40
00:03:00.719 --> 00:03:04.599
The new DNA file will be named scaled DNA.

41
00:03:04.599 --> 00:03:09.560
Step 2 will translate and rotate the rig based on the provided values.

42
00:03:09.560 --> 00:03:12.959
Select this entire section for that step and run it.

43
00:03:12.960 --> 00:03:17.020
The new DNA file will be named translated DNA.

44
00:03:17.020 --> 00:03:22.819
Step 3 will change the up access if needed and rotate the rig 90 degrees.

45
00:03:22.819 --> 00:03:26.060
Select the entire section of this step and run it.

46
00:03:26.060 --> 00:03:30.580
The new DNA file will be named up access change.

47
00:03:30.580 --> 00:03:34.620
Now let's return to Maya and continue.

48
00:03:34.620 --> 00:03:40.340
In Maya we have just finished step 1 through 3 where we moved and scaled the rig.

49
00:03:40.340 --> 00:03:45.640
In the DNA folder we can see the DNA files that were created after each step.

50
00:03:45.640 --> 00:03:48.520
We can now move on to step 4.

51
00:03:48.520 --> 00:03:55.000
This will load the last DNA that was generated which is the DNA file named up access change

52
00:03:55.000 --> 00:03:59.939
and it will save the surface joint positions as a JSON file.

53
00:03:59.939 --> 00:04:06.840
Select and run the first portion of the script to load the DNA into the scene.

54
00:04:06.840 --> 00:04:13.219
Now that it is loaded we can see it over here in the viewport.

55
00:04:13.219 --> 00:04:22.620
Next, run this portion of the script to save the current surface joint positions.

56
00:04:22.620 --> 00:04:27.199
A JSON file will be created and added to the temp folder.

57
00:04:27.199 --> 00:04:32.259
Before we move on let's do a quick review of the steps we just completed.

58
00:04:32.259 --> 00:04:37.039
Step 4 will load the change up access DNA file that was generated from the previous

59
00:04:37.039 --> 00:04:38.240
step.

60
00:04:38.240 --> 00:04:41.560
It will then save the surface joint positions.

61
00:04:41.560 --> 00:04:46.519
Executing the first portion of step 4 will load the metahuman head geometry and joints

62
00:04:46.519 --> 00:04:48.120
into a new scene.

63
00:04:48.120 --> 00:04:53.759
The save surface joint positions command will generate a JSON file and add it to the temp

64
00:04:53.759 --> 00:04:55.240
folder.

65
00:04:55.240 --> 00:04:59.039
Now let's return to Maya and continue.

66
00:04:59.040 --> 00:05:04.260
Back in Maya with the surface joints saved we can move on to step 5.

67
00:05:04.260 --> 00:05:11.060
This portion of the script will update the LOD0 neutral head mesh from provided models.

68
00:05:11.060 --> 00:05:16.140
Run this first portion of the script to add the models into the scene.

69
00:05:16.140 --> 00:05:20.700
If we look in the outliner all of the fitted models have been loaded.

70
00:05:20.700 --> 00:05:25.340
As mentioned earlier, if the mesh mappings in the constants section of the script are

71
00:05:25.359 --> 00:05:30.519
labeled incorrectly the models might not load for this step.

72
00:05:30.519 --> 00:05:34.519
Now let's run this portion of the script.

73
00:05:34.519 --> 00:05:38.159
This will get the old and new mesh positions.

74
00:05:38.159 --> 00:05:43.719
We can now run the saveDNA portion down here to save the new mesh positions to the DNA

75
00:05:43.719 --> 00:05:45.519
file.

76
00:05:45.519 --> 00:05:50.919
This will create a new DNA file named meshDNA.

77
00:05:50.919 --> 00:05:55.279
Let's do a quick review of the steps we just went through before we move on.

78
00:05:55.279 --> 00:05:59.419
Step 5 updated the neutral mesh from the provided models.

79
00:05:59.419 --> 00:06:04.619
The first command of step 5 will add the fitted geometry assets into the scene.

80
00:06:04.619 --> 00:06:10.659
Again, if using this with your own character ensure that the mesh mapping names correspond

81
00:06:10.659 --> 00:06:16.059
to the names of the models as they appear in Maya otherwise they may not load.

82
00:06:16.059 --> 00:06:22.339
The getMeshVertexPositions command will get the old and new mesh positions and then save

83
00:06:22.359 --> 00:06:25.239
the new mesh positions to the DNA.

84
00:06:25.239 --> 00:06:30.119
A new DNA file will be created and named meshDNA.

85
00:06:30.119 --> 00:06:34.439
Now let's return to Maya and continue with the steps.

86
00:06:34.439 --> 00:06:40.039
In Maya, step 6 will update the surface joint positions using the JSON file from the temp

87
00:06:40.039 --> 00:06:46.359
folder for the meshDNA file that was generated from the previous step.

88
00:06:46.360 --> 00:06:55.780
Run the showMesh's command to load the updated meshDNA file.

89
00:06:55.780 --> 00:06:59.819
In the viewport we will see the DNA file has been assembled.

90
00:06:59.819 --> 00:07:04.180
Now to update the surface joints I'm going to position the head so that we can see what

91
00:07:04.180 --> 00:07:11.740
this process looks like once we run the next command.

92
00:07:11.740 --> 00:07:18.360
With this portion of step 6 selected I will execute this and we will see the surface joints

93
00:07:18.360 --> 00:07:23.240
snap to their new vertex positions.

94
00:07:23.240 --> 00:07:26.639
Now run the rest of the script over here.

95
00:07:26.639 --> 00:07:32.199
This will save the changes to the DNA and name it changesFromScene.

96
00:07:32.199 --> 00:07:35.759
Then it will load this new DNA.

97
00:07:35.759 --> 00:07:41.720
Now that it is loaded I'm going to make the display panel visible and in the script editor

98
00:07:41.720 --> 00:07:46.540
I will go to the RecalculateLowerLOD section.

99
00:07:46.540 --> 00:07:52.180
If I go to the display panel and hide LOD0 we will see that the changes have only been

100
00:07:52.180 --> 00:07:54.940
applied to LOD0.

101
00:07:54.940 --> 00:08:01.020
In the script editor run the entire portion of the section named RecalculateLowerLODs

102
00:08:01.020 --> 00:08:02.640
over here.

103
00:08:02.640 --> 00:08:08.720
This will transfer the changes to the lower LODs based on LOD0 and it will save those

104
00:08:08.720 --> 00:08:11.340
changes to the final DNA.

105
00:08:11.339 --> 00:08:15.299
Let's do a quick review of these steps before we move on.

106
00:08:15.299 --> 00:08:20.599
Once we have updated the neutral mesh from the LOD0 head mesh the next step is to update

107
00:08:20.599 --> 00:08:22.819
the joint positions.

108
00:08:22.819 --> 00:08:24.939
Execute step 6 to do this.

109
00:08:24.939 --> 00:08:29.819
The showMesh's command will load the meshDNA file and then the rest of the commands will

110
00:08:29.819 --> 00:08:35.419
load the saved joint positions from the JSON file and then move the surface joints to their

111
00:08:35.419 --> 00:08:37.500
new vertex positions.

112
00:08:37.500 --> 00:08:40.899
This change will only be applied to LOD0.

113
00:08:40.899 --> 00:08:47.179
Run the RecalculateLowerLODs based on LOD0 to transfer the changes that were made to

114
00:08:47.179 --> 00:08:53.340
LOD0 to all of the lower LODs and save the final DNA.

115
00:08:53.340 --> 00:08:58.100
Now let's return to Maya and go over the final steps of this script.

116
00:08:58.100 --> 00:09:02.699
Back in Maya execute all of step 7 to check the results.

117
00:09:02.699 --> 00:09:06.879
This will load the final DNA and assemble a full rig.

118
00:09:06.879 --> 00:09:12.039
This process will take a few moments to complete.

119
00:09:12.039 --> 00:09:17.840
Once this process is complete in the viewport we can see the final DNA.

120
00:09:17.840 --> 00:09:21.519
Let's bring this closer to view.

121
00:09:21.519 --> 00:09:26.600
We can also see that the changes to the neutral have been transferred to all of the lower

122
00:09:26.600 --> 00:09:31.559
LODs.

123
00:09:31.559 --> 00:09:38.599
Now because we are in YUP we will notice that the faceboard is over here and that is okay

124
00:09:38.599 --> 00:09:44.559
because the last portion of the script contains the command that will rotate the rig back

125
00:09:44.559 --> 00:09:46.599
to 90 degrees.

126
00:09:46.599 --> 00:09:49.239
The faceboard controls will still work though.

127
00:09:49.239 --> 00:09:52.000
We can see that these are operational.

128
00:09:52.000 --> 00:09:58.319
Now if we are happy with everything the next step would be to run the export FBX for each

129
00:09:58.319 --> 00:09:59.959
LOD section.

130
00:09:59.960 --> 00:10:04.040
I'm not going to run this portion of the script for two reasons.

131
00:10:04.040 --> 00:10:09.560
The first reason is that the current version of the export FBX portion of the script results

132
00:10:09.560 --> 00:10:12.840
in a mismatch between the body and head skeleton.

133
00:10:12.840 --> 00:10:18.879
To work around this use the DNA viewer export FBX script from the examples folder.

134
00:10:18.879 --> 00:10:23.480
The second reason is that we still need to align the skeleton for the head with the custom

135
00:10:23.480 --> 00:10:26.960
body skeleton for a seamless integration.

136
00:10:26.960 --> 00:10:32.160
Now we could do this by hand or we could use the custom body workflow script that will

137
00:10:32.160 --> 00:10:34.000
do this for us.

138
00:10:34.000 --> 00:10:40.200
Now let's review everything we just covered before we move on to the custom body workflow.

139
00:10:40.200 --> 00:10:45.600
Step 7 will assemble a full rig of the final DNA for inspection and if everything looks

140
00:10:45.600 --> 00:10:52.200
correct it will export FBX for each LOD and apply a material placeholder for all of the

141
00:10:52.200 --> 00:10:53.720
LODs.

142
00:10:53.720 --> 00:11:00.080
As mentioned the current version of the export FBX portion of this script results in a mismatch

143
00:11:00.080 --> 00:11:02.720
between the body and head skeleton.

144
00:11:02.720 --> 00:11:09.200
A workaround for this is to use the export FBX script from the examples folder.

145
00:11:09.200 --> 00:11:14.440
Using the final DNA from this script we will now move on to the next portion of our course

146
00:11:14.440 --> 00:11:20.320
where we will use the custom body workflow script to align the head and custom body skeletons

147
00:11:20.320 --> 00:11:22.000
for a seamless integration.

