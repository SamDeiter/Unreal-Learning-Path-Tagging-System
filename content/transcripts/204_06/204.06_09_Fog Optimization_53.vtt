WEBVTT

1
00:00:00.000 --> 00:00:05.879
In this lesson, we're going to talk about optimizing fog effects in Unreal and how that

2
00:00:05.879 --> 00:00:06.879
works.

3
00:00:06.879 --> 00:00:09.200
So let's get started.

4
00:00:09.200 --> 00:00:16.240
So fog effects are one of the most expensive effects that you can use in Unreal, and especially

5
00:00:16.240 --> 00:00:18.039
if you're using volumetric fog.

6
00:00:18.039 --> 00:00:23.719
Now, volumetric fog, as you turn that on in Unreal, it allows you to be able to actually

7
00:00:23.719 --> 00:00:29.480
isolate the fogs in such a way so it doesn't invade your interiors nor areas where they're

8
00:00:29.480 --> 00:00:30.480
shaped.

9
00:00:30.480 --> 00:00:37.359
Now, this is very minimal shade, but if you're inside of a room or et cetera, or just even

10
00:00:37.359 --> 00:00:42.079
a simple overhang of trees, the fog will not invade those areas.

11
00:00:42.079 --> 00:00:48.159
So checking that performance and making sure the most optimal settings is what we're going

12
00:00:48.159 --> 00:00:50.200
to be talking about here.

13
00:00:50.200 --> 00:00:54.960
Number one, we can look at profile GPU to inspect what's going on with our fog.

14
00:00:54.960 --> 00:00:59.439
You can also, if you want to, choose to cast volumetric shadows in your scene, but keep

15
00:00:59.439 --> 00:01:05.359
in mind this can actually increase things almost by three times the amount of heaviness

16
00:01:05.359 --> 00:01:07.480
going on in your fog.

17
00:01:07.480 --> 00:01:13.040
So just keep that in mind because you're actually trying to make it so that that fog is believable,

18
00:01:13.040 --> 00:01:16.840
but all of that needs to be calculated in your environment.

19
00:01:16.840 --> 00:01:19.280
Let's go and play with a little bit of the fog, and I'll walk you through some of the

20
00:01:19.280 --> 00:01:23.280
tips and tricks and things you need to look out for, and we'll also go back to the slides.

21
00:01:25.439 --> 00:01:29.359
So here we are in Unreal, and I'm going to go ahead and make sure my exponential height

22
00:01:29.359 --> 00:01:31.359
fog is set correctly.

23
00:01:31.359 --> 00:01:36.119
So we're going to make sure our volumetrics are on, and again, you can increase this or

24
00:01:36.119 --> 00:01:41.399
decrease this, and you'll notice the scatter, and I'm talking about the scatter distribution,

25
00:01:41.399 --> 00:01:44.239
also affects the light and the amount of fog coming through.

26
00:01:44.239 --> 00:01:49.679
We can actually see it here also in our environment, how that is affecting and even making it so

27
00:01:49.680 --> 00:01:55.640
that the lights are glowing more with the fog, such as our sunlight, but you'll notice

28
00:01:55.640 --> 00:02:00.480
that or I should say this particular rec light we're looking directly at, but such things

29
00:02:00.480 --> 00:02:07.080
as our spotlight over here have kind of lost some of that bloom and that cone and influence

30
00:02:07.080 --> 00:02:10.879
there just by us editing the scatter distribution.

31
00:02:10.879 --> 00:02:16.120
So you can keep that at 0.2 for objects you need to see more in a side angle, and you'll

32
00:02:16.120 --> 00:02:19.879
see a little bit with the lights, but not as much as if we adjusted that number like

33
00:02:19.879 --> 00:02:21.120
we just did.

34
00:02:21.120 --> 00:02:26.520
Now the fog overall amount, we can increase, and that will also increase the effect of

35
00:02:26.520 --> 00:02:31.080
our lights on those fogs, particularly one that is positioned in such a way such as this

36
00:02:31.080 --> 00:02:32.439
spotlight.

37
00:02:32.439 --> 00:02:37.800
Now if we want to actually edit that on a more micro level, we can go into that particular

38
00:02:37.800 --> 00:02:44.480
spotlight in our scene and edit that in such a way to make sure that it also gives off

39
00:02:44.840 --> 00:02:48.799
more fog influence, and that's using our volumetric scatter intensity.

40
00:02:48.799 --> 00:02:51.599
That's basically the influence of the fog and the light together.

41
00:02:51.599 --> 00:02:53.679
So I can increase that if I need to.

42
00:02:53.679 --> 00:02:58.519
Now working with these properties, again, as you increase this influence, things can

43
00:02:58.519 --> 00:02:59.719
get a little bit more expensive.

44
00:02:59.719 --> 00:03:04.759
We're in a baking scenario, but some of those rules still apply when it comes to lumen.

45
00:03:04.759 --> 00:03:11.759
If I go in here back to my fog properties that we have, to an exponential head fog,

46
00:03:11.759 --> 00:03:14.759
then let's actually just type in it, make it easier.

47
00:03:14.759 --> 00:03:16.399
There we go.

48
00:03:16.399 --> 00:03:18.280
Get that exponential head fog in here.

49
00:03:18.280 --> 00:03:23.759
You'll notice we also have a secondary area of data in which we can increase fog amount

50
00:03:23.759 --> 00:03:27.359
overall, but also make it so that it's on a lower level.

51
00:03:27.359 --> 00:03:30.599
Now we don't have any lower level geometry in this particular scene.

52
00:03:30.599 --> 00:03:35.120
We do go over this in atmospheric lighting, but that also can be added into our environment.

53
00:03:35.120 --> 00:03:40.479
But keep in mind, as you bring more fog into play, things can get expensive.

54
00:03:40.479 --> 00:03:42.479
So make a note to itself.

55
00:03:42.479 --> 00:03:48.479
Now you'll notice also in a fog environment here, we have a static underneath our volumetrics.

56
00:03:48.479 --> 00:03:51.839
You'll notice we have a static lighting scattering intensity.

57
00:03:51.839 --> 00:03:56.719
We have static lighting in here, a few things, not a lot, and it would increase a little

58
00:03:56.719 --> 00:04:00.879
bit here such as our ground fog overall.

59
00:04:00.879 --> 00:04:04.639
And you'll see that we just kind of multiplied it in that environment there.

60
00:04:04.639 --> 00:04:07.879
And it's actually relating to our lights, the ones that are static.

61
00:04:07.879 --> 00:04:11.199
Now if you're not working with static lighting, because Lumion does not support it, that's

62
00:04:11.199 --> 00:04:12.879
really not going to help you much.

63
00:04:12.879 --> 00:04:14.199
So just keep that in mind.

64
00:04:14.199 --> 00:04:16.199
But that is available if you wanted to use it.

65
00:04:16.199 --> 00:04:18.959
Notice we have our constant frame rate here.

66
00:04:18.959 --> 00:04:21.680
On here is actually pretty nice overall.

67
00:04:21.680 --> 00:04:25.879
And even though we may increase or decrease our fog, we will gain a few frames.

68
00:04:25.879 --> 00:04:30.839
And as you add other elements with that fog, and especially if you add these lights that

69
00:04:30.839 --> 00:04:35.680
use these scattering intensity, things can get a little bit heavy, especially if your

70
00:04:35.680 --> 00:04:38.280
ICV affects and you're on stage.

71
00:04:38.280 --> 00:04:43.000
And what I mean by that is your fog, plus all these elements that you have in play,

72
00:04:43.000 --> 00:04:45.199
need to actually all be calculated.

73
00:04:45.199 --> 00:04:50.160
And your each of your objects and materials will be counted as draw calls, as we've talked

74
00:04:50.160 --> 00:04:51.759
about in other classes.

75
00:04:51.759 --> 00:04:55.800
So keep those things in mind because fog is just going to add another layer of complexity.

76
00:04:55.800 --> 00:04:58.680
When you can, you do want to try to use fog cards.

77
00:04:58.680 --> 00:05:04.160
They have shader complexity, but they're still a little bit less in their view and how they

78
00:05:04.280 --> 00:05:05.280
are seen.

79
00:05:05.280 --> 00:05:08.640
And I'll bring up a scene real quick here so you can kind of see what you can do to

80
00:05:08.640 --> 00:05:12.960
fake some of those effects.

81
00:05:12.960 --> 00:05:19.640
This particular scene we use and show off in our atmospheric lighting course, but I wanted

82
00:05:19.640 --> 00:05:25.120
to use it just for a brief moment so you can actually see how the fog cards and even volumetric

83
00:05:25.120 --> 00:05:31.200
materials on simple pieces of geometry actually really kind of sell this environment.

84
00:05:31.240 --> 00:05:38.240
You can see the fog cards in here slowly just moving off to the left here and using also

85
00:05:38.240 --> 00:05:40.039
a fog blueprint.

86
00:05:40.039 --> 00:05:44.560
And here's our volumetric fog, which is connected to a piece of geometry for a cheap ground

87
00:05:44.560 --> 00:05:45.560
fog.

88
00:05:45.560 --> 00:05:46.480
It's pretty great.

89
00:05:46.480 --> 00:05:50.639
So whenever you can, you want to try to use fog cards and maybe even use this volumetric

90
00:05:50.639 --> 00:05:54.639
material and it can be a bit cheaper.

91
00:05:54.639 --> 00:05:59.879
And you can even sell the idea of fog on even a lower ground playing, such as down below

92
00:05:59.920 --> 00:06:05.240
here where you can actually see different layers of fog floating around simply by putting

93
00:06:05.240 --> 00:06:08.319
some fog cards in place.

94
00:06:08.319 --> 00:06:14.319
So just note to yourself there just exactly how cool and how great you can actually make

95
00:06:14.319 --> 00:06:20.079
some really cool scenes using a little bit of your fog or a lot.

96
00:06:20.079 --> 00:06:23.399
But these fog cards can add that little icing on the cake.

97
00:06:23.399 --> 00:06:28.920
And sometimes that's all you need is in fog cards just so that things in the background,

98
00:06:28.960 --> 00:06:35.080
you'll get the idea of a visual representation that you're going for and they don't necessarily

99
00:06:35.080 --> 00:06:38.560
have to have all the bells and whistles.

100
00:06:38.560 --> 00:06:42.560
So again, three of the main players that you'll be using when it comes to your fog is one

101
00:06:42.560 --> 00:06:44.400
is going to be the intensity in your light.

102
00:06:44.400 --> 00:06:48.800
So it's going to relate to it just like it would in a regular world scenario where if

103
00:06:48.800 --> 00:06:52.439
your light is increased in a foggy area, that light's going to bounce around on the water

104
00:06:52.439 --> 00:06:55.520
particles and then they will affect the scene.

105
00:06:55.520 --> 00:06:57.920
It works exactly the same way.

106
00:06:57.920 --> 00:07:02.040
So if you choose to, like I said earlier, you can cast volumetric shadows if you want

107
00:07:02.040 --> 00:07:04.720
more realism, but that is very expensive.

108
00:07:04.720 --> 00:07:05.720
So keep that in mind.

109
00:07:05.720 --> 00:07:11.759
And also the volumetric scatter intensity on each light can be adjusted for that implementing

110
00:07:11.759 --> 00:07:16.560
the strength of that influence of the fog and the light relationship.

111
00:07:16.560 --> 00:07:21.759
So here is some CVARs that you can use for final pixel fog optimization.

112
00:07:21.759 --> 00:07:25.200
And this is the one that we use for our cinematics for Fortnite.

113
00:07:25.199 --> 00:07:29.800
So this allow you to have the best possible resolution for your fog as you output them

114
00:07:29.800 --> 00:07:31.800
in your render queue, in your movie render queue.

115
00:07:31.800 --> 00:07:40.039
And you'll see we have volumetric fog grid size 256, r.volumetric fog.gridsize2, and

116
00:07:40.039 --> 00:07:45.599
r.volumetric fog.temporal reprojection 1.

117
00:07:45.599 --> 00:07:48.439
And these actually work really well.

118
00:07:48.439 --> 00:07:52.719
For ICV effects, you do need to be careful of noise that may occur on your scene.

119
00:07:52.720 --> 00:07:55.680
So again, whenever you can, try to use them fog cards.

120
00:07:55.680 --> 00:08:00.600
They're simplistic in nature, and they definitely can be used to your advantage.

121
00:08:00.600 --> 00:08:04.480
So some of the CVARs that you can use to maybe dumb down things so they're not too strong

122
00:08:04.480 --> 00:08:11.000
and yet not too poorly represented is your r.volumetric fog grid size here.

123
00:08:11.000 --> 00:08:13.840
It defaults at 8, but can't be lower to 6.

124
00:08:13.840 --> 00:08:18.880
Anything higher than 8 can increase performance, but at the cost of pixelation.

125
00:08:18.879 --> 00:08:26.159
So just keep that in mind, performance versus visuals, and also r.volumetric fog grid size

126
00:08:26.159 --> 00:08:32.480
Z. This defaults at 128, lower values increase performance, and may cause pixelation like

127
00:08:32.480 --> 00:08:33.679
we talked about before.

128
00:08:33.679 --> 00:08:35.279
So keep that in mind.

129
00:08:35.279 --> 00:08:38.679
It's a trade off visuals versus performance.

130
00:08:38.679 --> 00:08:43.440
And at the bottom here, you'll see you can also turn it off to see what your fog effects

131
00:08:43.440 --> 00:08:46.320
are doing to impact your performance overall.

132
00:08:46.320 --> 00:08:52.200
And again, you have a few others here here, six 96 and then zero as a reminder overall

133
00:08:52.200 --> 00:08:56.560
as testing points to be able to mess with things a bit.

134
00:08:56.560 --> 00:09:00.800
Here's a link here for if you want to dive in a bit deeper looking at exponential height

135
00:09:00.800 --> 00:09:03.640
fog.

136
00:09:03.640 --> 00:09:04.960
That's it with this course.

137
00:09:04.960 --> 00:09:07.760
We hope you've enjoyed what we've talked about.

138
00:09:07.760 --> 00:09:11.440
In the next video, we're going to recap a bit of what we talked about.

139
00:09:11.440 --> 00:09:15.800
And we're going to wrap things up and we hope you've enjoyed things.

